(this["webpackJsonpfield-work"]=this["webpackJsonpfield-work"]||[]).push([[0],{1026:function(e,a,n){"use strict";n.r(a);var t={};n.r(t),n.d(t,"state",(function(){return Ae})),n.d(t,"actions",(function(){return Ee})),n.d(t,"onInitialize",(function(){return Me}));var o={};n.r(o),n.d(o,"state",(function(){return Pe})),n.d(o,"actions",(function(){return qe})),n.d(o,"effects",(function(){return We}));var r=n(0),i=n.n(r),c=n(28),s=n.n(c);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(598),n(599),n(600);var l,d,u=n(191),p=n(67),f=n(2),m=n.n(f),g=n(237),v=n(574),h=n(10),w=n.n(h),b=n(25),y=n(36),O={OPTIONS:{redirect:d="http://openatk.com/FieldWorkApp/oauth2/redirect.html",metadata:l="eyJqa3UiOiJodHRwczovL2lkZW50aXR5Lm9hZGEtZGV2LmNvbS9jZXJ0cyIsImtpZCI6ImtqY1NjamMzMmR3SlhYTEpEczNyMTI0c2ExIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJyZWRpcmVjdF91cmlzIjpbImh0dHA6Ly9vcGVuYXRrLmNvbS9GaWVsZFdvcmtBcHAvb2F1dGgyL3JlZGlyZWN0Lmh0bWwiLCJodHRwOi8vbG9jYWxob3N0L29hdXRoMi9yZWRpcmVjdC5odG1sIl0sInRva2VuX2VuZHBvaW50X2F1dGhfbWV0aG9kIjoidXJuOmlldGY6cGFyYW1zOm9hdXRoOmNsaWVudC1hc3NlcnRpb24tdHlwZTpqd3QtYmVhcmVyIiwiZ3JhbnRfdHlwZXMiOlsiYXV0aG9yaXphdGlvbl9jb2RlIl0sInJlc3BvbnNlX3R5cGVzIjpbInRva2VuIiwiY29kZSIsImlkX3Rva2VuIiwiaWRfdG9rZW4gdG9rZW4iLCJjb2RlIGlkX3Rva2VuIiwiY29kZSB0b2tlbiIsImNvZGUgaWRfdG9rZW4gdG9rZW4iXSwiY2xpZW50X25hbWUiOiJPcGVuQVRLIiwiY2xpZW50X3VyaSI6Imh0dHA6Ly9vcGVuYXRrLmNvbSIsImNvbnRhY3RzIjpbIlNhbSBOb2VsIDxzYW5vZWxAcHVyZHVlLmVkdT4iXSwiandrcyI6eyJrZXlzIjpbeyJrdHkiOiJSU0EiLCJuIjoiemF1WkZCdU1kbHYxa1lqelViNHEtXzNtNHNtRnhuZnc0U1lvYUhxN2NpOFNjdFkzeGo3cmRBSHlrUXBuUVZyajZLTzhtYUh2LTBCdlc1TWhjZ2l2a3VZcy16SEV2ZllCZVZCbmN2SGdPa0pQYmM5MUN3X2l3T1k3RUhXQjhoTTdWaUxRVmNfRHYwaDhuSnliQnZoTDA0Q0hRdDdDcE10VllHNmZvSlhjM2RxNTJqTlFiQkhJWjVtN1Z6MUt0eXpvTGNwOE8ybWhhTHA0NVVyM0NfMWVHdHY4bjVOejliV19CaDVYRlliRHh2N0JuaFpOSXcxR0NiampBd210Ym5uTDdHZ2Y0Q3k2MHdSSG1SNHZvZTIxT0lqb0FTcTJqWjAzeDEybVhzN0hQSTNZQjR5Mjl3dlpNdzJnTHpPZFRvcnJxTy10bG1uMWJvUGtXS0pKU1hvQXZ3IiwiZSI6IkFRQUIifV19LCJzb2Z0d2FyZV9pZCI6ImE3MDNiZmRjLTNmYTEtNDk5Zi1iOTA1LTExZjBiNTRmMzgwNyIsInJlZ2lzdHJhdGlvbl9wcm92aWRlciI6Imh0dHBzOi8vaWRlbnRpdHkub2FkYS1kZXYuY29tIiwiaWF0IjoxNTMzODQ2MTEyfQ.Y9BlbqHzOvufADGAW9HG4Yx2rqbg6zPalpcjSS_97Mpg36lOuADGJ4YTQ2iQfRlZjzqBi1sUq3iFhReBfk89Oy2nSEY6RVPnONK5v6a73jce3xGPUWk8DDl3rf3lcrt-IqWFoAieUie7WK5nrPFIe-_xcgYdChnuGrugjO9dGOY",scope:"oada.yield:all"},REDIRECT:d,METADATA:l,SCOPE:"oada.yield:all",oadaDomain:""},k={domain:O.oadaDomain},D={onInitialize:function(e){var a=e.state,n=e.actions,t=window.localStorage["oada:domain"],o=window.localStorage["oada:token"];t&&(a.view.Login.domain=t),t&&o&&n.view.Login.login({token:o})},login:function(e,a){return Object(b.a)(w.a.mark((function n(){var t,o,r,i,c;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.state,o=e.actions,r=a.token,i=t.view.Login,c=i.domain,i.loading=!0,c=c.match(/^http/)?c:"https://"+i.domain,n.next=8,o.app.OADAManager.login({domain:c,token:r});case 8:i.loading=!1,t.app.OADAManager.connected&&(i.loggedIn=!0,window.localStorage["oada:domain"]=i.domain,window.localStorage["oada:token"]=t.app.OADAManager.token);case 10:case"end":return n.stop()}}),n)})))()},logout:function(e){return Object(b.a)(w.a.mark((function a(){var n,t,o;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,t=e.actions,o=n.view.Login,!n.app.OADAManager.connected){a.next=7;break}return a.next=5,t.app.OADAManager.logout();case 5:delete window.localStorage["oada:domain"],delete window.localStorage["oada:token"];case 7:o.loggedIn=!1;case 8:case"end":return a.stop()}}),a)})))()},domainChange:function(e,a){e.state.view.Login.domain=a.value},viewDemo:function(e,a){e.state.view.Login.loggedIn=!0}},A=n(66),E=n(240),M=n.n(E),F={open:!1,fieldId:function(e,a){return Object(A.a)(e),m.a.get(a,"view.Map.selectedField")},field:function(e,a){var n=e.fieldId,t=m.a.get(a,"view.TopBar.OperationDropdown.selectedOperation");if(null==n)return null;var o=m.a.get(t,"fields.".concat(n,".status"),null),r=null;if(1==m.a.get(a,"app.OADAManager.connected")){var i=m.a.get(a,"app.OADAManager.currentConnection");r=m.a.get(a,"app.oada.".concat(i,".bookmarks.seasons.2019.fields.").concat(n))}else r=m.a.get(a,"app.localData.abc123.seasons.2019.fields.".concat(n));if(null==r)return null;var c=247105e-9*M.a.geometry(r.boundary);return m.a.merge({},r,{status:o,acres:c})},farm:function(e,a){var n=e.field,t=null;if(1==m.a.get(a,"app.OADAManager.connected")){var o=m.a.get(a,"app.OADAManager.currentConnection");if(m.a.get(n,"farm._id")){var r=m.a.get(a,"app.oadaSeasonFarmsIdBy_id.".concat(m.a.get(n,"farm._id"),".id"));t=m.a.get(a,"app.oada.".concat(o,".bookmarks.seasons.2019.farms.").concat(r))}}else m.a.get(n,"farm.id")&&(t=m.a.get(a,"app.localData.abc123.seasons.2019.farms.".concat(n.farm.id)));return t},showAddOperationButton:function(e,a){if(Object(A.a)(e),1==m.a.get(a,"app.OADAManager.connected")){var n=m.a.get(a,"app.OADAManager.currentConnection");return m.a.isEmpty(m.a.get(a,"app.oada.".concat(n,".bookmarks.seasons.2019.operations")))}return m.a.isEmpty(m.a.get(a,"app.localData.abc123.seasons.2019.operations"))}},x=n(49),C=n.n(x),_={bookmarks:{_type:"application/vnd.oada.bookmarks.1+json",_rev:0,fields:{_type:"application/vnd.oada.fields.1+json",_rev:0,fields:{"*":{_type:"application/vnd.oada.field.1+json",_rev:0,farm:{_type:"application/vnd.oada.farm.1+json"}}},farms:{"*":{_type:"application/vnd.oada.farm.1+json",_rev:0}}},seasons:{_type:"application/vnd.oada.seasons.1+json",_rev:0,"*":{_type:"application/vnd.oada.season.1+json",_rev:0,fields:{"*":{_type:"application/vnd.oada.field.1+json",_rev:0,operations:{"*":{_type:"application/vnd.oada.operation.1+json",_rev:0}}}},farms:{"*":{_type:"application/vnd.oada.farm.1+json",_rev:0}},operations:{"*":{_type:"application/vnd.oada.operation.1+json",_rev:0}}}}}},S=F,j={open:function(e){e.state.view.FieldDetails.open=!0},close:function(e){e.state.view.FieldDetails.open=!1},changeOADAFieldStatus:function(e,a){var n=e.state,t=e.actions,o=m.a.get(n,"view.Map.selectedField"),r=m.a.get(n,"view.TopBar.OperationDropdown.selectedOperationId"),i=m.a.get(n,"app.OADAManager.currentConnection"),c=m.a.clone(m.a.get(n,"app.oada.".concat(i,".bookmarks.seasons.2019.operations.").concat(r,".fields.").concat(o)))||{},s=a;if(c.status==a&&(s=null),c.status=s,null==c.status){var l=[{type:"application/vnd.oada.operation.1+json",path:"/bookmarks/seasons/2019/operations/".concat(r,"/fields/").concat(o)},{type:"application/vnd.oada.field.1+json",path:"/bookmarks/seasons/2019/fields/".concat(o,"/operations/").concat(r)}];return t.app.oada.delete({requests:l,connection_id:i})}var d=m.a.get(n,"view.TopBar.OperationDropdown.selectedOperation"),u=[{tree:_,data:c,type:"application/vnd.oada.operation.1+json",path:"/bookmarks/seasons/2019/operations/".concat(r,"/fields/").concat(o)},{tree:_,data:{_id:d._id},type:"application/vnd.oada.field.1+json",path:"/bookmarks/seasons/2019/fields/".concat(o,"/operations/").concat(r)}];return t.app.oada.put({requests:u,connection_id:i})},changeLocalFieldStatus:function(e,a){var n=e.state,t=(n.view.FieldDetails,m.a.get(n,"view.Map.selectedField")),o=m.a.get(n,"view.TopBar.OperationDropdown.selectedOperationId"),r=m.a.clone(m.a.get(n,"app.localData.abc123.seasons.2019.operations.".concat(o,".fields.").concat(t)))||{},i=a;r.status==a&&(i=null),r.status=i,null==r.status?(m.a.unset(n,"app.localData.abc123.seasons.2019.operations.".concat(o,".fields.").concat(t)),m.a.unset(n,"app.localData.abc123.seasons.2019.fields.".concat(t,".operations.").concat(o))):(m.a.set(n,"app.localData.abc123.seasons.2019.operations.".concat(o,".fields.").concat(t),r),null==m.a.get(n,"app.localData.abc123.seasons.2019.fields.".concat(t,".operations"))&&m.a.set(n,"app.localData.abc123.seasons.2019.fields.".concat(t,".operations"),{}),m.a.set(n,"app.localData.abc123.seasons.2019.fields.".concat(t,".operations.").concat(o),{}))},onStatusChange:function(e,a){var n=e.state,t=e.actions,o=a.status,r=t.view.FieldDetails;n.app.OADAManager.connected?r.changeOADAFieldStatus(o):r.changeLocalFieldStatus(o)},onAddNewOperationClick:function(e){e.actions.view.TopBar.OperationDropdown.onAdd()}},I={open:!1,selectedField:null},N={},B={fieldStyles:{},selectedField:null,editingField:null,bounds:[[41.44053877385792,-84.97886180877687],[41.46330393671208,-84.96770381927492]],fields:function(e,a){Object(A.a)(e);var n=m.a.get(a,"view.Map.fieldStyles"),t=m.a.get(a,"view.Map.editingField"),o=(m.a.get(a,"view.Map.BoundaryDrawing.drawing"),m.a.get(a,"view.TopBar.OperationDropdown.selectedOperation")),r=m.a.get(a,"app.seasonFields");return m.a.chain(r).mapValues((function(e,a){if(t==a)return null;var r=m.a.clone(e);if(null!=n[a]&&(r.style=n[a]),o){var i="white";o.fields&&o.fields[a]&&("planned"==o.fields[a].status&&(i="red"),"started"==o.fields[a].status&&(i="orange"),"done"==o.fields[a].status&&(i="green")),r.style=m.a.merge({},r.style,{fillColor:i,color:i})}return r})).omitBy((function(e,a){if(null==e)return!0})).value()}},T=n(84),R=n.n(T),P=n(532),q=n.n(P),W=n(533),Z=n.n(W),L={styleField:{highlight:function(e,a){var n=e.state;if(a){var t=m.a.get(n,"view.Map");m.a.set(t,"fieldStyles.".concat(a),{weight:5})}},unhighlight:function(e,a){var n=e.state;if(a){var t=m.a.get(n,"view.Map");m.a.set(t,"fieldStyles.".concat(a),{weight:3})}}},unselectField:function(e){return Object(b.a)(w.a.mark((function a(){var n,t,o,r;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,t=e.actions,o=m.a.get(t,"view.Map"),!(r=m.a.get(n,"view.Map")).selectedField){a.next=9;break}return t.view.FieldDetails.close(),o.styleField.unhighlight(r.selectedField),a.next=8,R.a.delay(200);case 8:r.selectedField=null;case 9:case"end":return a.stop()}}),a)})))()},onFieldClick:function(e,a){var n=e.state,t=e.actions,o=a.id,r=m.a.get(t,"view.Map"),i=m.a.get(n,"view.Map");m.a.get(i,"BoundaryDrawing.drawing")||(r.styleField.unhighlight(i.selectedField),i.selectedField=o,r.styleField.highlight(o),t.view.FieldDetails.open())},onMapClick:function(e,a){var n=e.actions,t=m.a.get(n,"view.Map");t.unselectField(),t.BoundaryDrawing.onMapClick(a)},zoomBounds:function(e,a){return Object(b.a)(w.a.mark((function a(){var n,t,o,r,i;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state,t=m.a.get(n,"view.Map"),o=m.a.compact(m.a.map(t.fields,(function(e){return e.boundary?{geo:e.boundary}:null}))),r=Z.a.parse(o,{GeoJSON:"geo"}),i=q()(r),t.bounds=[[i[1],i[0]],[i[3],i[2]]];case 6:case"end":return a.stop()}}),a)})))()}},G=n(47),z={boundary:{},drawing:!1},V={addPointToBoundary:function(e,a){var n=e.state.view.Map.BoundaryDrawing;m.a.set(n,"boundary.".concat(C()()),[a.lat,a.lng])},updateBoundaryPoint:Object(G.h)(Object(G.d)(10),Object(G.g)((function(e,a){var n=e.state.view.Map.BoundaryDrawing;m.a.set(n,"boundary.".concat(a.id),[a.latlng.lat,a.latlng.lng])}))),onMapClick:function(e,a){var n=e.state,t=e.actions,o=a.lat,r=a.lng,i=n.view.Map.BoundaryDrawing,c=t.view.Map.BoundaryDrawing;i.drawing&&c.addPointToBoundary({lat:o,lng:r})},onMarkerMove:function(e,a){e.actions.view.Map.BoundaryDrawing.updateBoundaryPoint(a)},onStartDrawing:function(e,a){var n=e.state.view.Map.BoundaryDrawing;n.boundary=(a||{}).boundary||{},n.drawing=!0},onStopDrawing:function(e,a){var n=e.state.view.Map.BoundaryDrawing;n.drawing=!1,n.boundary={}}},H=Object(y.a)({BoundaryDrawing:z},B),Y=Object(y.a)({BoundaryDrawing:V},L),U={OADADomain:{open:!1,domain:O.oadaDomain}},X={OADADomain:{open:function(e){e.state.view.Modals.OADADomain.open=!0},close:function(e){e.state.view.Modals.OADADomain.open=!1},onConnectClick:function(e){e.actions.view.Modals.OADADomain.open()},onDomainChange:function(e,a){var n=e.state,t=a.domain;n.view.Modals.OADADomain.domain=t},onConnect:function(e){return Object(b.a)(w.a.mark((function a(){var n,t,o,r,i;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=e.state,o=t.view.Modals.OADADomain,r=n.view.Modals.OADADomain,i=o.domain,o.loading=!0,a.next=7,n.app.OADAManager.onDomainChanged({domain:i});case 7:o.loading=!1,r.close();case 9:case"end":return a.stop()}}),a)})))()},onCancel:function(e){e.actions.view.Modals.OADADomain.close()}}};function J(e){var a={type:"Polygon",coordinates:[m.a.map(e,(function(e){return[e[1],e[0]]}))]};return a.coordinates&&a.coordinates[0]&&a.coordinates[0].length>0&&a.coordinates[0].push(a.coordinates[0][0]),a}function Q(e,a){var n=e.state,t=e.actions,o=a.fieldId,r=a.newBoundary,i=a.farmId,c=a.farm_id,s=a.seasonFarm_id,l=n.view.Modals.SaveField,d=t.app.getSeasonField(o),u=l.name,p={},f={};return u!=d.name&&(p.name=u),0==m.a.isEqual(r,d.boundary)&&(p.boundary=r),f=m.a.cloneDeep(p),s?d.farm&&d.farm._id==s||(p.farm={_id:s},f.farm={_id:c}):d.farm&&d.farm.id==i||(p.farm={id:i},f.farm={id:i}),{fieldChanges:f,seasonFieldChanges:p}}function K(e,a,n,t){var o=e.state;if(!m.a.isEmpty(n)||!m.a.isEmpty(t)){var r="app.localData.abc123.fields.fields.".concat(a);m.a.set(o,r,m.a.merge({},m.a.get(o,r),n));var i="app.localData.abc123.seasons.2019.fields.".concat(a);m.a.set(o,i,m.a.merge({},m.a.get(o,i),t))}}function $(e,a,n,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(b.a)(w.a.mark((function e(a,n,t,o){var r,i,c,s;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.state,i=a.actions,!m.a.isEmpty(t)||!m.a.isEmpty(o)){e.next=3;break}return e.abrupt("return");case 3:return c=[],0==m.a.isEmpty(t)&&c.push({tree:_,data:t,path:"/bookmarks/fields/fields/".concat(n)}),0==m.a.isEmpty(o)&&c.push({tree:_,data:o,path:"/bookmarks/seasons/2019/fields/".concat(n)}),console.log("fieldChanges",t),console.log("seasonFieldChanges",o),s=m.a.get(r,"app.OADAManager.currentConnection"),e.next=11,i.app.oada.put({requests:c,connection_id:s});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e,a){var n=a.boundary,t=a.farmId,o=a.farm_id;return{name:e.state.view.Modals.SaveField.name,boundary:n,farm:o?{_id:o}:{id:t}}}function ne(e,a){var n=a.field,t=e.state,o=C()();return m.a.set(t,"app.localData.abc123.fields.fields.".concat(o),n),m.a.set(t,"app.localData.abc123.seasons.2019.fields.".concat(o),Object(y.a)({},n,{operations:{},year:"2019"})),o}function te(e,a){return oe.apply(this,arguments)}function oe(){return(oe=Object(b.a)(w.a.mark((function e(a,n){var t,o,r,i,c,s,l;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.field,o=n.seasonField,r=a.state,i=a.actions,c=C()(),s=[],t&&s.push({tree:_,data:t,path:"/bookmarks/fields/fields/".concat(c)}),o&&s.push({tree:_,data:Object(y.a)({},o,{operations:{},year:"2019"}),path:"/bookmarks/seasons/2019/fields/".concat(c)}),l=m.a.get(r,"app.OADAManager.currentConnection"),e.next=9,i.app.oada.put({requests:s,connection_id:l});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re={open:!1,name:"",farmSearch:"",farms:function(e,a){var n=e.farmSearch;return m.a.compact(m.a.map(a.app.seasonFarms,(function(e,a){return!e||""!=n&&e.name&&-1==e.name.toLowerCase().search(n.toLowerCase())?null:{key:a,text:e.name,value:a}})))},farmId:null,farm:function(e,a){var n=e.farmId;e.farms;if(n)return m.a.get(a,"app.seasonFarms.".concat(n))}},ie={open:function(e){var a=e.state,n=e.actions,t=a.view.Modals.SaveField,o=m.a.get(a,"view.Map.editingField");if(null==o)t.name="";else{var r=n.app.getSeasonField(o);if(t.name=r.name,a.app.OADAManager.connected){var i=m.a.get(a,"app.oadaSeasonFarmsIdBy_id.".concat(m.a.get(r,"farm._id"),".id"));t.farmId=i}else t.farmId=m.a.get(r,"farm.id")}t.open=!0},close:function(e){e.state.view.Modals.SaveField.open=!1},saveField:function(e){return Object(b.a)(w.a.mark((function a(){var n,t,o,r,i,c,s,l,d,u,p,f,g,v,h;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,t=n.view.Modals.SaveField,o=m.a.get(n,"view.Map.BoundaryDrawing.boundary"),r=J(o),i=t.farmId,c=null,s=null,(l=t.farm)&&n.app.OADAManager.connected&&(c=m.a.get(n,"app.oadaOrgData.fields.farms.".concat(i,"._id")),s=m.a.get(n,"app.seasonFarms.".concat(i,"._id"))),!(d=m.a.get(n,"view.Map.editingField"))){a.next=15;break}u=Q(e,{fieldId:d,newBoundary:r,farmId:i,farm_id:c,seasonFarm_id:s}),p=u.fieldChanges,f=u.seasonFieldChanges,n.app.OADAManager.connected?$(e,d,p,f):K(e,d,p,f),a.next=31;break;case 15:if(!n.app.OADAManager.connected){a.next=26;break}return a.next=18,ae(e,{boundary:r,farm_id:c});case 18:return g=a.sent,a.next=21,ae(e,{boundary:r,farm_id:s});case 21:return v=a.sent,a.next=24,te(e,{field:g,seasonField:v});case 24:a.next=31;break;case 26:return a.next=28,ae(e,{boundary:r,farm:l,farmId:i});case 28:return h=a.sent,a.next=31,ne(e,{field:h});case 31:case"end":return a.stop()}}),a)})))()},onSave:function(e){var a=e.actions,n=e.state,t=a.view.Modals.SaveField;t.saveField(),a.view.Map.BoundaryDrawing.onStopDrawing(),n.view.Map.editingField=null,t.close()},onCancel:function(e){var a=e.actions,n=e.state,t=a.view.Modals.SaveField;a.view.Map.BoundaryDrawing.onStopDrawing(),n.view.Map.editingField=null,t.close()},onNameChange:function(e,a){var n=e.state,t=a.name;n.view.Modals.SaveField.name=t},onFarmSearchChange:function(e,a){e.state.view.Modals.SaveField.farmSearch=a},onFarmChange:function(e,a){var n=e.state,t=a.id;n.view.Modals.SaveField.farmId=t},onFarmAdd:function(e){e.actions.view.Modals.NewFarm.open({callbackAction:"view.Modals.SaveField.onFarmAddComplete"})},onFarmAddComplete:function(e,a){var n=e.state,t=a.id;n.view.Modals.SaveField.farmId=t}};function ce(e,a){var n=e.state,t=a.operation,o=C()();return m.a.set(n,"app.localData.abc123.seasons.2019.operations.".concat(o),t),o}function se(e,a){return le.apply(this,arguments)}function le(){return(le=Object(b.a)(w.a.mark((function e(a,n){var t,o,r,i,c,s,l,d;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,o=a.actions,r=n.operation,i=C()(),c=[{tree:_,data:r,path:"/bookmarks/seasons/2019/operations/".concat(i)}],s=m.a.get(t,"app.OADAManager.currentConnection"),e.next=7,o.app.oada.put({requests:c,connection_id:s});case 7:return l=e.sent,d=m.a.get(l,"responses.0.headers.content-location").substr(1),e.abrupt("return",{id:i,_id:d});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var de={open:!1,name:""},ue={open:function(e){var a=e.state.view.Modals.NewOperation;a.name="",a.open=!0},close:function(e){e.state.view.Modals.NewOperation.open=!1},saveOperation:function(e){return Object(b.a)(w.a.mark((function a(){var n,t,o,r,i,c;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,t=n.view.Modals.NewOperation,s={name:t.name},o={name:s.name,fields:{}},!n.app.OADAManager.connected){a.next=12;break}return a.next=6,se(e,{operation:o});case 6:r=a.sent,i=r.id,r._id,m.a.set(n,"view.TopBar.OperationDropdown.selected",i),a.next=16;break;case 12:return a.next=14,ce(e,{operation:o});case 14:c=a.sent,m.a.set(n,"view.TopBar.OperationDropdown.selected",c);case 16:case"end":return a.stop()}var s}),a)})))()},onNameChange:function(e,a){var n=e.state,t=a.name;n.view.Modals.NewOperation.name=t},onCancel:function(e){e.actions.view.Modals.NewOperation.close()},onSave:function(e){return Object(b.a)(w.a.mark((function a(){var n,t;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=n.view.Modals.NewOperation,a.next=4,t.saveOperation();case 4:t.close();case 5:case"end":return a.stop()}}),a)})))()}};function pe(e,a){var n=a.farm,t=e.state,o=C()();return m.a.set(t,"app.localData.abc123.farms.".concat(o),n),m.a.set(t,"app.localData.abc123.seasons.2019.farms.".concat(o),n),o}function fe(e,a){return me.apply(this,arguments)}function me(){return(me=Object(b.a)(w.a.mark((function e(a,n){var t,o,r,i,c,s,l,d,u;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.farm,o=a.state,r=a.actions,i=C()(),c=[{tree:_,data:t,path:"/bookmarks/fields/farms/".concat(i)},{tree:_,data:t,path:"/bookmarks/seasons/2019/farms/".concat(i)}],s=m.a.get(o,"app.OADAManager.currentConnection"),e.next=7,r.app.oada.put({requests:c,connection_id:s});case 7:if(l=e.sent,null!=(d=m.a.get(l,"responses.0.headers.content-location").substr(1))){e.next=11;break}throw"OADA did not return an _id when creating a farm.";case 11:if(null!=(u=m.a.get(l,"responses.1.headers.content-location").substr(1))){e.next=14;break}throw"OADA did not return an _id when creating a season farm.";case 14:return e.abrupt("return",{farm_id:d,seasonFarm_id:u,id:i});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ge={open:!1,name:""},ve={open:function(e,a){var n=e.state,t=a.callbackAction,o=n.view.Modals.NewFarm;o.name="",o.open=!0,o.callbackAction=t||null},close:function(e){e.state.view.Modals.NewFarm.open=!1},saveFarm:function(e){return Object(b.a)(w.a.mark((function a(){var n,t,o,r,i,c,s,l,d,u,p;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,t=e.actions,o=n.view.Modals.NewFarm,f={name:o.name},r={name:f.name},!n.app.OADAManager.connected){a.next=17;break}return a.next=6,fe(e,{farm:r});case 6:if(i=a.sent,c=i.farm_id,s=i.seasonFarm_id,l=i.id,!o.callbackAction){a.next=15;break}if(d=m.a.get(t,o.callbackAction)){a.next=14;break}throw"callbackAction: ".concat(o.callbackAction," does not exist.");case 14:d({farm_id:c,seasonFarm_id:s,id:l});case 15:a.next=25;break;case 17:return a.next=19,pe(e,{farm:r});case 19:if(u=a.sent,!o.callbackAction){a.next=25;break}if(p=m.a.get(t,o.callbackAction)){a.next=24;break}throw"callbackAction: ".concat(o.callbackAction," does not exist.");case 24:p({id:u});case 25:case"end":return a.stop()}var f}),a)})))()},onNameChange:function(e,a){var n=e.state,t=a.name;n.view.Modals.NewFarm.name=t},onCancel:function(e){e.actions.view.Modals.NewFarm.close()},onSave:function(e){return Object(b.a)(w.a.mark((function a(){var n,t;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=n.view.Modals.NewFarm,a.next=4,t.saveFarm();case 4:t.close();case 5:case"end":return a.stop()}}),a)})))()}},he=Object(y.a)({SaveField:re,NewOperation:de,NewFarm:ge},U),we=Object(y.a)({SaveField:ie,NewOperation:ue,NewFarm:ve},X),be={onAddField:function(e){e.actions.view.Map.BoundaryDrawing.onStartDrawing()},onSaveField:function(e){e.actions.view.Modals.SaveField.open()},onCancelField:function(e){var a=e.state,n=e.actions;a.view.Map.editingField=null,n.view.Map.BoundaryDrawing.onStopDrawing()},onEditField:function(e){var a=e.actions,n=e.state,t=n.view.FieldDetails.field;n.view.Map.editingField=n.view.FieldDetails.fieldId;var o={},r=m.a.get(t,"boundary.coordinates.0");r.length>0&&r.pop(),m.a.forEach(r||[],(function(e){o[C()()]=[e[1],e[0]]})),a.view.Map.BoundaryDrawing.onStartDrawing({boundary:o}),a.view.Map.unselectField()},onResetCache:function(e){return Object(b.a)(w.a.mark((function a(){var n;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,a.next=3,n.app.oada.resetCache();case 3:case"end":return a.stop()}}),a)})))()},onLogout:function(e){return Object(b.a)(w.a.mark((function a(){var n;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,a.next=3,n.view.Login.logout();case 3:case"end":return a.stop()}}),a)})))()}},ye={open:!1,selected:null,search:"",list:function(e,a){var n=e.selected,t=e.operations,o=m.a.get(a,"view.TopBar.OperationDropdown.search");return m.a.omitBy(m.a.mapValues(t,(function(e,a){var t=e.name;return null==a||""!=o&&-1==t.search(o)?null:{text:t,value:a,selected:n==a,label:{color:"green",empty:!0,circular:!0}}})),m.a.isEmpty)},operations:function(e,a){Object(A.a)(e);var n=null;if(1==m.a.get(a,"app.OADAManager.connected")){var t=m.a.get(a,"app.OADAManager.currentConnection");n=m.a.omitBy(m.a.get(a,"app.oada.".concat(t,".bookmarks.seasons.2019.operations"))||{},(function(e,a){return m.a.startsWith(a,"_")}))}else n=m.a.get(a,"app.localData.abc123.seasons.2019.operations");return n},selectedOperationId:function(e,a){var n=e.selected,t=e.operations,o=n;return null==o&&m.a.keys(t).length>0&&(o=m.a.keys(t)[0]),o},selectedOperation:function(e,a){var n=e.selectedOperationId;return e.operations[n]}},Oe={onAdd:function(e){var a=e.state,n=e.actions;return a.view.TopBar.OperationDropdown.open=!1,n.view.Modals.NewOperation.open()},onChange:function(e,a){var n=e.state,t=a.id,o=n.view.TopBar.OperationDropdown;o.selected=t,o.open=!1},onOpenChange:function(e,a){var n=e.state,t=a.open;n.view.TopBar.OperationDropdown.open=t},onSearch:function(e,a){var n=e.state,t=a.search;n.view.TopBar.OperationDropdown.search=t}},ke=Object(y.a)({OperationDropdown:ye},{}),De=Object(y.a)({OperationDropdown:Oe},be),Ae=Object(y.a)({Login:k,FieldDetails:S,FieldList:I,Map:H,Modals:he,TopBar:ke},{}),Ee=Object(y.a)({Login:D,FieldDetails:j,FieldList:N,Map:Y,Modals:we,TopBar:De},{}),Me=function(){var e=Object(b.a)(w.a.mark((function e(a){var n;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.actions,e.next=3,n.app.onInitialize();case 3:return e.next=5,n.view.Login.onInitialize();case 5:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),Fe={"42f60b10-784c-11ea-8dfd-a3e960f56105":{name:"1004 G-N",boundary:{type:"Polygon",coordinates:[[[-84.97584700584412,41.4628134964027],[-84.97539639472963,41.462765256171906],[-84.97495651245119,41.46275721612994],[-84.97424840927125,41.46250797433487],[-84.97405529022217,41.46203360827181],[-84.97410893440247,41.46044164256161],[-84.97139453887941,41.46130195211675],[-84.96770381927492,41.46327177680542],[-84.97010707855226,41.46330393671208],[-84.9764907360077,41.46306273702346],[-84.97634053230287,41.45965368547904],[-84.97462391853334,41.46024867436535],[-84.9746346473694,41.461004463187685],[-84.97491359710695,41.46126175098986],[-84.97492432594301,41.46172004235903],[-84.97529983520509,41.46208988917259],[-84.97581481933594,41.46234717266838],[-84.9761688709259,41.46278133625282]]]},farm:{id:"42f08cd0-784c-11ea-8dfd-a3e960f56105"}},"7c0ce950-784c-11ea-bfa5-97fea4f9bfd9":{name:"1001 HO-N",boundary:{type:"Polygon",coordinates:[[[-84.97347593307495,41.44864540647965],[-84.97626543045044,41.44856498851091],[-84.97617959976196,41.44784122230691],[-84.977445602417,41.44782513852177],[-84.97759580612183,41.44862932289387],[-84.97886180877687,41.448532821295515],[-84.97866868972778,41.44205080201176],[-84.97654438018799,41.442887227983185],[-84.97549295425415,41.44425443952937],[-84.97323989868165,41.44608806625952],[-84.97272491455078,41.44689227216232],[-84.97330427169801,41.44726220353039]]]},farm:{id:"42f08cd0-784c-11ea-8dfd-a3e960f56105"}},"8ab27420-784c-11ea-bfa5-97fea4f9bfd9":{name:"1002 HO-S",boundary:{type:"Polygon",coordinates:[[[-84.97152328491212,41.44697269220437],[-84.97148036956789,41.44166475561947],[-84.97152328491212,41.44111785263252],[-84.97347593307495,41.441085681725035],[-84.97373342514038,41.44073180069027],[-84.97635126113893,41.44053877385792],[-84.97645854949953,41.44134304853828],[-84.97607231140138,41.44161649965898],[-84.97611522674562,41.44240467585386],[-84.97540712356569,41.44398099952468]]]},farm:{id:"42f08cd0-784c-11ea-8dfd-a3e960f56105"}}},xe={"42f08cd0-784c-11ea-8dfd-a3e960f56105":{name:"Bowman and Bowman"},"52f08cd0-784c-11ea-8dfd-a3e960f56105":{name:"Martz Farms"}},Ce={acresStatus:function(e,a){Object(A.a)(e);var n=a.app.operationFields,t=a.app.seasonFields,o=0,r=0,i=0;m.a.forEach(n,(function(e,a){if(null!=e){var n=t[a];if(null!=n){var c=247105e-9*M.a.geometry(n.boundary);"planned"==e.status?o+=c:"started"==e.status?r+=c:"done"==e.status&&(i+=c)}}}));var c=o+r+i;return{planned:Math.round(o),plannedPercentage:Math.round(o/(c||1)*100),started:Math.round(r),startedPercentage:Math.round(r/(c||1)*100),done:Math.round(i),donePercentage:Math.round(i/(c||1)*100)}},seasonFarms:function(e,a){var n;if(Object(A.a)(e),1==m.a.get(a,"app.OADAManager.connected")){var t=m.a.get(a,"app.OADAManager.currentConnection");n=m.a.chain(a).get("app.oada.".concat(t,".bookmarks.seasons.2019.farms")).omitBy((function(e,a){return!!m.a.startsWith(a,"_")||(null==e||void 0)})).value()}else n=m.a.get(a,"app.localData.abc123.seasons.2019.farms");return n||{}},seasonFields:function(e,a){var n;if(Object(A.a)(e),1==m.a.get(a,"app.OADAManager.connected")){var t=m.a.get(a,"app.OADAManager.currentConnection");n=m.a.chain(a).get("app.oada.".concat(t,".bookmarks.seasons.2019.fields")).omitBy((function(e,a){return!!m.a.startsWith(a,"_")||(null==e||void 0)})).value()}else n=m.a.get(a,"app.localData.abc123.seasons.2019.fields");return n||{}},operationFields:function(e,a){Object(A.a)(e);var n=m.a.get(a,"view.TopBar.OperationDropdown.selectedOperationId"),t=[];if(null!=n)if(1==m.a.get(a,"app.OADAManager.connected")){var o=m.a.get(a,"app.OADAManager.currentConnection");t=m.a.get(a,"app.oada.".concat(o,".bookmarks.seasons.2019.operations.").concat(n,".fields"))||[]}else t=m.a.get(a,"app.localData.abc123.seasons.2019.operations.".concat(n,".fields"))||[];return t},currentOADA:function(e,a){if(Object(A.a)(e),a.app.OADAManager.connected){var n=a.app.OADAManager.currentConnection;if(!n)return;return a.app.oada[n]}},oadaOrgData:function(e){var a=e.currentOADA;if(a)return a.bookmarks},oadaSeasonFarmsIdBy_id:function(e,a){var n=e.oadaOrgData;return m.a.chain(n).get("seasons.2019.farms").mapValues((function(e,a){return e?{_id:e._id,id:a}:null})).omitBy(m.a.isNull).mapKeys((function(e,a){return e._id})).value()},oadaSeasonFarms_idByFarm_id:function(e,a){var n=e.oadaOrgData;return m.a.chain(n).get("fields.farms").mapValues((function(e,a){return e?{seasonFarm_id:m.a.get(n,"seasons.2019.farms.".concat(a,"._id")),farm_id:e._id}:null})).omitBy(m.a.isNull).mapKeys((function(e,a){return e.farm_id})).value()},localOrgData:function(e){return e.localData.abc123},localData:{organizations:{abc123:{name:"Default"}},abc123:{fields:{fields:Object(y.a)({},Fe),farms:Object(y.a)({},xe)},seasons:{2019:{fields:Object(y.a)({},Fe),farms:Object(y.a)({},xe),operations:{}}}}}},_e={getSeasonField:function(e,a){var n=e.state,t=[];if(1==m.a.get(n,"app.OADAManager.connected")){var o=m.a.get(n,"app.OADAManager.currentConnection");t=m.a.get(n,"app.oada.".concat(o,".bookmarks.seasons.2019.fields"))}else t=m.a.get(n,"app.localData.abc123.seasons.2019.fields");return t[a]},getSeasonFarm:function(e,a){var n=e.state,t=[];if(1==m.a.get(n,"app.OADAManager.connected")){var o=m.a.get(n,"app.OADAManager.currentConnection");t=m.a.get(n,"app.oada.".concat(o,".bookmarks.seasons.2019.farms"))}else t=m.a.get(n,"app.localData.abc123.seasons.2019.farms");return t[a]},onInitialize:function(e){e.state;e.actions.view.Map.zoomBounds()}},Se={connected:!1,currentConnection:null,domain:null,token:null,user:function(e,a){return e.currentConnection?m.a.get(a,"app.oada.localhost.users.me"):null}},je=n(534),Ie=R.a.promisify(je.browser.getAccessToken),Ne=Se,Be={getToken:function(e,a){return Object(b.a)(w.a.mark((function n(){var t,o,r;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,!(o=t.app.OADAManager).token){n.next=4;break}return n.abrupt("return",o.token);case 4:return n.next=6,Ie(a.replace(/^https?:\/\//,""),{metadata:O.METADATA,scope:O.SCOPE,redirect:O.REDIRECT});case 6:return r=n.sent,n.abrupt("return",r.access_token);case 8:case"end":return n.stop()}}),n)})))()},connect:function(e,a){return Object(b.a)(w.a.mark((function n(){var t,o,r,i,c,s;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.actions,o=e.state,e.effects,r=a.domain,i=a.token,c=o.app.OADAManager,s=t.app.OADAManager,i&&(c.token=i),n.next=7,s.getToken(r);case 7:return i=n.sent,n.abrupt("return",t.app.oada.connect({token:i,domain:r,options:O.OPTIONS,cache:!1}).then((function(e){return e.error||(c.currentConnection=e.connectionId,c.token=e.token,c.connected=!0,o.view.TopBar.OperationDropdown.selected=null),e})));case 9:case"end":return n.stop()}}),n)})))()},logout:function(e){return Object(b.a)(w.a.mark((function a(){var n,t,o,r;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=e.state,o=t.app.OADAManager,r=o.currentConnection,o.token=null,a.next=6,n.app.oada.disconnect({connection_id:r});case 6:case"end":return a.stop()}}),a)})))()},getUserInfo:function(e){return Object(b.a)(w.a.mark((function a(){var n,t,o,r,i;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=e.state,o=t.app.OADAManager,r=o.currentConnection,i=[{path:"/users/me"}],a.next=6,n.app.oada.get({requests:i,connection_id:r});case 6:case"end":return a.stop()}}),a)})))()},fetchAndWatch:function(e){return Object(b.a)(w.a.mark((function a(){var n,t,o,r,i,c,s,l,d;return w.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=e.state,o=t.app.OADAManager,r=o.currentConnection,i=[{path:"/bookmarks/fields",tree:_,watch:{actions:[n.app.OADAManager.onFieldChanged]}},{path:"/bookmarks/seasons",tree:_,watch:{actions:[n.app.OADAManager.onSeasonsChanged]}}],a.next=6,n.app.oada.get({requests:i,connection_id:r});case 6:if(c=a.sent,s=[],!c.responses[0].error){a.next=15;break}if(404==c.responses[0].status){a.next=11;break}throw c.responses[0].error;case 11:return l=[{tree:_,data:{fields:{},farms:{}},path:"/bookmarks/fields"}],a.next=14,n.app.oada.put({requests:l,connection_id:r});case 14:s.push(i[0]);case 15:if(!c.responses[1].error){a.next=22;break}if(404==c.responses[1].status){a.next=18;break}throw c.responses[0].error;case 18:return d=[{tree:_,data:{},path:"/bookmarks/seasons"}],a.next=21,n.app.oada.put({requests:d,connection_id:r});case 21:s.push(i[1]);case 22:if(!(s.length>0)){a.next=25;break}return a.next=25,n.app.oada.get({requests:s,connection_id:r});case 25:case"end":return a.stop()}}),a)})))()},initSeasonFields:function(e){var a=e.state,n=e.actions.app.OADAManager,t=[];return m.a.forEach(m.a.get(a,"app.oadaOrgData.fields.fields"),(function(e,a){m.a.startsWith(a,"_")||t.push({fieldId:a,name:e.name,boundary:e.boundary,farm:e.farm})})),n.changeSeasonFields(t)},initSeasonFarms:function(e){var a=e.state,n=e.actions.app.OADAManager,t=[];return m.a.forEach(m.a.get(a,"app.oadaOrgData.fields.farms"),(function(e,a){m.a.startsWith(a,"_")||t.push({farmId:a,name:e.name})})),n.changeSeasonFarms(t)},changeSeasonFields:function(e,a){return Object(b.a)(w.a.mark((function n(){var t,o,r,i,c,s;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,o=e.actions,r=t.app.OADAManager,i=r.currentConnection,c=[],s=t.app.seasonFields,m.a.forEach(a,(function(e){if(null!=e.fieldId){var a={},n=s[e.fieldId];if(e.name&&(null!=n&&n.name==e.name||(a.name=e.name)),e.boundary&&(null!=n&&0!=m.a.isEqual(n.boundary,e.boundary)||(a.boundary=e.boundary)),e.farm){var o=m.a.get(e,"farm._id");if(o){var r=m.a.get(t,"app.oadaSeasonFarms_idByFarm_id.".concat(o,".seasonFarm_id"));(null==n||null==n.farm||null==n.farm._id||null!=r&&n.farm._id!=r)&&(a.farm=m.a.merge({},a.farm,{_id:r}))}}m.a.isEmpty(a)||c.push({tree:_,data:a,type:"application/vnd.oada.field.1+json",path:"/bookmarks/seasons/2019/fields/".concat(e.fieldId)})}})),0!=c.length){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,o.app.oada.put({requests:c,connection_id:i});case 10:case"end":return n.stop()}}),n)})))()},changeSeasonFarms:function(e,a){return Object(b.a)(w.a.mark((function n(){var t,o,r,i,c,s;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,o=e.actions,r=t.app.OADAManager,i=r.currentConnection,c=[],s=t.app.seasonFarms,m.a.forEach(a,(function(e){if(null!=e.farmId){var a={},n=s[e.farmId];e.name&&(null!=n&&n.name==e.name||(a.name=e.name)),m.a.isEmpty(a)||c.push({tree:_,data:a,type:"application/vnd.oada.farm.1+json",path:"/bookmarks/seasons/2019/farms/".concat(a.id)})}})),0!=c.length){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,o.app.oada.put({requests:c,connection_id:i});case 10:case"end":return n.stop()}}),n)})))()},deleteSeasonFields:function(e,a){return Object(b.a)(w.a.mark((function n(){var t,o,r,i,c,s;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,o=e.actions,console.log("delete season fields",a),r=t.app.OADAManager,i=r.currentConnection,c=[],s=t.app.seasonFields,m.a.forEach(a,(function(e){s[e]&&c.push({tree:_,type:"application/vnd.oada.field.1+json",path:"/bookmarks/seasons/2019/fields/".concat(e)})})),0!=c.length){n.next=9;break}return n.abrupt("return");case 9:return n.next=11,o.app.oada.delete({requests:c,connection_id:i});case 11:case"end":return n.stop()}}),n)})))()},deleteSeasonFarms:function(e,a){return Object(b.a)(w.a.mark((function n(){var t,o,r,i,c,s;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,o=e.actions,console.log("delete season farms",a),r=t.app.OADAManager,i=r.currentConnection,c=[],s=t.app.seasonFarms,m.a.forEach(a,(function(e){s[e]&&c.push({tree:_,type:"application/vnd.oada.farm.1+json",path:"/bookmarks/seasons/2019/farms/".concat(e)})})),0!=c.length){n.next=9;break}return n.abrupt("return");case 9:return n.next=11,o.app.oada.delete({requests:c,connection_id:i});case 11:case"end":return n.stop()}}),n)})))()},login:function(e,a){return Object(b.a)(w.a.mark((function n(){var t,o,r,i,c,s,l;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.actions,o=e.state,r=a.domain,i=a.token,c=o.app.OADAManager,s=t.app.OADAManager,c.domain=r,n.next=7,s.connect({domain:r,token:i});case 7:if(l=n.sent,l.error){n.next=20;break}return n.next=12,s.getUserInfo();case 12:return n.next=14,s.fetchAndWatch();case 14:return n.next=16,s.initSeasonFarms();case 16:return n.next=18,s.initSeasonFields();case 18:return n.next=20,t.view.Map.zoomBounds();case 20:case"end":return n.stop()}}),n)})))()},onFieldChanged:function(e,a){return Object(b.a)(w.a.mark((function n(){var t,o,r,i,c,s,l,d,u;return w.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e.state,t=e.actions,console.log("onFieldChanged",a),o=t.app.OADAManager,"merge"==(r=m.a.get(a,"response.change.type"))||"delete"==r?(i=!1,c=m.a.get(a,"response.change.wasDelete"),("deleted"==r||c)&&(i=!0),s=[],l=[],m.a.forEach(m.a.get(a,"response.change.body.data.fields"),(function(e,n){"undefined"!=n?i?l.push(n):s.push({fieldId:n,deleted:i,name:m.a.get(e,"name"),boundary:m.a.get(e,"boundary")}):console.log("WARNING: Received a bad field change from OADA",a)})),l.length>0&&o.deleteSeasonFields(l),s.length>0&&o.changeSeasonFields(s),d=[],u=[],m.a.forEach(m.a.get(a,"response.change.body.data.farms"),(function(e,n){"undefined"!=n?i?u.push(n):d.push({farmId:n,deleted:i,name:m.a.get(e,"name")}):console.log("WARNING: Received a bad farm change from OADA",a)})),u.length>0&&o.deleteSeasonFarms(u),d.length>0&&o.changeSeasonFarms(d)):console.warn("onFieldChanged: Unsupported change type:",r);case 5:case"end":return n.stop()}}),n)})))()},onSeasonsChanged:function(e,a){e.state,e.actions}},Te=n(535),Re=n.n(Te)()("app.oada"),Pe=Object(y.a)({oada:Re.state,OADAManager:Ne},Ce),qe=Object(y.a)({oada:Re.actions,OADAManager:Be},_e),We={oada:Re.effects},Ze=Object(v.a)({view:t,app:o}),Le=Object(g.b)(),Ge=n(1092),ze=n(1072),Ve=n(1030);function He(){var e=Object(u.a)(["\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        font-size: 1.2em;\n        color: #FFFFFF;\n        cursor: pointer;\n      "]);return He=function(){return e},e}function Ye(){var e=Object(u.a)(["\n          display: flex;\n          flex-direction: column;\n        "]);return Ye=function(){return e},e}function Ue(){var e=Object(u.a)(["\n        width: 400px;\n        display: flex;\n        flex-direction: column;\n        background: #fff;\n        padding: 15px;\n        padding-top: 7px;\n        border-radius: 5px;\n      "]);return Ue=function(){return e},e}function Xe(){var e=Object(u.a)(["\n      height: 100vh;\n      width: 100vw;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      background: url(imgs/login-background.jpg) no-repeat center center fixed;\n      background-size: cover;\n    "]);return Xe=function(){return e},e}var Je=function(){var e=Le(),a=e.state,n=e.actions,t=a.view.Login,o=n.view.Login;return Object(p.b)("div",{css:Object(p.a)(Xe())},Object(p.b)("div",{css:Object(p.a)(Ue())},Object(p.b)("img",{css:{height:300},src:"imgs/logo2.svg",alt:"logo"}),Object(p.b)(Ge.a,{css:Object(p.a)(Ye()),onSubmit:o.login},Object(p.b)(ze.a,{placeholder:"OADA Domain...",value:t.domain,onChange:function(e,a){return o.domainChange(a)}}),Object(p.b)(Ve.a,{style:{marginTop:7},primary:!0,loading:t.loading,disabled:t.loading},"Connect to Your OADA Cloud"),Object(p.b)(Ve.a,{style:{marginTop:7},onClick:o.viewDemo,disabled:t.loading},"View Demo"))),Object(p.b)("a",{css:Object(p.a)(He()),onClick:o.logout},"Logout"))},Qe=n(1100),Ke=n(1101),$e=(n(966),n(1073)),ea=n(1074),aa=n(1075);function na(){var e=Le(),a=e.state,n=e.actions,t=a.view.Map.BoundaryDrawing,o=n.view.Map.BoundaryDrawing,r=t.boundary,c=t.drawing,s=o.onMarkerMove;return c?i.a.createElement($e.a,null,i.a.createElement(ea.a,{positions:m.a.map(r)}),m.a.map(r,(function(e,a){return i.a.createElement(aa.a,{position:e,key:a,draggable:!0,onMove:function(e){var n=e.latlng,t=e.oldLatLng;return s({latlng:n,oldLatLng:t,id:a})}})}))):null}var ta=n(1076);function oa(){var e=Le(),a=e.state,n=e.actions,t=a.view.Map,o=n.view.Map,r=t.fields,c=o.onFieldClick;return 0==m.a.keys(r).length?null:i.a.createElement($e.a,null,m.a.map(r,(function(e,a){return i.a.createElement(ta.a,{bubblingMouseEvents:!1,style:e.style,data:e.boundary,key:C()(),onClick:function(e){c({id:a})}})})))}function ra(){var e=Le(),a=e.actions,n=e.state,t=a.view.Map,o=n.view.Map;return i.a.createElement(Qe.a,{bounds:o.bounds,center:[41.448068,-84.972648],zoom:13,onClick:function(e){return t.onMapClick(Object(y.a)({},e.latlng))},zoomControl:!1},i.a.createElement(Ke.a,{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles \xa9 Esri \u2014 Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),i.a.createElement(na,null),i.a.createElement(oa,null))}var ia=n(1085),ca=n(1080),sa=n(1077),la=n(1081);function da(){var e=Le().actions.view.TopBar;return i.a.createElement(sa.a,null,i.a.createElement(ca.a,{style:{flex:1}}),i.a.createElement(la.a,{color:"inherit",onClick:function(){return e.onCancelField()}},"Cancel"),i.a.createElement(la.a,{color:"inherit",onClick:function(){return e.onSaveField()}},"Save"))}var ua=n(1096);function pa(e){var a=e.style,n=Le(),t=n.actions,o=n.state,r=t.view.TopBar.OperationDropdown,c=o.view.TopBar.OperationDropdown,s=c.selectedOperation,l=c.list,d=c.open,u=c.search,p=r.onAdd,f=r.onChange,g=r.onOpenChange,v=r.onSearch;return i.a.createElement(ca.a,{style:a},i.a.createElement(ca.a,{style:{flexDirection:"row"}},s?i.a.createElement(ua.a,{open:d,onOpen:function(){g({open:!0})},onBlur:function(){g({open:!1})},text:s.name,icon:"cog",floating:!0,labeled:!0,button:!0,className:"icon"},i.a.createElement(ua.a.Menu,{style:{top:42}},i.a.createElement(ua.a.Item,{style:{textAlign:"center"},text:"Add New Operation",value:"Add New Operation",onClick:function(e,a){p()}}),i.a.createElement(ze.a,{icon:"search",iconPosition:"left",className:"search",style:{marginTop:3},value:u,onChange:function(e){v({search:e.target.value})}}),i.a.createElement(ua.a.Menu,{scrolling:!0},m.a.map(l,(function(e){return i.a.createElement(ua.a.Item,Object.assign({key:e.value},e,{onClick:function(e,a){f({id:a.value})}}))}))))):i.a.createElement(ua.a,{onClick:function(){p()},open:!1,text:"Add New Operation",icon:"cog",floating:!0,labeled:!0,button:!0,className:"icon"}),i.a.createElement(ca.a,{style:{flex:1}})))}var fa=n(150),ma=n(1082),ga=n(565),va=n.n(ga),ha=n(1099),wa=n(1084);function ba(e){var a=e.style,n=Le(),t=n.actions,o=n.state,r=t.view.TopBar,c=i.a.useState(null),s=Object(fa.a)(c,2),l=s[0],d=s[1];function u(){d(null)}return i.a.createElement(ca.a,{style:a},i.a.createElement(ma.a,{edge:"end",color:"inherit","aria-label":"Menu",onClick:function(e){d(e.currentTarget)}},i.a.createElement(va.a,null)),i.a.createElement(ha.a,{style:{top:50,right:5},open:Boolean(l),keepMounted:!0,anchorEl:l,onClose:u},i.a.createElement(wa.a,{onClick:function(){u(),r.onAddField()}},"Add Field"),o.view.FieldDetails.open?i.a.createElement(wa.a,{onClick:function(){u(),r.onEditField()}},"Edit Field"):null,i.a.createElement(wa.a,{onClick:function(){u(),r.onLogout()}},"Logout")))}function ya(e){e.toggleTitle;return i.a.createElement(sa.a,null,i.a.createElement(pa,{style:{flex:1}}),i.a.createElement(ba,null))}function Oa(){var e=Le().state.view.Map.BoundaryDrawing.drawing;return i.a.createElement(ca.a,{style:{zIndex:1201}},i.a.createElement(ia.a,{position:"static"},e?i.a.createElement(da,null):i.a.createElement(ya,null)))}var ka=n(1098),Da=n(1083),Aa=n(1088),Ea=n(1029),Ma=n(1086),Fa=n(1087),xa=n(341),Ca=n.n(xa),_a=n(342),Sa=n.n(_a);function ja(){return i.a.createElement(ka.a,{open:!1,variant:"persistent"},i.a.createElement(ca.a,{style:{height:64}}),i.a.createElement("div",{style:{width:250},role:"presentation"},i.a.createElement(Da.a,null,["Inbox","Starred","Send email"].map((function(e,a){return i.a.createElement(Ea.a,{button:!0,key:e},i.a.createElement(Ma.a,null,a%2===0?i.a.createElement(Ca.a,null):i.a.createElement(Sa.a,null)),i.a.createElement(Fa.a,{primary:e}))}))),i.a.createElement(Aa.a,null),i.a.createElement(Da.a,null,["All mail","Trash","Spam"].map((function(e,a){return i.a.createElement(Ea.a,{button:!0,key:e},i.a.createElement(Ma.a,null,a%2===0?i.a.createElement(Ca.a,null):i.a.createElement(Sa.a,null)),i.a.createElement(Fa.a,{primary:e}))})))))}var Ia=n(1094),Na=n(1090),Ba=n(1091),Ta=n(1102),Ra=n(1089);function Pa(){var e=Le(),a=e.state,n=e.actions,t=a.view.FieldDetails,o=n.view.FieldDetails,r=t.open,c=t.field,s=t.farm,l=t.showAddOperationButton,d=o.onStatusChange;o.onEditFieldClick,o.onAddNewOperationClick;return Boolean(c)||(r=!1,c={}),i.a.createElement(ka.a,{anchor:"bottom",open:r,variant:"persistent"},i.a.createElement(ca.a,{style:{paddingBottom:20}},i.a.createElement(ca.a,{style:{flexDirection:"column",alignItems:"center"}},i.a.createElement(ca.a,{style:{justifyContent:"left",flexDirection:"row",alignItems:"center",marginTop:10}},i.a.createElement(Ra.a,{style:{fontWeight:"bold",fontSize:20}},c.name),i.a.createElement(Ra.a,{style:{marginLeft:7,fontSize:18}},"- ".concat(Math.round(c.acres)," ac"))),null==s?null:i.a.createElement(Ra.a,{style:{fontSize:15,color:"#999",marginTop:2,marginBottom:7}},s.name)),i.a.createElement(ca.a,{style:{justifyContent:"center",flexDirection:"row"}},l?i.a.createElement(Ve.a,{style:{marginTop:15},onClick:function(){return o.onAddNewOperationClick()}},"Add New Operation"):i.a.createElement(Ta.a,{component:"fieldset"},i.a.createElement(Na.a,{"aria-label":"position",name:"position",row:!0},i.a.createElement(Ba.a,{value:"bottom",control:i.a.createElement(Ia.a,{color:"primary",checked:"planned"==c.status||!1,onChange:function(){d({status:"planned"})}}),label:"Planned",labelPlacement:"bottom"}),i.a.createElement(Ba.a,{value:"bottom",control:i.a.createElement(Ia.a,{color:"primary",checked:"started"==c.status||!1,onChange:function(){d({status:"started"})}}),label:"Started",labelPlacement:"bottom"}),i.a.createElement(Ba.a,{value:"bottom",control:i.a.createElement(Ia.a,{color:"primary",checked:"done"==c.status||!1,onChange:function(){d({status:"done"})}}),label:"Done",labelPlacement:"bottom"}))))))}function qa(e){var a=e.acresStatus;return i.a.createElement(ca.a,{style:{backgroundColor:"#c50003",paddingLeft:7,paddingRight:7,paddingTop:5,paddingBottom:5,borderRadius:5}},i.a.createElement(Ra.a,{style:{color:"white",textShadowColor:"#000",textShadowOffset:{width:1,height:1},textShadowRadius:2}},"".concat(a.planned," ac (").concat(a.plannedPercentage,"%)")))}function Wa(e){var a=e.acresStatus;return i.a.createElement(ca.a,{style:{backgroundColor:"#eeb705",paddingLeft:7,paddingRight:7,paddingTop:5,paddingBottom:5,borderRadius:5,marginRight:7,marginLeft:7}},i.a.createElement(Ra.a,{style:{color:"white",textShadowColor:"#000",textShadowOffset:{width:1,height:1},textShadowRadius:2}},"".concat(a.started," ac (").concat(a.startedPercentage,"%)")))}function Za(e){var a=e.acresStatus;return i.a.createElement(ca.a,{style:{backgroundColor:"#5bb25f",paddingLeft:7,paddingRight:7,paddingTop:5,paddingBottom:5,borderRadius:5}},i.a.createElement(Ra.a,{style:{color:"white",textShadowColor:"#000",textShadowOffset:{width:1,height:1},textShadowRadius:2}},"".concat(a.done," ac (").concat(a.donePercentage,"%)")))}function La(){var e=Le().state,a=e.app.acresStatus;return e.view.TopBar.OperationDropdown.selectedOperationId?i.a.createElement(ca.a,{style:{position:"absolute",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",top:68,zIndex:401,width:"100vw"}},i.a.createElement(qa,{acresStatus:a}),i.a.createElement(Wa,{acresStatus:a}),i.a.createElement(Za,{acresStatus:a})):null}var Ga=n(1093),za=n(129);function Va(){var e=Le(),a=e.state,n=e.actions,t=a.view.Modals.SaveField,o=n.view.Modals.SaveField,r=(t.open,t.name),c=o.onNameChange,s=o.onCancel,l=o.onSave,d=i.a.useState(!1),u=Object(fa.a)(d,2),p=u[0],f=u[1],m=t.farm||{},g=t.farms;return i.a.createElement(Ga.a,{open:t.open,size:"tiny"},i.a.createElement(Ga.a.Header,null,a.view.Map.editingField?"Edit Field":"New Field"),i.a.createElement(Ga.a.Content,null,i.a.createElement(ca.a,{style:{flexDirection:"column",zIndex:1}},i.a.createElement(Ra.a,{style:{marginBottom:7}},"Field Name:"),i.a.createElement(Ge.a,{onSubmit:function(){return l()}},i.a.createElement(ze.a,{autoFocus:!0,placeholder:"Back 40",value:r,onChange:function(e){c({name:e.target.value})}})),i.a.createElement(Ra.a,{style:{marginBottom:7,marginTop:15}},"Farm:"),i.a.createElement(ua.a,{trigger:i.a.createElement(ca.a,{style:{paddingLeft:13,paddingRight:7,border:"1px solid rgba(34,36,38,.15)",borderRadius:".28571429rem",height:38,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},i.a.createElement(Ra.a,{style:{color:m.name?"rgba(0,0,0,.87)":"rgba(0,0,0,.25)"}},m.name||"Select a farm"),i.a.createElement(za.a,{name:"caret down",style:{paddingBottom:17}})),icon:null,onOpen:function(){f(!0)},onBlur:function(){f(!1)},open:p},i.a.createElement(ua.a.Menu,{style:{overflow:"hidden",maxHeight:"50vh"}},i.a.createElement(ua.a.Item,{style:{textAlign:"center"},text:"Add New Farm",value:"Add New Farm",onClick:function(e,a){o.onFarmAdd(),f(!1)}}),i.a.createElement(ze.a,{icon:"search",iconPosition:"left",className:"search",value:t.farmSearch,onChange:function(e){o.onFarmSearchChange(e.target.value)}}),i.a.createElement(ua.a.Menu,{scrolling:!0},g.map((function(e){return i.a.createElement(ua.a.Item,Object.assign({key:e.value},e,{onClick:function(){o.onFarmChange({id:e.value}),f(!1)}}))}))))))),i.a.createElement(Ga.a.Actions,null,i.a.createElement(Ve.a,{negative:!0,onClick:function(){return s()}},"Cancel"),i.a.createElement(Ve.a,{positive:!0,icon:"checkmark",labelPosition:"right",content:"Save",onClick:function(){return l()}})))}function Ha(){var e=Le(),a=e.state,n=e.actions,t=a.view.Modals.OADADomain,o=n.view.Modals.OADADomain,r=t.open,c=t.domain,s=o.onDomainChange,l=o.onCancel,d=o.onConnect;return i.a.createElement(Ga.a,{open:r,size:"tiny"},i.a.createElement(Ga.a.Header,null,"Connect to OADA Server"),i.a.createElement(Ga.a.Content,null,i.a.createElement(Ra.a,null,"Domain:"),i.a.createElement(ca.a,{style:{flexDirection:"row"}},i.a.createElement(ze.a,{style:{flex:1,marginTop:7},placeholder:"https://oada.openatk.com",value:c,onChange:function(e){s({domain:e.target.value})}}))),i.a.createElement(Ga.a.Actions,null,i.a.createElement(Ve.a,{negative:!0,onClick:function(){return l()}},"Cancel"),i.a.createElement(Ve.a,{positive:!0,icon:"checkmark",labelPosition:"right",content:"Connect",onClick:function(){return d({})}})))}function Ya(){var e=Le(),a=e.state,n=e.actions,t=a.view.Modals.NewOperation,o=n.view.Modals.NewOperation,r=t.open,c=t.name,s=o.onNameChange,l=o.onCancel,d=o.onSave;return i.a.createElement(Ga.a,{open:r,size:"tiny"},i.a.createElement(Ga.a.Header,null,"New Operation"),i.a.createElement(Ga.a.Content,null,i.a.createElement(Ra.a,null,"Name:"),i.a.createElement(ca.a,{style:{flexDirection:"row"}},i.a.createElement(Ge.a,{style:{flex:1},onSubmit:d},i.a.createElement(ze.a,{autoFocus:!0,style:{width:"100%",marginTop:7},placeholder:"Corn Planting",value:c,onChange:function(e){s({name:e.target.value})}})))),i.a.createElement(Ga.a.Actions,null,i.a.createElement(Ve.a,{negative:!0,onClick:function(){return l()}},"Cancel"),i.a.createElement(Ve.a,{positive:!0,icon:"checkmark",labelPosition:"right",content:"Save",onClick:function(){return d()}})))}function Ua(){var e=Le(),a=e.state,n=e.actions,t=a.view.Modals.NewFarm,o=n.view.Modals.NewFarm,r=t.open,c=t.name,s=o.onNameChange,l=o.onCancel,d=o.onSave;return i.a.createElement(Ga.a,{open:r,size:"tiny"},i.a.createElement(Ga.a.Header,null,"New Farm"),i.a.createElement(Ga.a.Content,null,i.a.createElement(Ra.a,null,"Name:"),i.a.createElement(ca.a,{style:{flexDirection:"row"}},i.a.createElement(ze.a,{style:{flex:1,marginTop:7},placeholder:"Bowman Farms",value:c,onChange:function(e){s({name:e.target.value})}}))),i.a.createElement(Ga.a.Actions,null,i.a.createElement(Ve.a,{negative:!0,onClick:function(){return l()}},"Cancel"),i.a.createElement(Ve.a,{positive:!0,icon:"checkmark",labelPosition:"right",content:"Save",onClick:function(){return d()}})))}var Xa=function(){return Le().state.view.Login.loggedIn?i.a.createElement("div",{className:"App"},i.a.createElement(Oa,null),i.a.createElement(La,null),i.a.createElement(ra,null),i.a.createElement(ja,null),i.a.createElement(Pa,null),i.a.createElement(Va,null),i.a.createElement(Ha,null),i.a.createElement(Ya,null),i.a.createElement(Ua,null)):i.a.createElement(Je,null)},Ja=Object(G.c)(Ze,{devtools:!0});s.a.render(i.a.createElement(g.a,{value:Ja},i.a.createElement(Xa,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},282:function(e,a){},535:function(e,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){return{state:t.default,effects:r.default,actions:(0,o.default)(e)}};var t=i(n(812)),o=i(n(813)),r=i(n(814));function i(e){return e&&e.__esModule?e:{default:e}}},593:function(e,a,n){e.exports=n(1026)},598:function(e,a,n){},599:function(e,a,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},600:function(e,a,n){},615:function(e,a){},617:function(e,a){},650:function(e,a){},651:function(e,a){},722:function(e,a){},812:function(e,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;a.default={connections:{}}},813:function(e,a,n){"use strict";var t=n(167);Object.defineProperty(a,"__esModule",{value:!0}),a.default=function(e){return d=e,{connect:function(e,a){var n=u(e),t=n.state,o=n.effects,r=a.connection_id||p(a.domain);return o.connect({connection_id:r,domain:a.domain,options:a.options,cache:a.cache,token:a.token,websocket:a.websocket}).then((function(e){return null==t[r]&&(t[r]={}),t[r].token=e.token,t[r].domain=a.domain,t[r].bookmarks&&(t[r].bookmarks={}),t.isAuthenticated=!0,{token:e.token,connectionId:r}})).catch((function(e){return t.error={error:e.message},t.isAuthenticated=!1,{error:e}}))},handleWatch:function(e,a){var n=u(e),t=n.state,o=(n.effects,null);if(a.nullPath&&((o=a.nullPath.split("/")).shift(),o.shift(),o=o.join(".")),"merge"===a.response.change.type){var r=i.default.get(t,"".concat(a.connection_id,".").concat(a.path)),c=i.default.cloneDeep(r);if(i.default.merge(r,a.response.change.body.data),a.response.change.wasDelete&&o){var s="".concat(a.path,".").concat(o);i.default.unset(t,"".concat(a.connection_id,".").concat(s))}return{oldState:c}}if("delete"===a.response.change.type){var l=i.default.cloneDeep(i.default.get(t,"".concat(a.connection_id,".").concat(a.path)));if(o){var d="".concat(a.path,".").concat(o);i.default.unset(t,"".concat(a.connection_id,".").concat(d))}return{oldState:l}}console.warn("oada-cache-overmind - UNKNOWN CHANGE TYPE:",a)},get:function(e,a){var n=u(e),r=n.state,c=n.effects,d=n.actions;if(!a.requests)throw new Error("Missing requests. Please pass requests in as an array of request objects under the requests key");var p=a.requests||[];return(a.concurrent?o.default.map:o.default.mapSeries)(p,(function(e,n){if(!e.complete){var o=e.path.replace(/^\//,"").split("/").join(".");if(e.watch){var u=r[e.connection_id||a.connection_id];if(u){if(u&&u.watches&&u.watches[e.path])return;e.watch.actions=[d.handleWatch].concat(t(e.watch.actions)),e.watch.payload=e.watch.payload||{},e.watch.payload.connection_id=e.connection_id||a.connection_id,e.watch.payload.path=o}}return c.get({connection_id:e.connection_id||a.connection_id,url:e.url,path:e.path,headers:e.headers,watch:e.watch,tree:e.tree||a.tree}).then((function(t){var c=t.data,s="".concat(e.connection_id||a.connection_id,".").concat(o);return c&&i.default.set(r,s,c),e.watch&&(s="".concat(e.connection_id||a.connection_id,".watches.").concat(e.path),i.default.set(r,s,!0)),p[n].complete=!0,t})).catch((function(e){return function(e){for(var a=1;a<arguments.length;a++){var n=null!=arguments[a]?arguments[a]:{};a%2?s(Object(n),!0).forEach((function(a){l(e,a,n[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(n,a))}))}return e}({error:e},e.response)}))}})).then((function(e){return{responses:e,requests:p}}))},put:function(e,a){var n=u(e),t=n.state,r=n.effects;n.actions;if(!a.requests)throw new Error("Missing requests. Please pass requests in as an array of request objects under the requests key");var c=a.requests||[];return(a.concurrent?o.default.map:o.default.mapSeries)(c,(function(e,n){if(!e.complete)return r.put({url:e.url,path:e.path,data:e.data,type:e.type,headers:e.headers,tree:e.tree||a.tree,connection_id:e.connection_id||a.connection_id}).then((function(o){var r="".concat(e.connection_id||a.connection_id).concat(e.path.split("/").join(".")),s=i.default.cloneDeep(i.default.get(t,r)),l=i.default.merge(s,e.data);return i.default.set(t,r,l),c[n].complete=!0,o}))})).then((function(e){return{responses:e,requests:c}}))},post:function(e,a){var n=u(e),t=n.state,r=n.effects;n.actions;if(!a.requests)throw new Error("Missing requests. Please pass requests in as an array of request objects under the requests key");var c=a.requests||[];return(a.concurrent?o.default.map:o.default.mapSeries)(c,(function(e,n){if(!e.complete)return r.post({url:e.url,path:e.path,data:e.data,type:e.type,headers:e.headers,tree:e.tree||a.tree,connection_id:e.connection_id||a.connection_id}).then((function(o){o.headers.location;var r="".concat(e.connection_id||a.connection_id).concat(e.path.split("/").join(".")),s=i.default.cloneDeep(i.default.get(t,r)),l=i.default.merge(s,e.data);i.default.set(t,r,l),c[n].complete=!0}))})).then((function(e){return{responses:e}}))},delete:function(e,a){var n=u(e),t=n.state,r=n.effects;n.actions;if(!a.requests)throw new Error("Missing requests. Please pass requests in as an array of request objects under the requests key");var c=a.requests||[];return(a.concurrent?o.default.map:o.default.mapSeries)(c,(function(e,n){if(!e.complete){var o=e.connection_id||a.connection_id,s=e.path.replace(/^\//,"").split("/").join("."),l=i.default.get(t,o);if(!(e.unwatch&&l&&l.watches)||l.watches[e.path])return r.delete({connection_id:o,url:e.url,path:e.path,headers:e.headers,unwatch:e.unwatch,type:e.type,tree:e.tree||a.tree}).then((function(a){return e.unwatch&&l&&l.watches?i.default.unset(t,"".concat(o,".watches.").concat(e.path)):i.default.unset(t,"".concat(o,".").concat(s)),c[n].complete=!0,a}))}})).then((function(e){return{responses:e,requests:c}}))},disconnect:function(e,a){var n=u(e);n.state;return n.effects.disconnect({connection_id:a.connection_id})},resetCache:function(e,a){var n=u(e),t=n.effects;n.state;return t.resetCache({connection_id:a.connection_id||p(a.domain)})}}};var o=c(n(169)),r=c(n(91)),i=c(n(211));function c(e){return e&&e.__esModule?e:{default:e}}function s(e,a){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);a&&(t=t.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),n.push.apply(n,t)}return n}function l(e,a,n){return a in e?Object.defineProperty(e,a,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[a]=n,e}var d=null;function u(e){return i.default.mapValues(e,(function(e){return null==d?e:i.default.get(e,d)}))}function p(e){return r.default.parse(e).hostname.replace(/\./g,"_")}},814:function(e,a,n){"use strict";Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var t=o(n(815));o(n(1027));function o(e){return e&&e.__esModule?e:{default:e}}var r={},i={connect:function(e){if(!e.connection_id)throw"connection_id not supplied";return e.connection_id&&r[e.connection_id]?Promise.resolve(r[e.connection_id]):t.default.connect(e).then((function(a){return a.cache={},r[e.connection_id]=a,a}))},get:function(e){if(!e.connection_id)throw"connection_id not supplied";if(e.watch&&e.watch.actions){var a=e.watch.actions;e.watch.func=function(e){a.forEach((function(a){a(e)}))}}return r[e.connection_id].get(e)},put:function(e){if(!e.connection_id)throw"connection_id not supplied";return r[e.connection_id].put(e)},post:function(e){if(!e.connection_id)throw"connection_id not supplied";return r[e.connection_id].post(e)},delete:function(e){if(!e.connection_id)throw"connection_id not supplied";return r[e.connection_id].delete(e)},resetCache:function(e){return r[e.connection_id].resetCache(e)},disconnect:function(e){if(!e.connection_id)throw"connection_id not supplied";var a=r[e.connection_id];return r[e.connection_id]=void 0,a.disconnect()}};a.default=i},966:function(e,a,n){}},[[593,1,2]]]);
//# sourceMappingURL=main.ebe3e1a9.chunk.js.map