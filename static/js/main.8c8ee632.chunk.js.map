{"version":3,"sources":["serviceWorker.js","config/index.js","overmind/view/Login/index.js","overmind/view/Login/state.js","overmind/view/Login/actions.js","overmind/view/FieldDetails/state.js","overmind/app/OADAManager/tree.js","overmind/view/FieldDetails/index.js","overmind/view/FieldDetails/actions.js","overmind/view/FieldList/index.js","overmind/view/FieldList/state.js","overmind/view/FieldList/actions.js","overmind/view/Map/state.js","overmind/view/Map/actions.js","overmind/view/Map/BoundaryDrawing/index.js","overmind/view/Map/BoundaryDrawing/state.js","overmind/view/Map/BoundaryDrawing/actions.js","overmind/view/Map/index.js","overmind/view/Modals/state.js","overmind/view/Modals/actions.js","overmind/view/Modals/SaveField/actions.js","overmind/view/Modals/SaveField/index.js","overmind/view/Modals/SaveField/state.js","overmind/view/Modals/NewOperation/actions.js","overmind/view/Modals/NewOperation/index.js","overmind/view/Modals/NewOperation/state.js","overmind/view/Modals/NewFarm/actions.js","overmind/view/Modals/NewFarm/index.js","overmind/view/Modals/NewFarm/state.js","overmind/view/Modals/index.js","overmind/view/TopBar/actions.js","overmind/view/TopBar/OperationDropdown/index.js","overmind/view/TopBar/OperationDropdown/state.js","overmind/view/TopBar/OperationDropdown/actions.js","overmind/view/TopBar/index.js","overmind/view/TopBar/state.js","overmind/view/index.js","overmind/view/state.js","overmind/view/actions.js","overmind/app/test/testFields.js","overmind/app/test/testFarms.js","overmind/app/state.js","overmind/app/actions.js","overmind/app/OADAManager/state.js","overmind/app/OADAManager/actions.js","overmind/app/OADAManager/index.js","overmind/app/index.js","overmind/index.js","view/Login/index.js","view/Map/BoundaryDrawing/index.js","view/Map/Fields/index.js","view/Map/index.js","view/TopBar/DrawingToolbar/index.js","view/TopBar/NormalToolbar/OperationDropdown/index.js","view/TopBar/NormalToolbar/MoreDropdown/index.js","view/TopBar/NormalToolbar/index.js","view/TopBar/index.js","view/FieldList/index.js","view/FieldDetails/index.js","view/AcresStatus/AcresPlanned/index.js","view/AcresStatus/AcresStarted/index.js","view/AcresStatus/AcresDone/index.js","view/AcresStatus/index.js","view/Modals/SaveField.js","view/Modals/OADADomain.js","view/Modals/NewOperation.js","view/Modals/NewFarm.js","view/App.js","index.js","../../../oada-cache-overmind/index.js","view/logo.svg","../../../oada-cache-overmind/state.js","../../../oada-cache-overmind/actions.js","../../../oada-cache-overmind/effects.js","../../../oada-cache/src/index.js","../../../oada-cache/src/cache.js","../../../oada-cache/src/websocket.js","../../../oada-cache/src/token.js"],"names":["Boolean","window","location","hostname","match","METADATA","REDIRECT","OPTIONS","redirect","metadata","scope","SCOPE","oadaDomain","state","domain","config","actions","onInitialize","localStorage","token","view","Login","login","myState","loading","app","OADAManager","connected","loggedIn","logout","domainChange","data","value","viewDemo","open","fieldId","_","get","field","selectedFieldId","operation","status","currentConnection","acres","geojsonArea","geometry","boundary","merge","farm","farmId","id","showAddOperationButton","isEmpty","bookmarks","_type","_rev","fields","farms","seasons","operations","_state","FieldDetails","close","changeOADAFieldStatus","operationId","clone","newStatus","requests","type","path","oada","delete","connection_id","tree","_id","put","changeLocalFieldStatus","unset","set","onStatusChange","myActions","onAddNewOperationClick","TopBar","OperationDropdown","onAdd","selectedField","fieldStyles","editingField","fieldsToRender","chain","mapValues","styledField","style","color","fillColor","omitBy","v","k","styleField","highlight","weight","unhighlight","unselectField","Promise","delay","onFieldClick","onMapClick","props","BoundaryDrawing","zoomBounds","map","f","geo","featureCollection","GeoJSON","parse","bounds","BBox","drawing","addPointToBoundary","Map","uuid","lat","lng","updateBoundaryPoint","pipe","debounce","mutate","latlng","onMarkerMove","onStartDrawing","onStopDrawing","_actions","OADADomain","Modals","onConnectClick","onDomainChange","onConnect","onDomainChanged","onCancel","convertToGEOJSON","points","p","getChanges","newBoundary","farm_id","seasonFarm_id","SaveField","seasonField","getSeasonField","newName","name","seasonFieldChanges","fieldChanges","isEqual","cloneDeep","saveChangesToLocalData","editingFieldId","fieldPath","seasonFieldPath","saveChangesToOADA","context","a","push","console","log","createField","addFieldToLocalData","year","addFieldToOADA","farmSearch","search","compact","seasonFarms","toLowerCase","key","text","saveField","onSave","onNameChange","onFarmSearchChange","onFarmChange","onFarmAdd","NewFarm","callbackAction","onFarmAddComplete","addOperationToLocalData","addOperationToOADA","ret","substr","NewOperation","saveOperation","addFarmToLocalData","addFarmToOADA","saveFarm","action","onAddField","onSaveField","onCancelField","onEditField","currentField","forEach","coors","onResetCache","resetCache","onLogout","selected","list","label","empty","circular","o","startsWith","selectedOperationId","selectedId","keys","length","selectedOperation","onChange","onOpenChange","onSearch","FieldList","acresStatus","operationFields","seasonFields","planned","started","done","fieldOperation","area","total","Math","round","plannedPercentage","startedPercentage","donePercentage","currentOADA","oadaOrgData","oadaSeasonFarmsIdBy_id","isNull","mapKeys","localOrgData","localData","abc123","organizations","testFields","testFarms","getSeasonFarm","user","getAccessToken","promisify","oadaIdClient","getToken","replace","res","access_token","connect","effects","options","cache","then","response","error","connectionId","disconnect","getUserInfo","fetchAndWatch","watchRequests","watch","onFieldChanged","onSeasonsChanged","rewatchRequests","responses","initSeasonFields","fieldsChanged","obj","changeSeasonFields","initSeasonFarms","changed","changeSeasonFarms","theSeasonFields","fieldChange","change","seasonFarm","deleteSeasonFields","deleted","deleteSeasonFarms","changeType","wasDelete","fieldsDeleted","farmsChanged","farmsDeleted","warn","oadaCacheOvermind","namespaced","createHook","overmind","css","height","src","alt","Form","onSubmit","Input","placeholder","evt","Button","marginTop","primary","disabled","onClick","LayerGroup","Polygon","positions","Marker","position","draggable","onMove","oldLatLng","Fields","bubblingMouseEvents","center","zoom","zoomControl","TileLayer","url","attribution","DrawingToolbar","Toolbar","View","flex","OperationsDropdown","flexDirection","Dropdown","onOpen","onBlur","icon","floating","labeled","button","className","Menu","top","Item","textAlign","iconPosition","target","scrolling","option","MoreDropdown","React","useState","anchorEl","setAnchorEl","handleClose","IconButton","edge","aria-label","event","currentTarget","right","keepMounted","onClose","MenuItem","NormalToolbar","toggleTitle","zIndex","AppBar","TemporaryDrawer","Drawer","variant","width","role","List","index","ListItem","ListItemIcon","ListItemText","Divider","onEditFieldClick","anchor","paddingBottom","alignItems","justifyContent","Text","fontWeight","fontSize","marginLeft","marginBottom","FormControl","component","FormGroup","row","FormControlLabel","control","Checkbox","checked","labelPlacement","AcresPlanned","backgroundColor","paddingLeft","paddingRight","paddingTop","borderRadius","textShadowColor","textShadowOffset","textShadowRadius","AcresStarted","marginRight","AcresDone","AcresStatus","display","farmOpen","setFarmOpen","farmOptions","Modal","size","Header","Content","autoFocus","trigger","border","Icon","overflow","maxHeight","Actions","negative","positive","labelPosition","content","App","createOvermind","devtools","ReactDOM","render","document","getElementById","navigator","serviceWorker","ready","registration","unregister","Object","defineProperty","exports","default","namespace","_effects","_interopRequireDefault","require","__esModule","module","connections","_namespace","ns","domainToConnectionId","websocket","isAuthenticated","catch","message","handleWatch","nullPath","split","shift","join","currentState","_lodash","concat","_oldState","body","deletePath","oldState","_deletePath","Error","concurrent","_bluebird","mapSeries","request","i","complete","_statePath","conn","watches","payload","headers","_responseData","arguments","source","ownKeys","_defineProperty","getOwnPropertyDescriptors","defineProperties","getOwnPropertyDescriptor","_objectSpread","newState","post","unwatch","_url","object","enumerableOnly","getOwnPropertySymbols","symbols","filter","sym","enumerable","apply","configurable","writable","domainUrl","_oadaCache","_default","args","resolve","func","connection","undefined","setupCache","urlLib","pointer","ws","axios","_TOKEN","info","dbprefix","process","on","reason","_replaceLinks","_makeResourceAndLink","_watch","_buildRequest","_sendRequest","_treeWalk","_recursiveFilterChange","_recursiveGet","_findDeepestResources","_convertSetupTreePath","_ensureTree","_configureCache","_recursiveDelete","del","reconnect","_getMemoryCache","CACHE","_token","renew","TOKEN","db","SOCKET","cleanUp","expires","method","req","pieces","treePath","has","result","subTree","link","got","removeLookup","DOMAIN","REQUEST","api","firstPath","storedTree","parentRev","slice","stored","piece","j","urlPath","setup","resp","resource","pathPieces","newPieces","z","err","test","cached","function","callback","watchResponse","dataOut","rv","beforeCb","afterCb","bef","nextTree","indexOf","authorization","header","requestStack","stack","watchPayload","handleWatchChange","waitTime","linkReq","resReq","parentPath","splice","NOCACHEREQUEST","Authorization","newHeaders","parseInt","Array","isArray","val","NAME","EXPIRES","socketApi","http","setDbPrefix","pfx","cq","PouchDB","memoryCache","cancellation","dbName","expiration","handleMemoryCache","resourceId","now","Date","access","valid","promise","putPending","doPut","doc","rev","dbUpsert","urlObj","pathLeftover","dbPut","accessed","memoryResult","INCOMPLETE_RESOURCE","cancel","remove","curData","newData","getResFromServer","getLookup","res_inmemory","headReq","getResFromDb","offline","revLimit","res_localdb","newReq","lookup","protocol","host","reqPieces","updateParent","replaceLinks","_meta","_recursiveUpsert","newBody","charAt","findNullValue","concurrency","findDeepestResource","deepestResource","setInterval","oldest","time","deleteCount","queue","limit","deletedPath","destroy","WebSocket","warnings","messages","socket","httpCallbacks","watchCallbacks","sendMessages","send","JSON","stringify","reject","onopen","oncloconsose","onmessage","requestId","statusText","originalStack","entries","reduce","b","STATUS_CODE","crypto","Token","param","self","this","_domain","_options","_dbprefix","hash","createHash","update","_name","digest","_isSet","_tokenDB","_expired","isSet","checkTokenDB","node","gat"],"mappings":"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","file":"static/js/main.8c8ee632.chunk.js","sourcesContent":["// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","const SCOPE = 'oada.yield:all';\nconst OPENATK_METADATA = 'eyJqa3UiOiJodHRwczovL2lkZW50aXR5Lm9hZGEtZGV2LmNvbS9jZXJ0cyIsImtpZCI6ImtqY1NjamMzMmR3SlhYTEpEczNyMTI0c2ExIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJyZWRpcmVjdF91cmlzIjpbImh0dHA6Ly9vcGVuYXRrLmNvbS9GaWVsZFdvcmtBcHAvb2F1dGgyL3JlZGlyZWN0Lmh0bWwiLCJodHRwOi8vbG9jYWxob3N0L29hdXRoMi9yZWRpcmVjdC5odG1sIl0sInRva2VuX2VuZHBvaW50X2F1dGhfbWV0aG9kIjoidXJuOmlldGY6cGFyYW1zOm9hdXRoOmNsaWVudC1hc3NlcnRpb24tdHlwZTpqd3QtYmVhcmVyIiwiZ3JhbnRfdHlwZXMiOlsiYXV0aG9yaXphdGlvbl9jb2RlIl0sInJlc3BvbnNlX3R5cGVzIjpbInRva2VuIiwiY29kZSIsImlkX3Rva2VuIiwiaWRfdG9rZW4gdG9rZW4iLCJjb2RlIGlkX3Rva2VuIiwiY29kZSB0b2tlbiIsImNvZGUgaWRfdG9rZW4gdG9rZW4iXSwiY2xpZW50X25hbWUiOiJPcGVuQVRLIiwiY2xpZW50X3VyaSI6Imh0dHA6Ly9vcGVuYXRrLmNvbSIsImNvbnRhY3RzIjpbIlNhbSBOb2VsIDxzYW5vZWxAcHVyZHVlLmVkdT4iXSwiandrcyI6eyJrZXlzIjpbeyJrdHkiOiJSU0EiLCJuIjoiemF1WkZCdU1kbHYxa1lqelViNHEtXzNtNHNtRnhuZnc0U1lvYUhxN2NpOFNjdFkzeGo3cmRBSHlrUXBuUVZyajZLTzhtYUh2LTBCdlc1TWhjZ2l2a3VZcy16SEV2ZllCZVZCbmN2SGdPa0pQYmM5MUN3X2l3T1k3RUhXQjhoTTdWaUxRVmNfRHYwaDhuSnliQnZoTDA0Q0hRdDdDcE10VllHNmZvSlhjM2RxNTJqTlFiQkhJWjVtN1Z6MUt0eXpvTGNwOE8ybWhhTHA0NVVyM0NfMWVHdHY4bjVOejliV19CaDVYRlliRHh2N0JuaFpOSXcxR0NiampBd210Ym5uTDdHZ2Y0Q3k2MHdSSG1SNHZvZTIxT0lqb0FTcTJqWjAzeDEybVhzN0hQSTNZQjR5Mjl3dlpNdzJnTHpPZFRvcnJxTy10bG1uMWJvUGtXS0pKU1hvQXZ3IiwiZSI6IkFRQUIifV19LCJzb2Z0d2FyZV9pZCI6ImE3MDNiZmRjLTNmYTEtNDk5Zi1iOTA1LTExZjBiNTRmMzgwNyIsInJlZ2lzdHJhdGlvbl9wcm92aWRlciI6Imh0dHBzOi8vaWRlbnRpdHkub2FkYS1kZXYuY29tIiwiaWF0IjoxNTMzODQ2MTEyfQ.Y9BlbqHzOvufADGAW9HG4Yx2rqbg6zPalpcjSS_97Mpg36lOuADGJ4YTQ2iQfRlZjzqBi1sUq3iFhReBfk89Oy2nSEY6RVPnONK5v6a73jce3xGPUWk8DDl3rf3lcrt-IqWFoAieUie7WK5nrPFIe-_xcgYdChnuGrugjO9dGOY';\nconst LOCALHOST_VIP_METADATA = 'eyJqa3UiOiJodHRwczovL2lkZW50aXR5Lm9hZGEtZGV2LmNvbS9jZXJ0cyIsImtpZCI6ImtqY1NjamMzMmR3SlhYTEpEczNyMTI0c2ExIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJyZWRpcmVjdF91cmlzIjpbImh0dHA6Ly92aXAzLmVjbi5wdXJkdWUuZWR1OjgwMDAvb2F1dGgyL3JlZGlyZWN0Lmh0bWwiLCJodHRwOi8vbG9jYWxob3N0OjgwMDAvb2F1dGgyL3JlZGlyZWN0Lmh0bWwiXSwidG9rZW5fZW5kcG9pbnRfYXV0aF9tZXRob2QiOiJ1cm46aWV0ZjpwYXJhbXM6b2F1dGg6Y2xpZW50LWFzc2VydGlvbi10eXBlOmp3dC1iZWFyZXIiLCJncmFudF90eXBlcyI6WyJpbXBsaWNpdCJdLCJyZXNwb25zZV90eXBlcyI6WyJ0b2tlbiIsImlkX3Rva2VuIiwiaWRfdG9rZW4gdG9rZW4iXSwiY2xpZW50X25hbWUiOiJPcGVuQVRLIiwiY2xpZW50X3VyaSI6Imh0dHBzOi8vdmlwMy5lY24ucHVyZHVlLmVkdSIsImNvbnRhY3RzIjpbIlNhbSBOb2VsIDxzYW5vZWxAcHVyZHVlLmVkdT4iXSwic29mdHdhcmVfaWQiOiIxZjc4NDc3Zi0zNTQxLTQxM2ItOTdiNi04NjQ0YjRhZjViYjgiLCJyZWdpc3RyYXRpb25fcHJvdmlkZXIiOiJodHRwczovL2lkZW50aXR5Lm9hZGEtZGV2LmNvbSIsImlhdCI6MTUxMjAwNjc2MX0.AJSjNlWX8UKfVh-h1ebCe0MEGqKzArNJ6x0nmta0oFMcWMyR6Cn2saR-oHvU8WrtUMEr-w020mAjvhfYav4EdT3GOGtaFgnbVkIs73iIMtr8Z-Y6mDEzqRzNzVRMLghj7CyWRCNJEk0jwWjOuC8FH4UsfHmtw3ouMFomjwsNLY0';\nconst REDIRECT_LOCALHOST = 'http://localhost:8000/oauth2/redirect.html';\nconst REDIRECT_OPENATK = 'http://openatk.com/FieldWorkApp/oauth2/redirect.html';\n\nlet METADATA;\nlet REDIRECT;\nlet oadaDomain = '';\nif (process.env.NODE_ENV !== 'production') {\n  console.log('NODE_ENV = ', process.env.NODE_ENV);\n  METADATA = LOCALHOST_VIP_METADATA;\n  REDIRECT = REDIRECT_LOCALHOST;\n  oadaDomain = 'https://localhost';\n} else {\n  METADATA = OPENATK_METADATA;\n  REDIRECT = REDIRECT_OPENATK;\n}\n\nlet OPTIONS = {\n    redirect: REDIRECT,\n    metadata: METADATA,\n    scope: SCOPE\n};\n\nexport default {\n  OPTIONS,\n  REDIRECT,\n  METADATA,\n  SCOPE,\n  oadaDomain\n}\n","import _state from './state'\nimport _actions from './actions'\n\nexport const state = _state;\nexport const actions = _actions;\n","import config from '../../../config'\nexport default {\n  domain: config.oadaDomain\n}\n","export default {\n  onInitialize({ state, actions }) {\n    const domain = window.localStorage['oada:domain'];\n    const token = window.localStorage['oada:token'];\n    if (domain) {\n      state.view.Login.domain = domain\n    }\n    if (domain && token) {\n      //Auto login\n      actions.view.Login.login({token});\n    }\n  },\n  async login({ state, actions }, {token}) {\n    const myState = state.view.Login;\n    let domain = myState.domain;\n    myState.loading = true;\n    domain = domain.match(/^http/) ? domain : 'https://'+myState.domain;\n    await actions.app.OADAManager.login({domain, token});\n    myState.loading = false;\n    if (state.app.OADAManager.connected) {\n      myState.loggedIn = true;\n      //Save domain and token\n      window.localStorage['oada:domain'] = myState.domain;\n      window.localStorage['oada:token'] = state.app.OADAManager.token;\n    }\n  },\n  async logout({ state, actions }) {\n    const myState = state.view.Login;\n    if (state.app.OADAManager.connected) {\n      await actions.app.OADAManager.logout();\n      delete window.localStorage['oada:domain']\n      delete window.localStorage['oada:token']\n    }\n    myState.loggedIn = false;\n  },\n  domainChange({ state }, data) {\n    const myState = state.view.Login;\n    myState.domain = data.value;\n  },\n  viewDemo({ state }, data) {\n    const myState = state.view.Login;\n    myState.loggedIn = true;\n  }\n}\n","import _ from 'lodash';\nimport geojsonArea from '@mapbox/geojson-area';\n\nexport default {\n  open: false,\n  fieldId: ({}, state) => {\n    return _.get(state, `view.Map.selectedField`);\n  },\n  field: ({fieldId: selectedFieldId}, state) => {\n    const operation = _.get(state, `view.TopBar.OperationDropdown.selectedOperation`);\n    if (selectedFieldId == null) return null;\n    const status = _.get(operation, `fields.${selectedFieldId}.status`, null);\n    let field = null;\n    if (_.get(state, `app.OADAManager.connected`) == true) {\n      let currentConnection = _.get(state, `app.OADAManager.currentConnection`)\n      field = _.get(state, `app.oada.${currentConnection}.bookmarks.seasons.2019.fields.${selectedFieldId}`); //TODO year\n    } else {\n      field = _.get(state, `app.localData.abc123.seasons.2019.fields.${selectedFieldId}`); //TODO year, organization\n    }\n    if (field == null) return null;\n    const acres = geojsonArea.geometry(field.boundary) * 0.000247105 //Meters to acres;\n    return _.merge({}, field, {status, acres});\n  },\n  farm: ({field}, state) => {\n    //Get farm for selected field\n    let farm = null;\n    if (_.get(state, `app.OADAManager.connected`) == true) {\n      let currentConnection = _.get(state, `app.OADAManager.currentConnection`)\n      if (_.get(field, 'farm._id')) {\n        const farmId = _.get(state, `app.oadaSeasonFarmsIdBy_id.${_.get(field, 'farm._id')}.id`)\n        farm = _.get(state, `app.oada.${currentConnection}.bookmarks.seasons.2019.farms.${farmId}`); //TODO year\n      }\n    } else {\n      if (_.get(field, 'farm.id')) {\n        farm = _.get(state, `app.localData.abc123.seasons.2019.farms.${field.farm.id}`); //TODO year, organization\n      }\n    }\n    return farm;\n  },\n  showAddOperationButton: ({}, state) => {\n    if (_.get(state, `app.OADAManager.connected`) == true) {\n      let currentConnection = _.get(state, `app.OADAManager.currentConnection`)\n      return _.isEmpty(_.get(state, `app.oada.${currentConnection}.bookmarks.seasons.2019.operations`)); //TODO year\n    } else {\n      return _.isEmpty(_.get(state, `app.localData.abc123.seasons.2019.operations`)); //TODO year\n    }\n  }\n}\n","export default {\n  bookmarks: {\n    _type: \"application/vnd.oada.bookmarks.1+json\",\n    _rev: 0,\n    fields: {\n      _type: \"application/vnd.oada.fields.1+json\",\n      _rev: 0,\n      fields: {\n        \"*\": {\n          _type: \"application/vnd.oada.field.1+json\",\n          _rev: 0,\n          farm: {\n            _type: \"application/vnd.oada.farm.1+json\",\n          }\n        }\n      },\n      farms: {\n        \"*\": {\n          _type: \"application/vnd.oada.farm.1+json\",\n          _rev: 0\n        }\n      }\n    },\n    seasons: {\n      _type: \"application/vnd.oada.seasons.1+json\",\n      _rev: 0,\n      \"*\": {\n        _type: \"application/vnd.oada.season.1+json\",\n        _rev: 0,\n        fields: {\n          \"*\": {\n            _type: \"application/vnd.oada.field.1+json\",\n            _rev: 0,\n            operations: {\n              \"*\": {\n                _type: \"application/vnd.oada.operation.1+json\",\n                _rev: 0\n              }\n            }\n          }\n        },\n        farms: {\n          \"*\": {\n            _type: \"application/vnd.oada.farm.1+json\",\n            _rev: 0\n          }\n        },\n        operations: {\n          \"*\": {\n            _type: \"application/vnd.oada.operation.1+json\",\n            _rev: 0\n          }\n        }\n      }\n    }\n  }\n};\n","import _state from './state'\nimport _actions from './actions'\n\nexport const state = _state;\nexport const actions = _actions;\n","import _ from 'lodash';\nimport uuid from 'uuid/v1';\nimport tree from '../../app/OADAManager/tree.js';\n\nexport default {\n  open({state}) {\n    const myState = state.view.FieldDetails;\n    myState.open = true;\n  },\n  close({state}) {\n    const myState = state.view.FieldDetails;\n    myState.open = false;\n  },\n  changeOADAFieldStatus({state, actions}, status) {\n    const selectedFieldId = _.get(state, `view.Map.selectedField`);\n    const operationId = _.get(state, `view.TopBar.OperationDropdown.selectedOperationId`)\n\n    let currentConnection = _.get(state, `app.OADAManager.currentConnection`)\n    let field = _.clone(_.get(state, `app.oada.${currentConnection}.bookmarks.seasons.2019.operations.${operationId}.fields.${selectedFieldId}`)) || {}; //TODO year, organization\n    let newStatus = status;\n    if (field.status == status) newStatus = null; //Unchecking\n    field.status = newStatus;\n    if (field.status == null) {\n      let requests = [\n        {  //Remove field to operation\n          type: 'application/vnd.oada.operation.1+json', //TODO oada.put should handle this\n          path: `/bookmarks/seasons/2019/operations/${operationId}/fields/${selectedFieldId}` //TODO year\n        },\n        { //Remove operation to field in season's field's operation list\n          type: 'application/vnd.oada.field.1+json',\n          path: `/bookmarks/seasons/2019/fields/${selectedFieldId}/operations/${operationId}` //TODO year\n        }\n      ];\n      return actions.app.oada.delete({requests, connection_id: currentConnection});\n    } else {\n      const operation = _.get(state, `view.TopBar.OperationDropdown.selectedOperation`)\n      let requests = [\n        {  //Add field to operation\n          tree,\n          data: field,\n          type: 'application/vnd.oada.operation.1+json', //TODO oada.put should handle this\n          path: `/bookmarks/seasons/2019/operations/${operationId}/fields/${selectedFieldId}` //TODO year\n        },\n        { //Add operation to field in season's field's operation list\n          tree,\n          data: {_id: operation._id}, //OADA _id\n          type: 'application/vnd.oada.field.1+json',\n          path: `/bookmarks/seasons/2019/fields/${selectedFieldId}/operations/${operationId}` //TODO year\n        }\n      ];\n      return actions.app.oada.put({requests, connection_id: currentConnection});\n    }\n  },\n  changeLocalFieldStatus({state}, status) {\n    const myState = state.view.FieldDetails;\n    const selectedFieldId = _.get(state, `view.Map.selectedField`);\n    const operationId = _.get(state, `view.TopBar.OperationDropdown.selectedOperationId`)\n    var field = _.clone(_.get(state, `app.localData.abc123.seasons.2019.operations.${operationId}.fields.${selectedFieldId}`)) || {}; //TODO year, organization\n    var newStatus = status;\n    if (field.status == status) newStatus = null; //Unchecking\n    field.status = newStatus;\n    if (field.status == null) {\n      //Remove field from operation\n      _.unset(state, `app.localData.abc123.seasons.2019.operations.${operationId}.fields.${selectedFieldId}`) //TODO year, organization\n      //Remove operation from season's field's operation list\n      _.unset(state, `app.localData.abc123.seasons.2019.fields.${selectedFieldId}.operations.${operationId}`) //TODO year, organization\n    } else {\n      //Add field to operation\n      _.set(state, `app.localData.abc123.seasons.2019.operations.${operationId}.fields.${selectedFieldId}`, field) //TODO year, organization\n      //Create operations key on season's field list if doesn't exist\n      if (_.get(state, `app.localData.abc123.seasons.2019.fields.${selectedFieldId}.operations`) == null) _.set(state, `app.localData.abc123.seasons.2019.fields.${selectedFieldId}.operations`, {}) //TODO year, organization\n      //Add operation to field in season's field's operation list\n      _.set(state, `app.localData.abc123.seasons.2019.fields.${selectedFieldId}.operations.${operationId}`, {}) //TODO year, organization\n    }\n  },\n  onStatusChange({state, actions}, {status}) {\n    const myActions = actions.view.FieldDetails;\n    if (state.app.OADAManager.connected) {\n      myActions.changeOADAFieldStatus(status)\n    } else {\n      myActions.changeLocalFieldStatus(status)\n    }\n  },\n  onAddNewOperationClick({actions}) {\n    actions.view.TopBar.OperationDropdown.onAdd();\n  }\n}\n","import _state from './state'\nimport _actions from './actions'\n\nexport const state = _state;\nexport const actions = _actions;\n","export default {\n  open: false,\n  selectedField: null\n}\n","export default {\n  \n}\n","import _ from 'lodash';\n\nexport default {\n  fieldStyles: {},\n  selectedField: null,\n  editingField: null,\n  fields: ({}, state) => {\n    const fieldStyles = _.get(state, `view.Map.fieldStyles`)\n    const editingField = _.get(state, `view.Map.editingField`)\n    const drawingBoundary = _.get(state, `view.Map.BoundaryDrawing.drawing`)\n    const operation = _.get(state, `view.TopBar.OperationDropdown.selectedOperation`)\n    const fieldsToRender = _.get(state, `app.seasonFields`);\n    return _.chain(fieldsToRender).mapValues((field, id) => {\n      if (editingField == id) return null; //Don't show this field.\n      var styledField = _.clone(field);\n      //Add any styles\n      if (fieldStyles[id] != null) styledField.style = fieldStyles[id];\n      //Fill based on status of current operation\n      if (operation) {\n        var color = \"white\"\n        if (operation.fields && operation.fields[id]) {\n          if (operation.fields[id].status == 'planned') color = 'red'\n          if (operation.fields[id].status == 'started') color = 'orange'\n          if (operation.fields[id].status == 'done') color = 'green'\n        }\n        styledField.style = _.merge({}, styledField.style, {fillColor: color, color})\n      }\n      return styledField;\n    }).omitBy((v, k) => {\n      if (v == null) return true;\n    }).value();\n  }\n}\n","import _ from 'lodash';\nimport Promise from 'bluebird';\nimport BBox from '@turf/bbox';\nimport GeoJSON from 'geojson';\n\nexport default {\n  styleField: {\n    highlight({state}, fieldId) {\n      if (fieldId) {\n        const myState = _.get(state, 'view.Map');\n        _.set(myState, `fieldStyles.${fieldId}`, {weight: 5})\n      }\n    },\n    unhighlight({state}, fieldId) {\n      if (fieldId) {\n        const myState = _.get(state, 'view.Map');\n        _.set(myState, `fieldStyles.${fieldId}`, {weight: 3})\n      }\n    }\n  },\n  async unselectField({state, actions}) {\n    const myActions = _.get(actions, 'view.Map');\n    const myState = _.get(state, 'view.Map');\n    if (myState.selectedField) {\n      actions.view.FieldDetails.close();\n      myActions.styleField.unhighlight(myState.selectedField);\n      await Promise.delay(200)\n      myState.selectedField = null;\n    }\n  },\n  onFieldClick({state, actions}, {id}) {\n    const myActions = _.get(actions, 'view.Map');\n    const myState = _.get(state, 'view.Map');\n    const drawing = _.get(myState, `BoundaryDrawing.drawing`);\n    if (!drawing) {\n      myActions.styleField.unhighlight(myState.selectedField);\n      myState.selectedField = id;\n      myActions.styleField.highlight(id);\n      actions.view.FieldDetails.open();\n    }\n  },\n  onMapClick({actions}, props) {\n    const myActions = _.get(actions, 'view.Map');\n    myActions.unselectField()\n    //Pass click to boundary drawing\n    myActions.BoundaryDrawing.onMapClick(props)\n  },\n  async zoomBounds({state}, props) {\n    const myState = _.get(state, 'view.Map');\n    const fields = _.map(myState.fields, (f) => {\n      return {geo: f.boundary}\n    });\n    const featureCollection = GeoJSON.parse(fields, {GeoJSON: 'geo'})\n    const bounds = BBox(featureCollection)\n    myState.bounds = [[bounds[1], bounds[0]], [bounds[3], bounds[2]]];\n  }\n}\n","import _state from './state'\nimport _actions from './actions'\n\nexport const state = _state;\nexport const actions = _actions;\n","export default {\n  boundary: {},\n  drawing: false\n}\n","import _ from 'lodash';\nimport {pipe, debounce, mutate} from 'overmind';\nimport uuid from 'uuid/v1';\n\nexport default {\n  addPointToBoundary({state}, props) {\n    const myState = state.view.Map.BoundaryDrawing;\n    _.set(myState, `boundary.${uuid()}`, [props.lat, props.lng]);\n  },\n  updateBoundaryPoint: pipe(debounce(10), mutate(({state}, props) => {\n    const myState = state.view.Map.BoundaryDrawing;\n    _.set(myState, `boundary.${props.id}`, [props.latlng.lat, props.latlng.lng]);\n  })),\n  onMapClick({state, actions}, {lat, lng}) {\n    const myState = state.view.Map.BoundaryDrawing;\n    const myActions = actions.view.Map.BoundaryDrawing;\n    if (myState.drawing) {\n      myActions.addPointToBoundary({lat, lng});\n    }\n  },\n  onMarkerMove({actions}, props) {\n    const myActions = actions.view.Map.BoundaryDrawing;\n    myActions.updateBoundaryPoint(props);\n  },\n  onStartDrawing({state}, props) {\n    const myState = state.view.Map.BoundaryDrawing;\n    myState.boundary = (props || {}).boundary || {};\n    myState.drawing = true;\n  },\n  onStopDrawing({state}, props) {\n    const myState = state.view.Map.BoundaryDrawing;\n    myState.drawing = false;\n    myState.boundary = {};\n  }\n}\n","import _state from './state'\nimport _actions from './actions'\nimport * as BoundaryDrawing from './BoundaryDrawing'\n\nexport const state = {\n  BoundaryDrawing: BoundaryDrawing.state,\n  ..._state\n};\nexport const actions = {\n  BoundaryDrawing: BoundaryDrawing.actions,\n  ..._actions\n}\n","import config from '../../../config'\nexport default {\n  OADADomain: {\n    open: false,\n    domain: config.oadaDomain\n  }\n}\n","import _ from 'lodash';\nimport uuid from 'uuid/v1'\nimport tree from \"../../app/OADAManager/tree\";\n\nexport default {\n  OADADomain: {\n    open({state}) {\n      const myState = state.view.Modals.OADADomain;\n      myState.open = true;\n    },\n    close({state}) {\n      const myState = state.view.Modals.OADADomain;\n      myState.open = false;\n    },\n    onConnectClick({actions}) {\n      const myActions = actions.view.Modals.OADADomain;\n      myActions.open();\n    },\n    onDomainChange({state}, {domain}) {\n      const myState = state.view.Modals.OADADomain;\n      myState.domain = domain;\n    },\n    async onConnect({actions, state}) {\n      const myState = state.view.Modals.OADADomain;\n      const myActions = actions.view.Modals.OADADomain;\n      const {domain} = myState;\n      myState.loading = true;\n      await actions.app.OADAManager.onDomainChanged({domain});\n      myState.loading = false;\n      myActions.close()\n    },\n    onCancel({actions}) {\n      const myActions = actions.view.Modals.OADADomain;\n      myActions.close();\n    }\n  }\n}\n","import _ from 'lodash';\nimport uuid from 'uuid/v1'\nimport tree from \"../../../app/OADAManager/tree\";\n\n\nfunction convertToGEOJSON(points) {\n  var boundary = {\n    type: \"Polygon\",\n    \"coordinates\": [_.map(points, (p) => {return [p[1], p[0]]})] //Flip lat/lng and add array around\n  }\n  return boundary;\n}\nfunction getChanges({state, actions}, {fieldId, newBoundary, farmId, farm_id, seasonFarm_id}) {\n  const myState = state.view.Modals.SaveField;\n  //See if name or boundary has changed\n  let seasonField = actions.app.getSeasonField(fieldId);\n  let newName = myState.name;\n  var seasonFieldChanges = {};\n  var fieldChanges = {};\n  //Get changes the effect both\n  if (newName != seasonField.name) seasonFieldChanges.name = newName;\n  if (_.isEqual(newBoundary, seasonField.boundary) == false) seasonFieldChanges.boundary = newBoundary;\n\n  fieldChanges = _.cloneDeep(seasonFieldChanges)\n  //See if farm has changed\n  if (seasonFarm_id) {\n    //Connected to oada\n    if (!seasonField.farm || seasonField.farm._id != seasonFarm_id) {\n      seasonFieldChanges.farm = {_id: seasonFarm_id};\n      //TODO this isn't right, we shouldn't be adding a farm in the function that calls this if it isn't our current year\n      fieldChanges.farm = {_id: farm_id};\n    }\n  } else {\n    //Local\n    if (!seasonField.farm || seasonField.farm.id != farmId) {\n      seasonFieldChanges.farm = {id: farmId};\n      fieldChanges.farm = {id: farmId};\n    }\n  }\n  //TODO only change field if is current year\n  return {fieldChanges, seasonFieldChanges};\n}\nfunction saveChangesToLocalData({state}, editingFieldId, fieldChanges, seasonFieldChanges) {\n  if (_.isEmpty(fieldChanges) && _.isEmpty(seasonFieldChanges)) return;\n  const fieldPath = `app.localData.abc123.fields.fields.${editingFieldId}`; //TODO organization\n  _.set(state, fieldPath, _.merge({}, _.get(state, fieldPath), fieldChanges));\n  const seasonFieldPath = `app.localData.abc123.seasons.2019.fields.${editingFieldId}` //TODO year, organization\n  _.set(state, seasonFieldPath, _.merge({}, _.get(state, seasonFieldPath), seasonFieldChanges));\n}\nasync function saveChangesToOADA(context, editingFieldId, fieldChanges, seasonFieldChanges) {\n  const { state, actions } = context;\n  if (_.isEmpty(fieldChanges) && _.isEmpty(seasonFieldChanges)) return;\n  //Add to OADA\n  let requests = [];\n  if (_.isEmpty(fieldChanges) == false) {\n    requests.push({\n      tree,\n      data: fieldChanges,\n      path: `/bookmarks/fields/fields/${editingFieldId}`\n    })\n  }\n  if (_.isEmpty(seasonFieldChanges) == false) {\n    requests.push({\n      tree,\n      data: seasonFieldChanges,\n      path: `/bookmarks/seasons/2019/fields/${editingFieldId}` //TODO year\n    })\n  }\n  console.log('fieldChanges', fieldChanges);\n  console.log('seasonFieldChanges', seasonFieldChanges);\n  const connection_id = _.get(state, `app.OADAManager.currentConnection`)\n  await actions.app.oada.put({requests, connection_id})\n}\n\nfunction createField(context, {boundary, farmId, farm_id}) {\n  const { state } = context;\n  const myState = state.view.Modals.SaveField;\n  var field = {\n    name: myState.name,\n    boundary: boundary,\n    farm: (farm_id) ?\n      {\n        _id: farm_id //OADA farm resource id\n      }\n      :\n      {\n        id: farmId\n      }\n  }\n  return field\n}\nfunction addFieldToLocalData(context, {field}) {\n  const { state } = context;\n  const id = uuid();\n  _.set(state, `app.localData.abc123.fields.fields.${id}`, field); //TODO organization\n  _.set(state, `app.localData.abc123.seasons.2019.fields.${id}`, {...field, operations: {}, year: '2019'}); //TODO year, organization\n  return id;\n}\nasync function addFieldToOADA(context, {field, seasonField}) {\n  const { state, actions } = context;\n  const id = uuid();\n  //Add to OADA\n  let requests = [];\n  if (field) {\n    requests.push({\n      tree,\n      data: field,\n      path: `/bookmarks/fields/fields/${id}`\n    })\n  }\n  if (seasonField) {\n    requests.push({\n      tree,\n      data: {...seasonField, operations: {}, year: '2019'}, //TODO year\n      path: `/bookmarks/seasons/2019/fields/${id}` //TODO year\n    })\n  }\n  let connection_id = _.get(state, `app.OADAManager.currentConnection`)\n  await actions.app.oada.put({requests, connection_id})\n}\n\nexport default {\n  open({state, actions}) {\n    const myState = state.view.Modals.SaveField;\n    const editingField = _.get(state, `view.Map.editingField`);\n    if (editingField == null) {\n      myState.name = \"\";\n    } else {\n      let field = actions.app.getSeasonField(editingField);\n      //Populate the name in the modal popup\n      myState.name = field.name;\n      if (state.app.OADAManager.connected) {\n        //Get season farm id by oada id\n        const farmId = _.get(state, `app.oadaSeasonFarmsIdBy_id.${_.get(field, 'farm._id')}.id`)\n        myState.farmId = farmId;\n      } else {\n        myState.farmId = _.get(field, 'farm.id');\n      }\n    }\n    myState.open = true;\n  },\n  close({state}) {\n    const myState = state.view.Modals.SaveField;\n    myState.open = false;\n  },\n  async saveField(context) {\n    const {state} = context;\n    const myState = state.view.Modals.SaveField;\n    //Convert the field to geojson\n    const points = _.get(state, `view.Map.BoundaryDrawing.boundary`)\n    const boundary = convertToGEOJSON(points);\n\n    //Create farm or get existing farms id (cannot update an existing farm here)\n    let farmId = myState.farmId;\n    let farm_id = null;\n    let seasonFarm_id = null;\n    let farm = myState.farm;\n    if (farm) {\n      if (state.app.OADAManager.connected) {\n        //Get farm_id\n        farm_id = _.get(state, `app.oadaOrgData.fields.farms.${farmId}._id`)\n        //Get seasonFarm_id from farmId\n        seasonFarm_id = _.get(state, `app.seasonFarms.${farmId}._id`)\n      }\n    }\n    //Update or create field\n    let editingFieldId = _.get(state, `view.Map.editingField`);\n    if (editingFieldId) {\n      //We are editing a field find the changes, if any\n      const {fieldChanges, seasonFieldChanges} = getChanges(context, {fieldId: editingFieldId, newBoundary: boundary, farmId, farm_id, seasonFarm_id})\n      if (state.app.OADAManager.connected) {\n        saveChangesToOADA(context, editingFieldId, fieldChanges, seasonFieldChanges)\n      } else {\n        saveChangesToLocalData(context, editingFieldId, fieldChanges, seasonFieldChanges)\n      }\n    } else {\n      //TODO only add field if is current year, otherwise just seasonfield\n      if (state.app.OADAManager.connected) {\n        const field = await createField(context, {boundary, farm_id});\n        const seasonField = await createField(context, {boundary, farm_id: seasonFarm_id});\n        await addFieldToOADA(context, {field, seasonField})\n      } else {\n        const field = await createField(context, {boundary, farm, farmId: farmId})\n        await addFieldToLocalData(context, {field})\n      }\n    }\n  },\n  onSave({actions, state}) {\n    const myActions = actions.view.Modals.SaveField;\n    myActions.saveField();\n    actions.view.Map.BoundaryDrawing.onStopDrawing();\n    state.view.Map.editingField = null;\n    myActions.close();\n  },\n  onCancel({actions, state}) {\n    const myActions = actions.view.Modals.SaveField;\n    actions.view.Map.BoundaryDrawing.onStopDrawing();\n    state.view.Map.editingField = null;\n    myActions.close();\n  },\n  onNameChange({state}, {name}) {\n    const myState = state.view.Modals.SaveField;\n    myState.name = name;\n  },\n  onFarmSearchChange({state}, value) {\n    const myState = state.view.Modals.SaveField;\n    myState.farmSearch = value;\n  },\n  onFarmChange({state}, {id}) {\n    const myState = state.view.Modals.SaveField;\n    myState.farmId = id;\n  },\n  onFarmAdd({actions}) {\n    actions.view.Modals.NewFarm.open({callbackAction: 'view.Modals.SaveField.onFarmAddComplete'});\n  },\n  onFarmAddComplete({state}, {id}) {\n    const myState = state.view.Modals.SaveField;\n    //Update farmId\n    myState.farmId = id;\n  }\n}\n","import _state from './state'\nimport _actions from './actions'\n\nexport const state = _state;\nexport const actions = _actions;\n","import _ from 'lodash';\nexport default {\n  open: false,\n  name: '',\n  farmSearch: '',\n  farms: ({farmSearch: search}, state) => {\n    return _.compact(_.map(state.app.seasonFarms, (f, id) => {\n      if (!f || search != '' && f.name && f.name.toLowerCase().search(search.toLowerCase()) == -1) return null;\n      return {key: id, text: f.name, value: id};\n    }))\n  },\n  farmId: null,\n  farm: ({farmId, farms}, state) => {\n    if (farmId) {\n      return _.get(state, `app.seasonFarms.${farmId}`)\n    }\n  }\n}\n","import _ from 'lodash';\nimport uuid from 'uuid/v1'\nimport tree from \"../../../app/OADAManager/tree\";\n\nfunction createOperation(context, {name}) {\n  var operation = {\n    name,\n    fields: {}\n  }\n  return operation;\n}\n\nfunction addOperationToLocalData({state}, {operation}) {\n  const id = uuid();\n  _.set(state, `app.localData.abc123.seasons.2019.operations.${id}`, operation); //TODO year, organization\n  return id;\n}\nasync function addOperationToOADA({state, actions}, {operation}) {\n  //Add to OADA\n  const id = uuid();\n  let requests = [\n    {\n      tree,\n      data: operation,\n      path: `/bookmarks/seasons/2019/operations/${id}` //TODO year\n    }\n  ];\n  const connection_id = _.get(state, `app.OADAManager.currentConnection`)\n  const ret = await actions.app.oada.put({requests, connection_id})\n  const _id = _.get(ret, 'responses.0.headers.content-location').substr(1); //Remove leading `/` from /resources/<uuid>\n  return {id, _id}\n}\n\nexport default {\n  open({state}) {\n    const myState = state.view.Modals.NewOperation;\n    myState.name = '';\n    myState.open = true;\n  },\n  close({state}) {\n    const myState = state.view.Modals.NewOperation;\n    myState.open = false;\n  },\n  async saveOperation(context) {\n    const {state} = context;\n    const myState = state.view.Modals.NewOperation;\n    const operation = createOperation(context, {name: myState.name})\n    if (state.app.OADAManager.connected) {\n      const {id, _id} = await addOperationToOADA(context, {operation});\n      _.set(state, `view.TopBar.OperationDropdown.selected`, id)\n    } else {\n      const id = await addOperationToLocalData(context, {operation});\n      _.set(state, `view.TopBar.OperationDropdown.selected`, id)\n    }\n  },\n  onNameChange({state}, {name}) {\n    const myState = state.view.Modals.NewOperation;\n    myState.name = name;\n  },\n  onCancel({actions}) {\n    const myActions = actions.view.Modals.NewOperation;\n    myActions.close();\n  },\n  async onSave({actions}) {\n    const myActions = actions.view.Modals.NewOperation;\n    await myActions.saveOperation();\n    myActions.close();\n  }\n}\n","import _state from './state'\nimport _actions from './actions'\n\nexport const state = _state;\nexport const actions = _actions;\n","export default {\n  open: false,\n  name: ''\n}\n","import _ from 'lodash';\nimport uuid from 'uuid/v1'\nimport tree from \"../../../app/OADAManager/tree\";\n\nfunction createFarm(context, {name}) {\n  var farm = {\n    name\n  }\n  return farm;\n}\nfunction addFarmToLocalData(context, {farm}) {\n  const { state } = context;\n  const id = uuid();\n  _.set(state, `app.localData.abc123.farms.${id}`, farm); //TODO organization\n  _.set(state, `app.localData.abc123.seasons.2019.farms.${id}`, farm); //TODO year, organization\n  return id;\n}\nasync function addFarmToOADA(context, {farm}) {\n  const { state, actions } = context;\n  const id = uuid();\n  //TODO only add to season farms depending on what year is selected, need to figure out return values for that as well (since may only have one request)\n  //Add to OADA\n  let requests = [\n    {\n      tree,\n      data: farm,\n      path: `/bookmarks/fields/farms/${id}`\n    },\n    {\n      tree,\n      data: farm,\n      path: `/bookmarks/seasons/2019/farms/${id}` //TODO year\n    },\n  ];\n  let connection_id = _.get(state, `app.OADAManager.currentConnection`)\n  const ret = await actions.app.oada.put({requests, connection_id})\n  const farm_id = _.get(ret, 'responses.0.headers.content-location').substr(1); //Remove leading `/` from /resources/<uuid>\n  if (farm_id == null) throw 'OADA did not return an _id when creating a farm.'\n  const seasonFarm_id = _.get(ret, 'responses.1.headers.content-location').substr(1); //Remove leading `/` from /resources/<uuid>\n  if (seasonFarm_id == null) throw 'OADA did not return an _id when creating a season farm.'\n  return {farm_id, seasonFarm_id, id};\n}\nexport default {\n  open({state}, {callbackAction}) {\n    const myState = state.view.Modals.NewFarm;\n    myState.name = '';\n    myState.open = true;\n    myState.callbackAction = callbackAction || null;\n  },\n  close({state}) {\n    const myState = state.view.Modals.NewFarm;\n    myState.open = false;\n  },\n  async saveFarm(context) {\n    const {state, actions} = context;\n    const myState = state.view.Modals.NewFarm;\n    const farm = createFarm(context, {name: myState.name})\n    if (state.app.OADAManager.connected) {\n      const {farm_id, seasonFarm_id, id} = await addFarmToOADA(context, {farm});\n      if (myState.callbackAction) {\n        const action = _.get(actions, myState.callbackAction);\n        if (!action) throw `callbackAction: ${myState.callbackAction} does not exist.`\n        action({farm_id, seasonFarm_id, id});\n      }\n    } else {\n      const id = await addFarmToLocalData(context, {farm});\n      if (myState.callbackAction) {\n        const action = _.get(actions, myState.callbackAction);\n        if (!action) throw `callbackAction: ${myState.callbackAction} does not exist.`\n        action({id});\n      }\n    }\n  },\n  onNameChange({state}, {name}) {\n    const myState = state.view.Modals.NewFarm;\n    myState.name = name;\n  },\n  onCancel({actions}) {\n    const myActions = actions.view.Modals.NewFarm;\n    myActions.close();\n  },\n  async onSave({actions}) {\n    const myActions = actions.view.Modals.NewFarm;\n    await myActions.saveFarm();\n    myActions.close();\n  }\n}\n","import _state from './state'\nimport _actions from './actions'\n\nexport const state = _state;\nexport const actions = _actions;\n","export default {\n  open: false,\n  name: ''\n}\n","import _state from './state'\nimport _actions from './actions'\nimport * as SaveField from './SaveField'\nimport * as NewOperation from './NewOperation'\nimport * as NewFarm from './NewFarm'\n\nexport const state = {\n  SaveField: SaveField.state,\n  NewOperation: NewOperation.state,\n  NewFarm: NewFarm.state,\n  ..._state\n};\nexport const actions = {\n  SaveField: SaveField.actions,\n  NewOperation: NewOperation.actions,\n  NewFarm: NewFarm.actions,\n  ..._actions\n}\n","import _ from 'lodash'\nimport uuid from 'uuid/v1'\n\nexport default {\n  onAddField({actions}) {\n    actions.view.Map.BoundaryDrawing.onStartDrawing();\n  },\n  onSaveField({actions}) {\n    actions.view.Modals.SaveField.open();\n  },\n  onCancelField({state, actions}) {\n    state.view.Map.editingField = null; //Stop editing if we were\n    actions.view.Map.BoundaryDrawing.onStopDrawing();\n  },\n  onEditField({actions, state}) {\n    const currentField = state.view.FieldDetails.field;\n    //Hide the current boundary\n    state.view.Map.editingField = state.view.FieldDetails.fieldId;\n    //Convert to drawing boundary: {<rand-id>: [lat, lng], ...}\n    let boundary = {};\n    _.forEach(_.get(currentField, 'boundary.coordinates.0') || [], (coors) => { //TODO will not work with holes in fields etc\n      boundary[uuid()] = [coors[1], coors[0]];\n    });\n    //Start drawing\n    actions.view.Map.BoundaryDrawing.onStartDrawing({boundary});\n    //Close the details drawer\n    actions.view.Map.unselectField()\n  },\n  async onResetCache({actions}) {\n    await actions.app.oada.resetCache();\n    //Refresh the page\n    //location.reload();\n  },\n  async onLogout({actions}) {\n    await actions.view.Login.logout()\n  }\n}\n","import _state from './state'\nimport _actions from './actions'\n\nexport const state = _state;\nexport const actions = _actions;\n","import _ from 'lodash';\n\nexport default {\n  open: false,\n  selected: null,\n  search: '',\n  list: ({selected, operations}, state) => {\n    //Get operations, filtering by search\n    const search = _.get(state, `view.TopBar.OperationDropdown.search`)\n    return _.omitBy(_.mapValues(operations, ({name}, id) => {\n      if (id == null) return null; //Not an operation, a _key for oada\n      if (search != '' && name.search(search) == -1) return null;\n      return {\n        text: name,\n        value: id,\n        selected: (selected == id),\n        label: { color: 'green', empty: true, circular: true }\n      }\n    }), _.isEmpty)\n  },\n  operations: ({}, state) => {\n    let operations = null;\n    if (_.get(state, `app.OADAManager.connected`) == true) {\n      let currentConnection = _.get(state, `app.OADAManager.currentConnection`)\n      operations = _.omitBy(_.get(state, `app.oada.${currentConnection}.bookmarks.seasons.2019.operations`) || {}, (o, k) => {return _.startsWith(k, '_')}); //TODO year\n    } else {\n      operations = _.get(state, `app.localData.abc123.seasons.2019.operations`) //TODO year, organization\n    }\n    return operations\n  },\n  selectedOperationId: ({selected, operations}, state) => {\n    let selectedId = selected;\n    if (selectedId == null && _.keys(operations).length > 0) selectedId = _.keys(operations)[0];\n    return selectedId;\n  },\n  selectedOperation: ({selectedOperationId, operations}, state) => {\n    return operations[selectedOperationId];\n  }\n}\n","export default {\n  onAdd({state, actions}) {\n    const myState = state.view.TopBar.OperationDropdown;\n    myState.open = false;\n    return actions.view.Modals.NewOperation.open()\n  },\n  onChange({state}, {id}) {\n    const myState = state.view.TopBar.OperationDropdown;\n    myState.selected = id;\n    myState.open = false;\n  },\n  onOpenChange({state}, {open}) {\n    const myState = state.view.TopBar.OperationDropdown;\n    myState.open = open;\n  },\n  onSearch({state}, {search}) {\n    const myState = state.view.TopBar.OperationDropdown;\n    myState.search = search;\n  }\n}\n","import _state from './state'\nimport _actions from './actions'\nimport * as OperationDropdown from './OperationDropdown'\n\nexport const state = {\n  OperationDropdown: OperationDropdown.state,\n  ..._state\n};\nexport const actions = {\n  OperationDropdown: OperationDropdown.actions,\n  ..._actions\n}\n","export default {\n\n}\n","import _state from './state'\nimport _actions from './actions'\n\nimport * as Login from './Login'\nimport * as FieldDetails from './FieldDetails'\nimport * as FieldList from './FieldList'\nimport * as Map from './Map'\nimport * as Modals from './Modals'\nimport * as TopBar from './TopBar'\n\nexport const state = {\n  Login: Login.state,\n  FieldDetails: FieldDetails.state,\n  FieldList: FieldList.state,\n  Map: Map.state,\n  Modals: Modals.state,\n  TopBar: TopBar.state,\n  ..._state\n};\nexport const actions = {\n  Login: Login.actions,\n  FieldDetails: FieldDetails.actions,\n  FieldList: FieldList.actions,\n  Map: Map.actions,\n  Modals: Modals.actions,\n  TopBar: TopBar.actions,\n  ..._actions\n}\nexport const onInitialize = async ({actions}) => {\n  await actions.app.onInitialize();\n  await actions.view.Login.onInitialize();\n}\n","import _ from 'lodash';\n\nexport default {\n  \n}\n","import _ from 'lodash'\nexport default {\n\n}\n","export default {\n  \"42f60b10-784c-11ea-8dfd-a3e960f56105\": {\n    \"name\": \"1004 G-N\",\n    \"boundary\": {\n      \"type\": \"Polygon\",\n      \"coordinates\": [\n        [\n          [\n            -84.97584700584412,\n            41.4628134964027\n          ],\n          [\n            -84.97539639472963,\n            41.462765256171906\n          ],\n          [\n            -84.97495651245119,\n            41.46275721612994\n          ],\n          [\n            -84.97424840927125,\n            41.46250797433487\n          ],\n          [\n            -84.97405529022217,\n            41.46203360827181\n          ],\n          [\n            -84.97410893440247,\n            41.46044164256161\n          ],\n          [\n            -84.97139453887941,\n            41.46130195211675\n          ],\n          [\n            -84.96770381927492,\n            41.46327177680542\n          ],\n          [\n            -84.97010707855226,\n            41.46330393671208\n          ],\n          [\n            -84.9764907360077,\n            41.46306273702346\n          ],\n          [\n            -84.97634053230287,\n            41.45965368547904\n          ],\n          [\n            -84.97462391853334,\n            41.46024867436535\n          ],\n          [\n            -84.9746346473694,\n            41.461004463187685\n          ],\n          [\n            -84.97491359710695,\n            41.46126175098986\n          ],\n          [\n            -84.97492432594301,\n            41.46172004235903\n          ],\n          [\n            -84.97529983520509,\n            41.46208988917259\n          ],\n          [\n            -84.97581481933594,\n            41.46234717266838\n          ],\n          [\n            -84.9761688709259,\n            41.46278133625282\n          ]\n        ]\n      ]\n    },\n    \"farm\": {\n      \"id\": \"42f08cd0-784c-11ea-8dfd-a3e960f56105\"\n    }\n  },\n  \"7c0ce950-784c-11ea-bfa5-97fea4f9bfd9\": {\n    \"name\": \"1001 HO-N\",\n    \"boundary\": {\n      \"type\": \"Polygon\",\n      \"coordinates\": [\n        [\n          [\n            -84.97347593307495,\n            41.44864540647965\n          ],\n          [\n            -84.97626543045044,\n            41.44856498851091\n          ],\n          [\n            -84.97617959976196,\n            41.44784122230691\n          ],\n          [\n            -84.977445602417,\n            41.44782513852177\n          ],\n          [\n            -84.97759580612183,\n            41.44862932289387\n          ],\n          [\n            -84.97886180877687,\n            41.448532821295515\n          ],\n          [\n            -84.97866868972778,\n            41.44205080201176\n          ],\n          [\n            -84.97654438018799,\n            41.442887227983185\n          ],\n          [\n            -84.97549295425415,\n            41.44425443952937\n          ],\n          [\n            -84.97323989868165,\n            41.44608806625952\n          ],\n          [\n            -84.97272491455078,\n            41.44689227216232\n          ],\n          [\n            -84.97330427169801,\n            41.44726220353039\n          ]\n        ]\n      ]\n    },\n    \"farm\": {\n      \"id\": \"42f08cd0-784c-11ea-8dfd-a3e960f56105\",\n    }\n  },\n  \"8ab27420-784c-11ea-bfa5-97fea4f9bfd9\": {\n    \"name\": \"1002 HO-S\",\n    \"boundary\": {\n      \"type\": \"Polygon\",\n      \"coordinates\": [\n        [\n          [\n            -84.97152328491212,\n            41.44697269220437\n          ],\n          [\n            -84.97148036956789,\n            41.44166475561947\n          ],\n          [\n            -84.97152328491212,\n            41.44111785263252\n          ],\n          [\n            -84.97347593307495,\n            41.441085681725035\n          ],\n          [\n            -84.97373342514038,\n            41.44073180069027\n          ],\n          [\n            -84.97635126113893,\n            41.44053877385792\n          ],\n          [\n            -84.97645854949953,\n            41.44134304853828\n          ],\n          [\n            -84.97607231140138,\n            41.44161649965898\n          ],\n          [\n            -84.97611522674562,\n            41.44240467585386\n          ],\n          [\n            -84.97540712356569,\n            41.44398099952468\n          ]\n        ]\n      ]\n    },\n    \"farm\": {\n      \"id\": \"42f08cd0-784c-11ea-8dfd-a3e960f56105\"\n    }\n  }\n}\n","export default {\n  \"42f08cd0-784c-11ea-8dfd-a3e960f56105\": {\n    name: \"Bowman and Bowman\"\n  },\n  \"52f08cd0-784c-11ea-8dfd-a3e960f56105\": {\n    name: \"Martz Farms\"\n  }\n}\n","import testFields from './test/testFields';\nimport testFarms from './test/testFarms';\nimport _ from 'lodash';\nimport geojsonArea from '@mapbox/geojson-area';\n\nexport default {\n  acresStatus: ({}, state) => {\n    //Get id's of all fields in this operation\n    const operationFields = state.app.operationFields;\n    const seasonFields = state.app.seasonFields;\n    //Loop through each field, totaling acres.\n    let planned = 0;\n    let started = 0;\n    let done = 0;\n    _.forEach(operationFields, (fieldOperation, key) => {\n      if (fieldOperation == null) return;\n      //Get field\n      let field = seasonFields[key];\n      if (field == null) return;\n      //Compute area of field boundary\n      let area = geojsonArea.geometry(field.boundary) * 0.000247105 //Meters to acres;\n      if (fieldOperation.status == 'planned') {\n        planned += area;\n      } else if (fieldOperation.status == 'started') {\n        started += area;\n      } else if (fieldOperation.status == 'done') {\n        done += area;\n      }\n    });\n    let total = planned + started + done;\n    return {\n      planned: Math.round(planned),\n      plannedPercentage: Math.round((planned / (total || 1)) * 100),\n      started: Math.round(started),\n      startedPercentage: Math.round((started / (total || 1)) * 100),\n      done: Math.round(done),\n      donePercentage: Math.round((done / (total || 1)) * 100),\n    };\n  },\n  seasonFarms: ({}, state) => {\n    let farms;\n    if (_.get(state, `app.OADAManager.connected`) == true) {\n      let currentConnection = _.get(state, `app.OADAManager.currentConnection`)\n      farms = _.chain(state).get(`app.oada.${currentConnection}.bookmarks.seasons.2019.farms`).omitBy((v, k) => { //TODO year\n        if (_.startsWith(k, '_')) return true;\n        if (v == null) return true;\n      }).value();\n    } else {\n      farms = _.get(state, `app.localData.abc123.seasons.2019.farms`) //TODO year, organization\n    }\n    return farms || {};\n  },\n  seasonFields: ({}, state) => {\n    let fields;\n    if (_.get(state, `app.OADAManager.connected`) == true) {\n      let currentConnection = _.get(state, `app.OADAManager.currentConnection`)\n      fields = _.chain(state).get(`app.oada.${currentConnection}.bookmarks.seasons.2019.fields`).omitBy((v, k) => { //TODO year\n        if (_.startsWith(k, '_')) return true;\n        if (v == null) return true;\n      }).value();\n    } else {\n      fields = _.get(state, `app.localData.abc123.seasons.2019.fields`) //TODO year, organization\n    }\n    return fields || {};\n  },\n  operationFields: ({}, state) => {\n    let operationId = _.get(state, 'view.TopBar.OperationDropdown.selectedOperationId');\n    let operationFields = [];\n    if (operationId != null) {\n      if (_.get(state, `app.OADAManager.connected`) == true) {\n        let currentConnection = _.get(state, `app.OADAManager.currentConnection`)\n        operationFields = _.get(state, `app.oada.${currentConnection}.bookmarks.seasons.2019.operations.${operationId}.fields`) || []; //TODO year\n      } else {\n        operationFields = _.get(state, `app.localData.abc123.seasons.2019.operations.${operationId}.fields`) || []; //TODO year, organization\n      }\n    }\n    return operationFields; // {<field-id>: {status: 'planned'}, ...}\n  },\n  currentOADA: ({}, state) => {\n    if (state.app.OADAManager.connected) {\n      const currentConnection = state.app.OADAManager.currentConnection;\n      if (!currentConnection) return;\n      return state.app.oada[currentConnection];\n    }\n  },\n  oadaOrgData: ({currentOADA}) => {\n    if (currentOADA) {\n      return currentOADA.bookmarks;\n    }\n  },\n  oadaSeasonFarmsIdBy_id: ({oadaOrgData}, state) => {\n    return _.chain(oadaOrgData).get(`seasons.2019.farms`).mapValues((v, k) => {\n      if (!v) return null\n      return {_id: v._id, id: k};\n    }).omitBy(_.isNull).mapKeys((v, k) => {\n      return v._id; //Key of oada id\n    }).value();  //{_id: <oada-res-id>, id: <path-id>}\n  },\n  localOrgData: ({localData}) => {\n    return localData.abc123; //TODO organization\n  },\n  localData: {\n    organizations: {\n      'abc123': {\n        name: 'Default'\n      }\n    },\n    'abc123': {\n      fields: {\n        fields: {\n          /*'a': {\n            id: 'a',\n            name: 'Back 40',\n            boundary: '' //GEOJSON\n          }*/\n          ...testFields,\n        },\n        farms: {\n          ...testFarms,\n        }\n      },\n      seasons: {\n        /*'2019': {\n          fields: {\n            '<field-uuid>': {\n              season: 2018,\n              boundary: <geo-json>,\n              operations: {\n                '<operation-uuid>': {}\n              }\n            }\n          },\n          operations: {\n            '<operation-uuid>': {\n              id: '<operation-uuid>',\n              year: 2019,\n              name: 'Corn Planting',\n              fields: {\n                '<field-uuid>': {\n                  status: 'Planned',\n                }\n              }\n            }\n          }\n        }*/\n        '2019': {\n          fields: {\n            ...testFields,\n          },\n          farms: {\n            ...testFarms,\n          },\n          operations: {\n            /*'<operation-uuid>': {\n              id: '<operation-uuid>',\n              year: 2019,\n              name: 'Corn Planting',\n              fields: {\n                '<field-uuid>': {\n                  status: 'Planned',\n                }\n              }\n            }*/\n          }\n        }\n      }\n    }\n  }\n}\n","import _ from 'lodash'\nexport default {\n  getSeasonField({state}, id) {\n    let fields = [];\n    if (_.get(state, `app.OADAManager.connected`) == true) {\n      let currentConnection = _.get(state, `app.OADAManager.currentConnection`)\n      fields = _.get(state, `app.oada.${currentConnection}.bookmarks.seasons.2019.fields`) //TODO year\n    } else {\n      fields = _.get(state, `app.localData.abc123.seasons.2019.fields`) //TODO year, organization\n    }\n    return fields[id];\n  },\n  getSeasonFarm({state}, id) {\n    let farms = [];\n    if (_.get(state, `app.OADAManager.connected`) == true) {\n      let currentConnection = _.get(state, `app.OADAManager.currentConnection`)\n      farms = _.get(state, `app.oada.${currentConnection}.bookmarks.seasons.2019.farms`) //TODO year\n    } else {\n      farms = _.get(state, `app.localData.abc123.seasons.2019.farms`) //TODO year, organization\n    }\n    return farms[id];\n  },\n  onInitialize({state, actions}) {\n    actions.view.Map.zoomBounds();\n  }\n}\n","import _ from 'lodash';\nexport default {\n  connected: false,\n  currentConnection: null,\n  domain: null,\n  token: null,\n  user: ({currentConnection}, state) => {\n    if (!currentConnection) return null;\n    return _.get(state, 'app.oada.localhost.users.me');\n  }\n}\n","import tree from './tree';\nimport config from '../../../config'\nimport Promise from 'bluebird'\nimport _ from 'lodash'\nimport { browser as oadaIdClient } from '@oada/oada-id-client/index.js'\nconst getAccessToken = Promise.promisify(oadaIdClient.getAccessToken)\n\nexport default {\n  async getToken({state}, domain) {\n    /*\n      Get token from local storage or request one\n    */\n    const myState = state.app.OADAManager;\n    if (myState.token) return myState.token;\n    let res = await getAccessToken(domain.replace(/^https?:\\/\\//, ''), {\n      metadata: config.METADATA,\n      scope: config.SCOPE,\n      redirect: config.REDIRECT\n    })\n    return res.access_token;\n  },\n  async connect({actions, state, effects}, {domain, token}) {\n    const myState = state.app.OADAManager;\n    const myActions = actions.app.OADAManager;\n    if (token) myState.token = token;\n    token = await myActions.getToken(domain);\n    return actions.app.oada.connect({\n      token,\n      domain: domain,\n      options: config.OPTIONS,\n      cache: false\n    }).then((response) => {\n      if (!response.error) {\n        myState.currentConnection = response.connectionId;\n        myState.token = response.token;\n        myState.connected = true;\n        //Unselect local opeation\n        state.view.TopBar.OperationDropdown.selected = null;\n      }\n      return response;\n    })\n  },\n  async logout({actions, state}) {\n    const myState = state.app.OADAManager;\n    const {currentConnection: connection_id} = myState;\n    await actions.app.oada.disconnect({connection_id})\n  },\n  async getUserInfo({actions, state}) {\n    const myState = state.app.OADAManager;\n    const {currentConnection: connection_id} = myState;\n    let requests = [{\n      path: '/users/me',\n    }];\n    await actions.app.oada.get({requests, connection_id})\n  },\n  async fetchAndWatch({actions, state}) {\n    const myState = state.app.OADAManager;\n    const {currentConnection: connection_id} = myState;\n    //Fetch field and seasons\n    let watchRequests = [\n      {\n        path: '/bookmarks/fields',\n        tree,\n        watch: {\n          actions: [actions.app.OADAManager.onFieldChanged]\n        }\n      },\n      {\n        path: '/bookmarks/seasons',\n        tree,\n        watch: {\n          actions: [actions.app.OADAManager.onSeasonsChanged]\n        },\n      }\n    ];\n    const ret = await actions.app.oada.get({requests: watchRequests, connection_id})\n    let rewatchRequests = [];\n    if (ret.responses[0].error) {\n      //On 404 create and rewatch\n      if (ret.responses[0].status != 404) throw ret.responses[0].error;\n      //Create fields and try to watch again\n      let requests = [{\n        tree,\n        data: {\n          fields: {},\n          farms: {}\n        },\n        path: '/bookmarks/fields'\n      }];\n      //Create\n      await actions.app.oada.put({requests, connection_id})\n      //Rewatch\n      rewatchRequests.push(watchRequests[0]);\n    }\n    if (ret.responses[1].error) {\n      //On 404 create and rewatch\n      if (ret.responses[1].status != 404) throw ret.responses[0].error;\n      //Create seasons and try to watch again\n      let requests = [{\n        tree,\n        data: {},\n        path: '/bookmarks/seasons'\n      }];\n      //Create\n      await actions.app.oada.put({requests, connection_id})\n      //Rewatch\n      rewatchRequests.push(watchRequests[1]);\n    }\n    if (rewatchRequests.length > 0) await actions.app.oada.get({requests: rewatchRequests, connection_id})\n  },\n  initSeasonFields({state, actions}) {\n    /*\n      Put changes from master field list into season fields\n    */\n    const myActions = actions.app.OADAManager;\n    //Get master field list fields\n    var fieldsChanged = [];\n    _.forEach(_.get(state, 'app.oadaOrgData.fields.fields'), (obj, key) => {\n      if (_.startsWith(key, '_')) return;\n      fieldsChanged.push({fieldId: key, name: obj.name, boundary: obj.boundary});\n    })\n    return myActions.changeSeasonFields(fieldsChanged);\n  },\n  initSeasonFarms({state, actions}) {\n    /*\n      Put changes from master farm list into season farms\n    */\n    const myActions = actions.app.OADAManager;\n    //Get master field list fields\n    var changed = [];\n    _.forEach(_.get(state, 'app.oadaOrgData.fields.farms'), (obj, key) => {\n      if (_.startsWith(key, '_')) return;\n      changed.push({farmId: key, name: obj.name});\n    })\n    return myActions.changeSeasonFarms(changed);\n  },\n  async changeSeasonFields({state, actions}, fieldsChanged) {\n    /*\n      Apply any changes to season fields\n    */\n    const myState = state.app.OADAManager;\n    const {currentConnection: connection_id} = myState;\n    //See if they match season fields.\n    let requests = [];\n    let theSeasonFields = state.app.seasonFields;\n    _.forEach(fieldsChanged, (fieldChange) => {\n      let data = {};\n      let seasonField = theSeasonFields[fieldChange.fieldId]\n      if (fieldChange.name) {\n        if (seasonField == null || seasonField.name != fieldChange.name) {\n          data.name = fieldChange.name;\n        }\n      }\n      if (fieldChange.boundary) {\n        if (seasonField == null || _.isEqual(seasonField.boundary, fieldChange.boundary) == false) {\n          data.boundary = fieldChange.boundary;\n        }\n      }\n      if (_.isEmpty(data)) return;\n      data.id = fieldChange.fieldId;\n      requests.push(\n        { //Change season's field's name, boundary\n          tree,\n          data,\n          type: 'application/vnd.oada.field.1+json',\n          path: `/bookmarks/seasons/2019/fields/${fieldChange.fieldId}` //TODO year\n        }\n      )\n    })\n    if (requests.length == 0) return;\n    await actions.app.oada.put({requests, connection_id})\n  },\n  async changeSeasonFarms({state, actions}, changed) {\n    /*\n      Apply any changes to season farms\n    */\n    const myState = state.app.OADAManager;\n    const {currentConnection: connection_id} = myState;\n    //See if they match season fields.\n    let requests = [];\n    let seasonFarms = state.app.seasonFarms;\n    _.forEach(changed, (change) => {\n      let data = {};\n      let seasonFarm = seasonFarms[change.farmId]\n      //Check if name changed\n      if (change.name) {\n        if (seasonFarm == null || seasonFarm.name != change.name) {\n          data.name = change.name;\n        }\n      }\n      if (_.isEmpty(data)) return;\n      data.id = change.farmId;\n      requests.push(\n        { //Change season's farms's name\n          tree,\n          data,\n          type: 'application/vnd.oada.farm.1+json',\n          path: `/bookmarks/seasons/2019/farms/${data.id}` //TODO year\n        }\n      )\n    })\n    if (requests.length == 0) return;\n    await actions.app.oada.put({requests, connection_id})\n  },\n  async deleteSeasonFields({state, actions}, deleted) {\n    console.log('delete season fields', deleted);\n    const myState = state.app.OADAManager;\n    const {currentConnection: connection_id} = myState;\n    //See if they match season fields.\n    let requests = [];\n    let seasonFields = state.app.seasonFields;\n    _.forEach(deleted, (fieldId) => {\n      let seasonField = seasonFields[fieldId]\n      if (!seasonField) return;\n      requests.push(\n        { //Change season's farms's name\n          tree,\n          type: 'application/vnd.oada.field.1+json',\n          path: `/bookmarks/seasons/2019/fields/${fieldId}` //TODO year\n        }\n      )\n    })\n    if (requests.length == 0) return;\n    await actions.app.oada.delete({requests, connection_id})\n  },\n  async deleteSeasonFarms({state, actions}, deleted) {\n    console.log('delete season farms', deleted);\n    const myState = state.app.OADAManager;\n    const {currentConnection: connection_id} = myState;\n    //See if they match season fields.\n    let requests = [];\n    let seasonFarms = state.app.seasonFarms;\n    _.forEach(deleted, (farmId) => {\n      let seasonFarm = seasonFarms[farmId]\n      if (!seasonFarm) return;\n      requests.push(\n        { //Change season's farms's name\n          tree,\n          type: 'application/vnd.oada.farm.1+json',\n          path: `/bookmarks/seasons/2019/farms/${farmId}` //TODO year\n        }\n      )\n    })\n    if (requests.length == 0) return;\n    await actions.app.oada.delete({requests, connection_id})\n  },\n  async login({actions, state}, {domain, token}) {\n    const myState = state.app.OADAManager;\n    const myActions = actions.app.OADAManager;\n    myState.domain = domain;\n    const {error} = await myActions.connect({domain, token});\n    if (!error) {\n      await myActions.getUserInfo();\n      await myActions.fetchAndWatch();\n      await myActions.initSeasonFarms();\n      await myActions.initSeasonFields();\n      await actions.view.Map.zoomBounds();\n    }\n  },\n  async onFieldChanged({state, actions}, props) {\n    /*\n      If a farm/field in the master list changed, apply change to this years season fields\n    */\n    console.log('onFieldChanged', props);\n    const myActions = actions.app.OADAManager;\n    let changeType = _.get(props, 'response.change.type');\n    if (changeType == 'merge' || changeType == 'delete') {\n      let deleted = false;\n      const wasDelete = _.get(props, 'response.change.wasDelete');\n      if (changeType == 'deleted' || wasDelete) deleted = true;\n      let fieldsChanged = [];\n      let fieldsDeleted = [];\n      _.forEach(_.get(props, 'response.change.body.data.fields'), (obj, key) => {\n        if (key == 'undefined') {\n          console.log('WARNING: Received a bad field change from OADA', props);\n          return; //TODO temp fix for oada changes being wrong\n        }\n        if (deleted) {\n          fieldsDeleted.push(key);\n        } else {\n          fieldsChanged.push({fieldId: key, deleted, name: _.get(obj, 'name'), boundary: _.get(obj, 'boundary')});\n        }\n      })\n      if (fieldsDeleted.length > 0) myActions.deleteSeasonFields(fieldsDeleted);\n      if (fieldsChanged.length > 0) myActions.changeSeasonFields(fieldsChanged);\n      let farmsChanged = [];\n      let farmsDeleted = [];\n      _.forEach(_.get(props, 'response.change.body.data.farms'), (obj, key) => {\n        if (key == 'undefined') {\n          console.log('WARNING: Received a bad farm change from OADA', props);\n          return; //TODO temp fix for oada changes being wrong\n        }\n        if (deleted) {\n          farmsDeleted.push(key);\n        } else {\n          farmsChanged.push({farmId: key, deleted, name: _.get(obj, 'name')});\n        }\n      })\n      if (farmsDeleted.length > 0) myActions.deleteSeasonFarms(farmsDeleted);\n      if (farmsChanged.length > 0) myActions.changeSeasonFarms(farmsChanged);\n    } else {\n      console.warn(\"onFieldChanged: Unsupported change type:\", changeType)\n    }\n  },\n  onSeasonsChanged({state, actions}, props) {\n\n  }\n}\n","import _state from './state'\nimport _actions from './actions'\n\nexport const state = _state;\nexport const actions = _actions;\n","import _state from './state'\nimport _actions from './actions'\n\nimport * as OADAManager from './OADAManager'\nimport oadaCacheOvermind from '@oada/oada-cache-overmind'\n\nconst oada =  oadaCacheOvermind('app.oada')\n\nexport const state = {\n  oada: oada.state,\n  OADAManager: OADAManager.state,\n  ..._state\n};\nexport const actions = {\n  oada: oada.actions,\n  OADAManager: OADAManager.actions,\n  ..._actions\n}\nexport const effects = {\n  oada: oada.effects\n}\n","import { createHook } from \"overmind-react\"\n\nimport { namespaced } from 'overmind/config'\n\nimport * as view from './view'\nimport * as app from './app'\n\nexport const config = namespaced({\n  view,\n  app,\n})\n\nexport default createHook()\n","import React from 'react';\n\n/** @jsx jsx */\nimport { jsx, css } from '@emotion/core'\nimport _ from 'lodash'\nimport overmind from '../../overmind'\nimport { Input, Button, Form, Dropdown } from 'semantic-ui-react'\n\nfunction Login() {\n  const { state, actions } = overmind();\n  const myState = state.view.Login;\n  const myActions = actions.view.Login;\n\n  return (\n    <div css={css`\n      height: 100vh;\n      width: 100vw;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      background: url(imgs/login-background.jpg) no-repeat center center fixed;\n      background-size: cover;\n    `}>\n      <div css={css`\n        width: 400px;\n        display: flex;\n        flex-direction: column;\n        background: #fff;\n        padding: 15px;\n        padding-top: 7px;\n        border-radius: 5px;\n      `}>\n        <img css={{\n          height: 300\n        }} src={`imgs/logo2.svg`} alt={'logo'} />\n        <Form css={css`\n          display: flex;\n          flex-direction: column;\n        `} onSubmit={myActions.login}>\n          <Input placeholder='OADA Domain...' value={myState.domain} onChange={(evt, data) => myActions.domainChange(data)} />\n          <Button\n            style={{marginTop: 7}} primary\n            loading={myState.loading}\n            disabled={myState.loading}>\n            Connect to Your OADA Cloud\n          </Button>\n          <Button\n            style={{marginTop: 7}}\n            onClick={myActions.viewDemo}\n            disabled={myState.loading}>\n            View Demo\n          </Button>\n        </Form>\n      </div>\n      <a css={css`\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        font-size: 1.2em;\n        color: #FFFFFF;\n        cursor: pointer;\n      `} onClick={myActions.logout}\n      >Logout</a>\n    </div>\n  );\n}\n\nexport default Login;\n","/*\n  Adds points/polygons to map when drawing a boundary\n*/\nimport React, { Component } from 'react';\nimport { Marker, Polygon, LayerGroup } from 'react-leaflet'\n\nimport overmind from '../../../overmind'\nimport _ from 'lodash';\n\nexport default function BoundaryDrawing() {\n  const {state, actions} = overmind();\n  const myState = state.view.Map.BoundaryDrawing;\n  const myActions = actions.view.Map.BoundaryDrawing;\n\n  const { boundary, drawing } = myState;\n  const { onMarkerMove } = myActions;\n\n  if (!drawing) return null;\n  return (\n    <LayerGroup>\n      <Polygon positions={_.map(boundary)} />\n      {_.map(boundary, (latlng, id) => <Marker position={latlng} key={id} draggable onMove={({latlng, oldLatLng}) => onMarkerMove({latlng, oldLatLng, id})}/>)}\n    </LayerGroup>\n  );\n}\n","/*\n  Adds points/polygons to map when drawing a boundary\n*/\nimport React from 'react';\nimport { Marker, Polygon, LayerGroup, GeoJSON } from 'react-leaflet'\n\nimport overmind from '../../../overmind'\n\nimport _ from 'lodash';\nimport uuid from 'uuid/v1'\n\nexport default function Fields() {\n  const {state, actions} = overmind();\n  const myState = state.view.Map;\n  const myActions = actions.view.Map;\n\n  const { fields } = myState;\n  const { onFieldClick } = myActions;\n\n  if (_.keys(fields).length == 0) return null;\n  return (\n    <LayerGroup>\n      {_.map(fields, (field, id) =>\n        <GeoJSON\n          bubblingMouseEvents={false}\n          style={field.style}\n          data={field.boundary}\n          key={uuid()} //Must be uuid to unmount/mount when field style or boundary changes\n          onClick={(evt) => {onFieldClick({id})}} />\n      )}\n    </LayerGroup>\n  );\n}\n","import React from 'react';\nimport { Map as LeafletMap, Marker, Popup, TileLayer, ZoomControl } from 'react-leaflet'\nimport './index.css'\n\nimport overmind from '../../overmind'\nimport _ from 'lodash'\nimport BoundaryDrawing from './BoundaryDrawing'\nimport Fields from './Fields'\n\nexport default function Map() {\n  const { actions, state } = overmind();\n  const myActions = actions.view.Map;\n  const myState = state.view.Map;\n  return (\n      <LeafletMap bounds={myState.bounds} center={[41.448068, -84.972648]} zoom={13} onClick={(evt) => myActions.onMapClick({...evt.latlng})} zoomControl={false}>\n        <TileLayer\n          url=\"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}\"\n          attribution=\"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community\"\n        />\n        <BoundaryDrawing />\n        <Fields />\n      </LeafletMap>\n  );\n}\n","import React from 'react';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Button from '@material-ui/core/Button';\nimport {TextInput, View} from 'react-native'\n\nimport overmind from '../../../overmind'\n\nexport default function DrawingToolbar() {\n  const { actions } = overmind();\n  const myActions = actions.view.TopBar;\n  return (\n    <Toolbar>\n      <View style={{flex: 1}} />\n      <Button color=\"inherit\" onClick={() => myActions.onCancelField()}>Cancel</Button>\n      <Button color=\"inherit\" onClick={() => myActions.onSaveField()}>Save</Button>\n    </Toolbar>\n  );\n}\n","import React from 'react'\nimport { Dropdown, Input } from 'semantic-ui-react'\nimport {View, Text} from 'react-native'\nimport _ from 'lodash'\n/*const tagOptions = [\n  {\n    text: 'Important',\n    value: 'Important',\n    label: { color: 'red', empty: true, circular: true },\n  }\n]*/\n\nimport overmind from '../../../../overmind'\n\nexport default function OperationsDropdown({style}) {\n  const { actions, state } = overmind();\n  const myActions = actions.view.TopBar.OperationDropdown;\n  const myState = state.view.TopBar.OperationDropdown;\n\n  const selectedOperation = myState.selectedOperation;\n  const operations = myState.list;\n  const open = myState.open;\n  const search = myState.search;\n  const onAdd = myActions.onAdd;\n  const onChange = myActions.onChange;\n  const onOpenChange = myActions.onOpenChange;\n  const onSearch = myActions.onSearch;\n\n  return (\n    <View style={style}>\n      <View style={{flexDirection: 'row'}}>\n        {\n           selectedOperation ?\n            <Dropdown\n              open={open}\n              onOpen={() => {onOpenChange({open: true})}}\n              onBlur={() => {onOpenChange({open: false})}}\n              text={selectedOperation.name}\n              icon='cog'\n              floating\n              labeled\n              button\n              className='icon'\n            >\n              <Dropdown.Menu style={{top: 42}}>\n                <Dropdown.Item style={{textAlign: 'center'}} text='Add New Operation' value='Add New Operation' onClick={(evt, data)=>{onAdd()}} />\n                <Input icon='search' iconPosition='left' className='search' style={{marginTop: 3}} value={search} onChange={(evt)=>{onSearch({search: evt.target.value})}} />\n                <Dropdown.Menu scrolling>\n                  {_.map(operations, option => (\n                    <Dropdown.Item key={option.value} {...option} onClick={(evt, data)=>{onChange({id: data.value})}} />\n                  ))}\n                </Dropdown.Menu>\n              </Dropdown.Menu>\n            </Dropdown>\n          :\n            <Dropdown\n              onClick={() => {onAdd()}}\n              open={false}\n              text={'Add New Operation'}\n              icon='cog'\n              floating\n              labeled\n              button\n              className='icon' />\n        }\n        <View style={{flex: 1}} />\n      </View>\n    </View>\n  )\n}\n","import React from 'react';\nimport IconButton from '@material-ui/core/IconButton';\nimport MoreIcon from '@material-ui/icons/MoreHoriz';\nimport {View} from 'react-native'\nimport Menu from '@material-ui/core/Menu';\nimport MenuItem from '@material-ui/core/MenuItem';\n\nimport overmind from '../../../../overmind'\n\nexport default function MoreDropdown({style}) {\n  const { actions, state } = overmind();\n  const myActions = actions.view.TopBar;\n\n  const [anchorEl, setAnchorEl] = React.useState(null);\n  function handleClick(event) {\n    setAnchorEl(event.currentTarget);\n  }\n  function handleClose() {\n    setAnchorEl(null);\n  }\n  return (\n    <View style={style}>\n      <IconButton edge=\"end\" color=\"inherit\" aria-label=\"Menu\" onClick={handleClick}>\n        <MoreIcon  />\n      </IconButton>\n      <Menu\n        style={{top: 50, right: 5}}\n        open={Boolean(anchorEl)}\n        keepMounted\n        anchorEl={anchorEl}\n        onClose={handleClose}>\n          <MenuItem onClick={()=>{handleClose(); myActions.onAddField()}}>Add Field</MenuItem>\n          {\n            !state.view.FieldDetails.open ? null :\n            <MenuItem onClick={()=>{handleClose(); myActions.onEditField()}}>Edit Field</MenuItem>\n          }\n          <MenuItem onClick={()=>{handleClose(); myActions.onLogout()}}>Logout</MenuItem>\n          {/*<MenuItem onClick={()=>{handleClose(); myActions.onResetCache()}}>Reset Cache</MenuItem>*/}\n      </Menu>\n    </View>\n  );\n}\n","import React from 'react';\nimport Toolbar from '@material-ui/core/Toolbar';\nimport Button from '@material-ui/core/Button';\n\nimport IconButton from '@material-ui/core/IconButton';\nimport ListIcon from '@material-ui/icons/Menu';\n\nimport OperationDropdown from './OperationDropdown';\nimport MoreDropdown from './MoreDropdown';\n\nexport default function NormalToolbar({toggleTitle}) {\n  return (\n    <Toolbar>\n      {/*<IconButton edge=\"start\" style={{marginRight: 7}} color=\"inherit\" aria-label=\"Menu\" onClick={()=>{console.log('TODO Menu Pressed')}}>\n        <ListIcon />\n      </IconButton>*/}\n      <OperationDropdown style={{flex: 1}} />\n      {/*<Button color=\"inherit\">2019</Button>*/}\n      <MoreDropdown />\n    </Toolbar>\n  );\n}\n","import React, {Component} from 'react';\nimport AppBar from '@material-ui/core/AppBar';\nimport {View} from 'react-native'\n\nimport DrawingToolbar from './DrawingToolbar';\nimport NormalToolbar from './NormalToolbar';\n\nimport overmind from '../../overmind'\n\nexport default function TopBar() {\n  const {state} = overmind();\n  const drawing = state.view.Map.BoundaryDrawing.drawing;\n  return (\n    <View style={{zIndex: 1201}}>\n      <AppBar position=\"static\">\n        {\n          drawing ? <DrawingToolbar /> : <NormalToolbar />\n        }\n      </AppBar>\n    </View>\n  );\n}\n","import React from 'react';\nimport { makeStyles } from '@material-ui/core/styles';\nimport Drawer from '@material-ui/core/Drawer';\nimport Button from '@material-ui/core/Button';\nimport List from '@material-ui/core/List';\nimport Divider from '@material-ui/core/Divider';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport InboxIcon from '@material-ui/icons/MoveToInbox';\nimport MailIcon from '@material-ui/icons/Mail';\nimport { Text, View } from 'react-native';\n\nexport default function TemporaryDrawer() {\n  return (\n    <Drawer open={false} variant=\"persistent\">\n      <View style={{height: 64}} />\n      <div\n        style={{width: 250}}\n        role=\"presentation\">\n        <List>\n          {['Inbox', 'Starred', 'Send email'].map((text, index) => (\n            <ListItem button key={text}>\n              <ListItemIcon>{index % 2 === 0 ? <InboxIcon /> : <MailIcon />}</ListItemIcon>\n              <ListItemText primary={text} />\n            </ListItem>\n          ))}\n        </List>\n        <Divider />\n        <List>\n          {['All mail', 'Trash', 'Spam'].map((text, index) => (\n            <ListItem button key={text}>\n              <ListItemIcon>{index % 2 === 0 ? <InboxIcon /> : <MailIcon />}</ListItemIcon>\n              <ListItemText primary={text} />\n            </ListItem>\n          ))}\n        </List>\n      </div>\n    </Drawer>\n  );\n}\n","import React from 'react';\nimport Drawer from '@material-ui/core/Drawer';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormGroup from '@material-ui/core/FormGroup';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport FormControl from '@material-ui/core/FormControl';\nimport FormLabel from '@material-ui/core/FormLabel';\nimport {View, Text} from 'react-native';\nimport IconButton from '@material-ui/core/IconButton';\nimport EditIcon from '@material-ui/icons/Edit';\nimport _ from 'lodash';\nimport { Button } from 'semantic-ui-react'\n\n\nimport overmind from '../../overmind'\n\nexport default function FieldDetails() {\n  const {state, actions} = overmind();\n  const myState = state.view.FieldDetails;\n  const myActions = actions.view.FieldDetails;\n\n  let { open, field, farm, showAddOperationButton } = myState;\n  const { onStatusChange, onEditFieldClick, onAddNewOperationClick } = myActions;\n\n  if (!Boolean(field)) {\n    open = false;\n    field = {};\n  }\n  return (\n    <Drawer anchor=\"bottom\" open={open} variant=\"persistent\">\n      <View style={{paddingBottom: 20}}>\n        <View style={{flexDirection: 'column', alignItems: 'center'}}>\n          <View style={{justifyContent: 'left', flexDirection: 'row', alignItems: 'center', marginTop: 10}}>\n              <Text style={{fontWeight: 'bold', fontSize: 20}}>\n                {field.name}\n              </Text>\n              <Text style={{marginLeft: 7, fontSize: 18}}>\n                {`- ${Math.round(field.acres)} ac`}\n              </Text>\n          </View>\n          {\n            farm == null ? null :\n            <Text style={{fontSize: 15, color: '#999', marginTop: 2, marginBottom: 7}}>\n              {farm.name}\n            </Text>\n          }\n        </View>\n        <View style={{justifyContent: 'center', flexDirection: 'row'}}>\n          {\n            showAddOperationButton ?\n              <Button style={{marginTop: 15}} onClick={() => myActions.onAddNewOperationClick()}>Add New Operation</Button>\n            :\n            <FormControl component=\"fieldset\">\n              <FormGroup aria-label=\"position\" name=\"position\" row>\n                <FormControlLabel\n                  value=\"bottom\"\n                  control={<Checkbox color=\"primary\" checked={(field.status == \"planned\") || false} onChange={()=>{onStatusChange({status: 'planned'})}} />}\n                  label=\"Planned\"\n                  labelPlacement=\"bottom\"\n                />\n                <FormControlLabel\n                  value=\"bottom\"\n                  control={<Checkbox color=\"primary\" checked={(field.status == \"started\") || false} onChange={()=>{onStatusChange({status: 'started'})}} />}\n                  label=\"Started\"\n                  labelPlacement=\"bottom\"\n                />\n                <FormControlLabel\n                  value=\"bottom\"\n                  control={<Checkbox color=\"primary\" checked={(field.status == \"done\") || false} onChange={()=>{onStatusChange({status: 'done'})}} />}\n                  label=\"Done\"\n                  labelPlacement=\"bottom\"\n                />\n              </FormGroup>\n            </FormControl>\n          }\n        </View>\n      </View>\n    </Drawer>\n  );\n}\n","import React from 'react';\nimport { Text, View } from 'react-native';\n\nexport default function AcresPlanned({acresStatus}) {\n  return (\n    <View style={{backgroundColor: '#c50003', paddingLeft: 7, paddingRight: 7, paddingTop: 5, paddingBottom: 5, borderRadius: 5}}>\n      <Text style={{color: 'white', textShadowColor: '#000', textShadowOffset: {width: 1, height: 1}, textShadowRadius: 2}}>\n        {`${acresStatus.planned} ac (${acresStatus.plannedPercentage}%)`}\n      </Text>\n    </View>\n  );\n}\n","import React from 'react';\nimport { Text, View } from 'react-native';\n\nexport default function AcresStarted({acresStatus}) {\n  return (\n    <View style={{backgroundColor: '#eeb705', paddingLeft: 7, paddingRight: 7, paddingTop: 5, paddingBottom: 5, borderRadius: 5, marginRight: 7, marginLeft: 7}}>\n      <Text style={{color: 'white', textShadowColor: '#000', textShadowOffset: {width: 1, height: 1}, textShadowRadius: 2}}>\n        {`${acresStatus.started} ac (${acresStatus.startedPercentage}%)`}\n      </Text>\n    </View>\n  );\n}\n","import React from 'react';\nimport { Text, View } from 'react-native';\n\nexport default function AcresDone({acresStatus}) {\n  return (\n    <View style={{backgroundColor: '#5bb25f', paddingLeft: 7, paddingRight: 7, paddingTop: 5, paddingBottom: 5, borderRadius: 5}}>\n      <Text style={{color: 'white', textShadowColor: '#000', textShadowOffset: {width: 1, height: 1}, textShadowRadius: 2}}>\n        {`${acresStatus.done} ac (${acresStatus.donePercentage}%)`}\n      </Text>\n    </View>\n  );\n}\n","import React, { Component } from 'react';\nimport { Text, View } from 'react-native';\n\nimport AcresPlanned from './AcresPlanned'\nimport AcresStarted from './AcresStarted'\nimport AcresDone from './AcresDone'\n\nimport overmind from '../../overmind'\n\nexport default function AcresStatus() {\n  const {state} = overmind();\n  const acresStatus = state.app.acresStatus;\n  const selectedOperationId = state.view.TopBar.OperationDropdown.selectedOperationId;\n  if (!selectedOperationId) return null;\n  return (\n    //z-index of leaflet map is 400\n    <View style={{position: \"absolute\", display: \"flex\", flexDirection: 'row', justifyContent: \"center\", alignItems: \"center\", top: 68, zIndex: 401, width: '100vw'}}>\n      <AcresPlanned acresStatus={acresStatus} />\n      <AcresStarted acresStatus={acresStatus} />\n      <AcresDone acresStatus={acresStatus} />\n    </View>\n  );\n}\n","import React from 'react';\nimport {View, Text} from 'react-native'\nimport { Form, Button, Modal, Input, Dropdown, Icon } from 'semantic-ui-react'\n\nimport overmind from '../../overmind'\n\nexport default function SaveField() {\n  const {state, actions} = overmind();\n  const myState = state.view.Modals.SaveField;\n  const myActions = actions.view.Modals.SaveField;\n\n  const open = myState.open;\n  const name = myState.name;\n  const onNameChange = myActions.onNameChange;\n  const onCancel = myActions.onCancel;\n  const onSave = myActions.onSave;\n  const [farmOpen, setFarmOpen] = React.useState(false);\n\n  const farm = myState.farm || {};\n  const farmOptions = myState.farms;\n\n  return (\n    <Modal open={myState.open} size='tiny'>\n      <Modal.Header>\n        {(state.view.Map.editingField) ? 'Edit Field' : 'New Field'}\n      </Modal.Header>\n      <Modal.Content>\n        <View style={{flexDirection: 'column', zIndex: 1}}>\n          <Text style={{marginBottom: 7}}>Field Name:</Text>\n          <Form onSubmit={() => onSave()}>\n            <Input autoFocus placeholder='Back 40' value={name} onChange={(evt) => {onNameChange({name: evt.target.value})}} />\n          </Form>\n          <Text style={{marginBottom: 7, marginTop: 15}}>Farm:</Text>\n          <Dropdown\n            trigger={\n              <View style={{paddingLeft: 13, paddingRight: 7, border: '1px solid rgba(34,36,38,.15)', borderRadius: '.28571429rem', height: 38, flexDirection: 'row', alignItems: 'center', justifyContent: 'space-between'}}>\n                <Text style={{color: (farm.name ? 'rgba(0,0,0,.87)' : 'rgba(0,0,0,.25)')}}>\n                  {farm.name || 'Select a farm'}\n                </Text>\n                <Icon name='caret down' style={{paddingBottom: 17}}/>\n              </View>\n            }\n            icon={null}\n            onOpen={() => {setFarmOpen(true)}}\n            onBlur={() => {setFarmOpen(false)}}\n            open={farmOpen}>\n            <Dropdown.Menu style={{overflow: 'hidden', maxHeight: '50vh'}}>\n              <Dropdown.Item style={{textAlign: 'center'}} text='Add New Farm' value='Add New Farm' onClick={(evt, data)=>{myActions.onFarmAdd(); setFarmOpen(false);}} />\n              <Input icon='search' iconPosition='left' className='search' value={myState.farmSearch} onChange={(evt)=>{myActions.onFarmSearchChange(evt.target.value)}} />\n              <Dropdown.Menu scrolling>\n                {farmOptions.map((option) => (\n                  <Dropdown.Item key={option.value} {...option} onClick={() => {myActions.onFarmChange({id: option.value}); setFarmOpen(false);}} />\n                ))}\n              </Dropdown.Menu>\n            </Dropdown.Menu>\n          </Dropdown>\n        </View>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button negative onClick={() => onCancel()}>Cancel</Button>\n        <Button positive icon='checkmark' labelPosition='right' content='Save' onClick={() => onSave()} />\n      </Modal.Actions>\n    </Modal>\n  );\n}\n","import React from 'react';\nimport {View, Text} from 'react-native'\nimport { Button, Modal, Input } from 'semantic-ui-react'\n\nimport overmind from '../../overmind'\n\nexport default function OADADomain() {\n  const {state, actions} = overmind();\n  const myState = state.view.Modals.OADADomain;\n  const myActions = actions.view.Modals.OADADomain;\n\n  const { open, domain } = myState;\n  const { onDomainChange, onCancel, onConnect } = myActions;\n\n  return (\n    <Modal open={open} size='tiny'>\n      <Modal.Header>Connect to OADA Server</Modal.Header>\n      <Modal.Content>\n        <Text>Domain:</Text>\n        <View style={{flexDirection: 'row'}}>\n          <Input style={{flex: 1, marginTop: 7}} placeholder='https://oada.openatk.com' value={domain} onChange={(evt) => {onDomainChange({domain: evt.target.value})}} />\n        </View>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button negative onClick={() => onCancel()}>Cancel</Button>\n        <Button positive icon='checkmark' labelPosition='right' content='Connect' onClick={() => onConnect({})} />\n      </Modal.Actions>\n    </Modal>\n  );\n}\n","import React from 'react';\nimport {View, Text} from 'react-native'\nimport { Button, Modal, Input, Form } from 'semantic-ui-react'\n\nimport overmind from '../../overmind'\n\nexport default function NewOperation() {\n  const {state, actions} = overmind();\n  const myState = state.view.Modals.NewOperation;\n  const myActions = actions.view.Modals.NewOperation;\n\n  const { open, name } = myState;\n  const { onNameChange, onCancel, onSave } = myActions;\n\n  return (\n    <Modal open={open} size='tiny'>\n      <Modal.Header>New Operation</Modal.Header>\n      <Modal.Content>\n        <Text>Name:</Text>\n        <View style={{flexDirection: 'row'}}>\n          <Form style={{flex: 1}} onSubmit={onSave}>\n            <Input autoFocus style={{width: '100%', marginTop: 7}} placeholder='Corn Planting' value={name} onChange={(evt) => {onNameChange({name: evt.target.value})}} />\n          </Form>\n        </View>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button negative onClick={() => onCancel()}>Cancel</Button>\n        <Button positive icon='checkmark' labelPosition='right' content='Save' onClick={() => onSave()} />\n      </Modal.Actions>\n    </Modal>\n  );\n}\n","import React from 'react';\nimport {View, Text} from 'react-native'\nimport { Button, Modal, Input } from 'semantic-ui-react'\n\nimport overmind from '../../overmind'\n\nexport default function NewFarm() {\n  const {state, actions} = overmind();\n  const myState = state.view.Modals.NewFarm;\n  const myActions = actions.view.Modals.NewFarm;\n\n  const { open, name } = myState;\n  const { onNameChange, onCancel, onSave } = myActions;\n\n  return (\n    <Modal open={open} size='tiny'>\n      <Modal.Header>New Farm</Modal.Header>\n      <Modal.Content>\n        <Text>Name:</Text>\n        <View style={{flexDirection: 'row'}}>\n          <Input style={{flex: 1, marginTop: 7}} placeholder='Bowman Farms' value={name} onChange={(evt) => {onNameChange({name: evt.target.value})}} />\n        </View>\n      </Modal.Content>\n      <Modal.Actions>\n        <Button negative onClick={() => onCancel()}>Cancel</Button>\n        <Button positive icon='checkmark' labelPosition='right' content='Save' onClick={() => onSave()} />\n      </Modal.Actions>\n    </Modal>\n  );\n}\n","import React from 'react';\nimport logo from './logo.svg';\nimport './App.css';\n\nimport Login from './Login'\nimport Map from './Map'\nimport TopBar from './TopBar'\nimport FieldList from './FieldList'\nimport FieldDetails from './FieldDetails'\nimport AcresStatus from './AcresStatus'\n\nimport ModalSaveField from './Modals/SaveField';\nimport ModalOADADomain from './Modals/OADADomain';\nimport ModalNewOperation from './Modals/NewOperation';\nimport ModalNewFarm from './Modals/NewFarm';\n\nimport overmind from '../overmind'\n\nfunction App() {\n  const { state } = overmind();\n\n  if (!state.view.Login.loggedIn) {\n    return <Login />\n  }\n\n  return (\n    <div className=\"App\">\n\n      <TopBar />\n      <AcresStatus />\n      <Map />\n      <FieldList />\n      <FieldDetails />\n      <ModalSaveField />\n      <ModalOADADomain />\n      <ModalNewOperation />\n      <ModalNewFarm />\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport * as serviceWorker from './serviceWorker';\n\nimport './index.css';\n\nimport App from './view/App'\n\nimport { createOvermind } from \"overmind\";\nimport { Provider } from \"overmind-react\";\nimport { config } from './overmind'\n\nconst app = createOvermind(config,\n{\n  devtools: true,\n});\n\nReactDOM.render(\n  <Provider value={app}>\n    <App />\n  </Provider>,\n  document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = _default;\n\nvar _state = _interopRequireDefault(require(\"./state\"));\n\nvar _actions = _interopRequireDefault(require(\"./actions\"));\n\nvar _effects = _interopRequireDefault(require(\"./effects\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _default(namespace) {\n  return {\n    state: _state.default,\n    effects: _effects.default,\n    actions: (0, _actions.default)(namespace)\n  };\n}","module.exports = __webpack_public_path__ + \"static/media/logo.5d5d9eef.svg\";","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _default = {\n  connections: {}\n};\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = _default;\n\nvar _bluebird = _interopRequireDefault(require(\"bluebird\"));\n\nvar _url = _interopRequireDefault(require(\"url\"));\n\nvar _lodash = _interopRequireDefault(require(\"lodash\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nconsole.log('oada-cache-overmind: 1');\nvar namespace = null;\n\nfunction ns(context) {\n  return _lodash.default.mapValues(context, obj => {\n    if (namespace == null) return obj;\n    return _lodash.default.get(obj, namespace);\n  });\n}\n\nfunction domainToConnectionId(domainUrl) {\n  var domain = _url.default.parse(domainUrl).hostname;\n\n  return domain.replace(/\\./g, '_');\n}\n\nfunction _default(_namespace) {\n  namespace = _namespace;\n  return {\n    connect(context, props) {\n      var {\n        state,\n        effects\n      } = ns(context);\n      var connectionId = props.connection_id || domainToConnectionId(props.domain);\n      return effects.connect({\n        connection_id: connectionId,\n        domain: props.domain,\n        options: props.options,\n        cache: props.cache,\n        token: props.token,\n        websocket: props.websocket\n      }).then(response => {\n        if (state[connectionId] == null) state[connectionId] = {};\n        state[connectionId].token = response.token;\n        state[connectionId].domain = props.domain; //Clear bookmarks if exist\n\n        if (state[connectionId].bookmarks) state[connectionId].bookmarks = {};\n        state.isAuthenticated = true;\n        return {\n          token: response.token,\n          connectionId\n        };\n      }).catch(error => {\n        state.error = {\n          error: error.message\n        };\n        state.isAuthenticated = false;\n        return {\n          error\n        };\n      });\n    },\n\n    handleWatch(context, props) {\n      var {\n        state,\n        effects\n      } = ns(context);\n      var nullPath = null;\n\n      if (props.nullPath) {\n        nullPath = props.nullPath.split('/');\n        nullPath.shift();\n        nullPath.shift();\n        nullPath = nullPath.join('.');\n      }\n\n      if (props.response.change.type === 'merge') {\n        var currentState = _lodash.default.get(state, \"\".concat(props.connection_id, \".\").concat(props.path));\n\n        var _oldState = _lodash.default.cloneDeep(currentState);\n\n        _lodash.default.merge(currentState, props.response.change.body.data);\n\n        if (props.response.change.wasDelete && nullPath) {\n          var deletePath = \"\".concat(props.path, \".\").concat(nullPath);\n\n          _lodash.default.unset(state, \"\".concat(props.connection_id, \".\").concat(deletePath));\n        }\n\n        return {\n          oldState: _oldState\n        };\n      } else if (props.response.change.type === 'delete') {\n        var oldState = _lodash.default.cloneDeep(_lodash.default.get(state, \"\".concat(props.connection_id, \".\").concat(props.path)));\n\n        if (nullPath) {\n          var _deletePath = \"\".concat(props.path, \".\").concat(nullPath);\n\n          _lodash.default.unset(state, \"\".concat(props.connection_id, \".\").concat(_deletePath));\n        }\n\n        return {\n          oldState\n        };\n      } else {\n        console.warn('oada-cache-overmind - UNKNOWN CHANGE TYPE:', props);\n      }\n    },\n\n    get(context, props) {\n      var {\n        state,\n        effects,\n        actions\n      } = ns(context);\n      if (!props.requests) throw new Error('Missing requests. Please pass requests in as an array of request objects under the requests key');\n      var requests = props.requests || [];\n      var PromiseMap = props.concurrent ? _bluebird.default.map : _bluebird.default.mapSeries;\n      return PromiseMap(requests, (request, i) => {\n        if (request.complete) return;\n\n        var _statePath = request.path.replace(/^\\//, '').split('/').join('.');\n\n        if (request.watch) {\n          var conn = state[request.connection_id || props.connection_id];\n\n          if (conn) {\n            if (conn && conn.watches && conn.watches[request.path]) return;\n            request.watch.actions = [actions.handleWatch, ...request.watch.actions];\n            request.watch.payload = request.watch.payload || {};\n            request.watch.payload.connection_id = request.connection_id || props.connection_id;\n            request.watch.payload.path = _statePath;\n          }\n        }\n\n        return effects.get({\n          connection_id: request.connection_id || props.connection_id,\n          url: request.url,\n          path: request.path,\n          headers: request.headers,\n          watch: request.watch,\n          tree: request.tree || props.tree\n        }).then(response => {\n          var _responseData = response.data; //Build out path one object at a time.\n\n          var path = \"\".concat(request.connection_id || props.connection_id, \".\").concat(_statePath); //Set response\n\n          if (_responseData) _lodash.default.set(state, path, _responseData);\n\n          if (request.watch) {\n            path = \"\".concat(request.connection_id || props.connection_id, \".watches.\").concat(request.path);\n\n            _lodash.default.set(state, path, true);\n          }\n\n          requests[i].complete = true;\n          return response;\n        }).catch(error => {\n          return _objectSpread({\n            error\n          }, error.response);\n        });\n      }).then(responses => {\n        return {\n          responses,\n          requests\n        };\n      });\n    },\n\n    put(context, props) {\n      var {\n        state,\n        effects,\n        actions\n      } = ns(context);\n      if (!props.requests) throw new Error(\"Missing requests. Please pass requests in as an array of request objects under the requests key\");\n      var requests = props.requests || [];\n      var PromiseMap = props.concurrent ? _bluebird.default.map : _bluebird.default.mapSeries;\n      return PromiseMap(requests, (request, i) => {\n        if (request.complete) return;\n        return effects.put({\n          url: request.url,\n          //props.domain + ((request.path[0] === '/') ? '':'/') + request.path,\n          path: request.path,\n          data: request.data,\n          type: request.type,\n          headers: request.headers,\n          tree: request.tree || props.tree,\n          connection_id: request.connection_id || props.connection_id\n        }).then(response => {\n          var path = \"\".concat(request.connection_id || props.connection_id).concat(request.path.split(\"/\").join(\".\"));\n\n          var oldState = _lodash.default.cloneDeep(_lodash.default.get(state, path));\n\n          var newState = _lodash.default.merge(oldState, request.data);\n\n          _lodash.default.set(state, path, newState);\n\n          requests[i].complete = true;\n          return response;\n        });\n      }).then(responses => {\n        return {\n          responses,\n          requests\n        };\n      });\n    },\n\n    post(context, props) {\n      var {\n        state,\n        effects,\n        actions\n      } = ns(context);\n      if (!props.requests) throw new Error(\"Missing requests. Please pass requests in as an array of request objects under the requests key\");\n      var requests = props.requests || [];\n      var PromiseMap = props.concurrent ? _bluebird.default.map : _bluebird.default.mapSeries;\n      return PromiseMap(requests, (request, i) => {\n        if (request.complete) return;\n        return effects.post({\n          url: request.url,\n          //props.domain + ((request.path[0] === '/') ? '':'/') + request.path,\n          path: request.path,\n          data: request.data,\n          type: request.type,\n          headers: request.headers,\n          tree: request.tree || props.tree,\n          connection_id: request.connection_id || props.connection_id\n        }).then(response => {\n          var id = response.headers.location; //TODO why is this here?\n\n          var path = \"\".concat(request.connection_id || props.connection_id).concat(request.path.split(\"/\").join(\".\"));\n\n          var oldState = _lodash.default.cloneDeep(_lodash.default.get(state, path));\n\n          var newState = _lodash.default.merge(oldState, request.data);\n\n          _lodash.default.set(state, path, newState);\n\n          requests[i].complete = true;\n          return;\n        });\n      }).then(responses => {\n        return {\n          responses\n        };\n      });\n    },\n\n    delete(context, props) {\n      var {\n        state,\n        effects,\n        actions\n      } = ns(context);\n      if (!props.requests) throw new Error(\"Missing requests. Please pass requests in as an array of request objects under the requests key\");\n      var requests = props.requests || [];\n      var PromiseMap = props.concurrent ? _bluebird.default.map : _bluebird.default.mapSeries;\n      return PromiseMap(requests, (request, i) => {\n        if (request.complete) return;\n        var connectionId = request.connection_id || props.connection_id;\n\n        var _statePath = request.path.replace(/^\\//, \"\").split(\"/\").join(\".\");\n\n        var conn = _lodash.default.get(state, connectionId);\n\n        if (request.unwatch && conn && conn.watches) {\n          // Don't send the unwatch request if it isn't being watched already.\n          if (!conn.watches[request.path]) return;\n        }\n\n        return effects.delete({\n          connection_id: connectionId,\n          url: request.url,\n          path: request.path,\n          headers: request.headers,\n          unwatch: request.unwatch,\n          type: request.type,\n          tree: request.tree || props.tree\n        }).then(response => {\n          //Handle watches index and optimistically update\n          if (request.unwatch && conn && conn.watches) {\n            _lodash.default.unset(state, \"\".concat(connectionId, \".watches.\").concat(request.path));\n          } else {\n            _lodash.default.unset(state, \"\".concat(connectionId, \".\").concat(_statePath));\n          }\n\n          requests[i].complete = true;\n          return response;\n        });\n      }).then(responses => {\n        return {\n          responses,\n          requests\n        };\n      });\n    },\n\n    disconnect(context, props) {\n      var {\n        state,\n        effects\n      } = ns(context);\n      return effects.disconnect({\n        connection_id: props.connection_id\n      });\n    },\n\n    resetCache(context, props) {\n      //Currently oada-cache resets all of the cache, not just the db for a single connection_id\n      var {\n        effects,\n        state\n      } = ns(context); //Connect if not connected\n\n      return effects.resetCache({\n        connection_id: props.connection_id || domainToConnectionId(props.domain)\n      });\n    }\n\n  };\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _oadaCache = _interopRequireDefault(require(\"@oada/oada-cache\"));\n\nvar _uuid = _interopRequireDefault(require(\"uuid\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar connections = {};\n\nvar connect = function connect(args) {\n  if (!args.connection_id) throw 'connection_id not supplied';\n  if (args.connection_id && connections[args.connection_id]) return Promise.resolve(connections[args.connection_id]);\n  return _oadaCache.default.connect(args).then(conn => {\n    conn.cache = {};\n    connections[args.connection_id] = conn;\n    return conn;\n  });\n};\n\nvar get = function get(args) {\n  if (!args.connection_id) throw 'connection_id not supplied';\n\n  if (args.watch && args.watch.actions) {\n    var actions = args.watch.actions;\n\n    args.watch.func = payload => {\n      actions.forEach(action => {\n        action(payload);\n      });\n    };\n  }\n\n  return connections[args.connection_id].get(args);\n};\n\nvar put = function put(args) {\n  if (!args.connection_id) throw 'connection_id not supplied';\n  return connections[args.connection_id].put(args);\n};\n\nvar post = function post(args) {\n  if (!args.connection_id) throw 'connection_id not supplied';\n  return connections[args.connection_id].post(args);\n};\n\nvar _delete = function _delete(args) {\n  if (!args.connection_id) throw 'connection_id not supplied';\n  return connections[args.connection_id].delete(args);\n};\n\nvar disconnect = function _disconnect(args) {\n  if (!args.connection_id) throw 'connection_id not supplied';\n  var connection = connections[args.connection_id];\n  connections[args.connection_id] = undefined;\n  return connection.disconnect();\n};\n\nvar resetCache = function resetCache(args) {\n  //Currently oada-cache resets all of the cache, not just the db for a single connection_id\n  return connections[args.connection_id].resetCache(args);\n};\n\nvar _default = {\n  connect,\n  get,\n  put,\n  post,\n  delete: _delete,\n  resetCache,\n  disconnect\n};\nexports.default = _default;","const Promise = require(\"bluebird\");\nlet setupCache = require(\"./cache\");\nconst uuid = require(\"uuid\");\nconst _ = require(\"lodash\");\nconst urlLib = require(\"url\");\nconst pointer = require(\"json-pointer\");\nconst ws = require(\"./websocket\");\nconst axios = require(\"axios\");\nconst _TOKEN = require(\"./token\");\n\n// debug\nconst error = require(\"debug\")(\"oada-cache:index:error\");\nconst info = require(\"debug\")(\"oada-cache:index:info\");\n\nlet dbprefix = \"\";\nconst setDbPrefix = pfx => (dbprefix = pfx);\n\nprocess.on('unhandledRejection', (reason, p) => {\n  console.log('------Unhandled Rejection - Fix Me!-------');\n  console.log(reason);\n});\n\nvar connect = async function connect({\n  domain,\n  options,\n  cache,\n  token,\n  websocket,\n}) {\n  if (!domain) {\n    throw new Error(\"domain undefined\");\n  }\n  if (typeof domain !== \"string\") {\n    throw new Error(\"domain must be a string\");\n  }\n  if (!options && !token) {\n    throw new Error(\"options and token undefined\");\n  }\n  if (token && typeof token !== \"string\") {\n    throw new Error(\"token must be a string\");\n  }\n  if (\n    cache !== undefined &&\n    typeof cache !== \"boolean\" &&\n    typeof cache !== \"object\"\n  ) {\n    throw new Error(\n      `cache must be either a boolean or an object with 'name' and/or 'expires' keys`,\n    );\n  }\n  if (cache && cache.name && typeof cache.name !== \"string\") {\n    throw new Error(\"cache name must be a string\");\n  }\n  //  if (typeof cache !== \"undefined\" && typeof cache !== \"boolean\")\n  //throw \"cache must be boolean\";\n  if (typeof websocket !== \"undefined\" && typeof websocket !== \"boolean\") {\n    throw new Error(\"websocket must be boolean\");\n  }\n\n  var CACHE;\n  var REQUEST = axios;\n  var NOCACHEREQUEST = axios;\n  var SOCKET;\n  var TOKEN;\n  let _token = new _TOKEN({ domain, token, options, dbprefix });\n  if (!domain) {\n    throw new Error(\"domain undefined\");\n  }\n  var DOMAIN = domain;\n  var NAME =\n    cache && cache.name\n      ? cache.name\n      : urlLib.parse(domain).hostname.replace(/\\./g, \"_\");\n  var EXPIRES = cache && cache.expires ? cache.expires : undefined;\n\n  function _replaceLinks(obj) {\n    let ret = Array.isArray(obj) ? [] : {};\n    if (!obj) {\n      return obj;\n    } // no defined objriptors for this level\n    return Promise.map(Object.keys(obj || {}), key => {\n      if (key === \"*\") {\n        // Don't put *s into oada. Ignore them\n        return;\n      }\n      let val = obj[key];\n      if (typeof val !== \"object\" || !val) {\n        ret[key] = val; // keep it asntType: 'application/vnd.oada.harvest.1+json'\n        return;\n      }\n      if (val._type) {\n        // If it has a '_type' key, don't worry about it.\n        //It'll get created in future iterations of ensureTree\n        return;\n      }\n      if (val._id) {\n        // If it's an object, and has an '_id', make it a link from descriptor\n        ret[key] = { _id: val._id };\n        if (\"_rev\" in val) {\n          ret[key]._rev = val._rev;\n        }\n        return;\n      }\n      // otherwise, recurse into the object looking for more links\n      return _replaceLinks(val).then(result => {\n        ret[key] = result;\n        return;\n      });\n    }).then(() => {\n      return ret;\n    });\n  }\n\n  async function _makeResourceAndLink({ path, data, headers }, waitTime) {\n    data._id = _.clone(data._id) || \"resources/\" + uuid();\n\n    let linkReq = {\n      path,\n      type: data._type,\n      headers,\n      data: { _id: data._id },\n    };\n    // Create a versioned link if the tree specifies one.\n    if (\"_rev\" in data) {\n      linkReq.data._rev = 0;\n    }\n    // We don't want to attempt to set the rev when we put the resource\n\n    let resReq = {\n      path: \"/\" + data._id,\n      type: data._type,\n      data,\n    };\n    var link;\n    try {\n      link = await put(linkReq);\n    } catch (err) {\n      if (err.response && err.response.status === 412) {\n        var pathPieces = path.split(\"/\");\n        var parentPath = pathPieces.splice(0, pathPieces.length - 1).join(\"/\");\n        // Wait time increases: 1s, 2s, 4s, 8s, 16s. Throw after 16s.\n        if (waitTime > 16000) {\n          throw err;\n        }\n        //The parent has been modified; attempt to get the new _rev\n        var response;\n        try {\n          response = await NOCACHEREQUEST({\n            method: \"get\",\n            url: DOMAIN + parentPath,\n            headers: { Authorization: \"Bearer \" + TOKEN },\n          });\n        } catch (erro) {\n          waitTime = waitTime || 1000;\n          await Promise.delay(waitTime);\n          return _makeResourceAndLink({ path, data, headers }, waitTime * 2);\n        }\n        // If the key has already been created, set the resource path to the bookmarks path and let it map automatically, not a resource id\n        if (response.data[pathPieces[pathPieces.length - 1]]) {\n          resReq.data._id =\n            response.data[pathPieces[pathPieces.length - 1]]._id;\n          resReq.path = \"/\" + resReq.data._id;\n          // Concurrent put, delete, put (delete.test.js #15) can produce situations where _id is undefined\n          if (!resReq.data._id) {\n            waitTime = waitTime || 1000;\n            await Promise.delay(waitTime);\n            var newHeaders = _.cloneDeep(headers);\n            //TODO: use if-match headers???\n            newHeaders[\"if-match\"] = parseInt(response.headers[\"x-oada-rev\"]);\n            return _makeResourceAndLink(\n              { path, data, headers: newHeaders },\n              waitTime * 2,\n            );\n          }\n        } else {\n          // The key does not yet exist, adjust the if-match and try again.\n          waitTime = waitTime || 1000;\n          await Promise.delay(waitTime);\n          var newHeaders = _.cloneDeep(headers);\n          newHeaders[\"if-match\"] = parseInt(response.headers[\"x-oada-rev\"]);\n          return _makeResourceAndLink(\n            { path, data, headers: newHeaders },\n            waitTime * 2,\n          );\n        }\n      } else {\n        throw err;\n      }\n    }\n    // Delete the _rev  and _id keys. No need for them in the resource object. They will break things.\n    if (\"_rev\" in data) {\n      delete resReq.data._rev;\n    }\n    var resource = await put(resReq);\n    return { link, resource };\n  }\n\n  function _watch({ headers, path, callback, payload }) {\n    if (SOCKET) {\n      return SOCKET.watch(\n        {\n          path,\n          headers,\n        },\n        async function handleWatchResponse(response) {\n          if (payload && payload.tree) {\n            // Filter the change body based on the given tree\n            info(\"BODY BEFORE\", path, payload.tree);\n            info(_.cloneDeep(response.change.body));\n            response.change.body = await _recursiveFilterChange(\n              DOMAIN + path,\n              payload.tree,\n              response.change.body,\n            );\n            info(\"BODY AFTER\");\n            info(response.change.body);\n          }\n          var watchPayload = _.cloneDeep(payload) || {};\n          watchPayload.response = response;\n          watchPayload.request = {\n            url: DOMAIN + path,\n            headers,\n            method: response.change.type,\n          };\n\n          try {\n            if (CACHE) {\n              watchPayload = await CACHE.handleWatchChange(watchPayload);\n            }\n          } catch (err) {\n            error(err);\n            throw err;\n          }\n          if (callback) {\n            await callback(watchPayload);\n          }\n          return;\n        },\n      );\n    } else {\n      throw new Error(\"websocket is required to watch resource\");\n    }\n  }\n\n  // Construct the request object and catch any 401s (expired token)\n  async function _buildRequest({ method, url, path, headers, data, type }) {\n    if (!path && !url) {\n      throw new Error(\"Either path or url must be specified.\");\n    }\n    if (url) {\n      if (/^\\//.test(url)) {\n        url = domain + url;\n      } else if (url.indexOf(domain) !== 0) {\n        throw new Error(`'url' key must begin with the domain used to connect`);\n      }\n    }\n    method = method.toLowerCase();\n    let req = {\n      method,\n      url: url || DOMAIN + path,\n      headers: { authorization: \"Bearer \" + TOKEN },\n    };\n    if (/\\/$/.test(req.url)) {\n      req.url = req.url.slice(0, req.url.length - 1);\n    }\n\n    //handle headers\n    Object.keys(headers || {}).forEach(header => {\n      req.headers[header.toLowerCase()] = headers[header];\n    });\n\n    if (method === \"put\" || method === \"post\") {\n      req.headers[\"content-type\"] =\n        req.headers[\"content-type\"] || type || data._type;\n      req.data = data;\n    }\n\n    if (method === \"delete\") {\n      req.headers[\"content-type\"] = req.headers[\"content-type\"] || type;\n    }\n    req.requestStack = new Error().stack;\n    return req;\n  }\n\n  async function _sendRequest(req) {\n    try {\n      return REQUEST(req);\n    } catch (err) {\n      if (err && err.response.status === 401) {\n        //token has expired\n        await reconnect();\n        return REQUEST(req);\n      }\n      throw err;\n    }\n  }\n\n  async function _treeWalk(url, tree, data, obj, beforeCb, afterCb) {\n    var bef = beforeCb ? await beforeCb(url, tree, data, obj) : { data, obj };\n    data = bef.data;\n    obj = bef.obj;\n\n    info(\"mapping over data\", url);\n    return Promise.map(Object.keys(data || {}), async function(key) {\n      info(\"key is\", key);\n      info(typeof data[key], tree);\n      if (typeof data[key] === \"object\") {\n        var nextTree;\n        if (tree[key]) {\n          nextTree = tree[key];\n        } else if (tree[\"*\"]) {\n          nextTree = tree[\"*\"];\n\n          //Leave alone data for any keys that are not present in tree. Do not\n          //pursue these keys any further.\n        } else {\n          return;\n        }\n        info(\"next data\", data[key]);\n        var res = await _treeWalk(\n          url + \"/\" + key,\n          nextTree,\n          data[key],\n          obj,\n          beforeCb,\n          afterCb,\n        );\n        info(key, res);\n        data[key] = res.data;\n        obj = res.obj;\n      }\n      return;\n    }).then(async function() {\n      return afterCb ? await afterCb(url, tree, data, obj) : { data, obj };\n    });\n  }\n\n  // walk down the tree to\n  function _recursiveFilterChange(url, tree, data) {\n    //Filter at resource breaks\n    return Promise.map(Object.keys(data || {}), async function(key) {\n      if (data[key] && typeof data[key] === \"object\") {\n        if (tree[key]) {\n          var res = await _recursiveFilterChange(\n            url + \"/\" + key,\n            tree[key],\n            data[key],\n          );\n          return (data[key] = res.data);\n        } else if (tree[\"*\"]) {\n          var res = await _recursiveFilterChange(\n            url + \"/\" + key,\n            tree[\"*\"],\n            data[key],\n          );\n          return (data[key] = res.data);\n        } else if (data[key]._id) {\n          let rv = data[key]._rev ? data[key]._rev : false;\n          data[key] = { _id: data[key]._id };\n          if (rv) {\n            data[key]._rev = data[key]._rev;\n          }\n          return;\n        }\n      } else {\n        return;\n      }\n    }).then(() => {\n      return { data };\n    });\n  }\n\n  //TODO: patched up uncaughtrejection warning on _sendRequest with try/catch\n  //but need to reevaluate better code structuring\n  async function get({ url, path, headers, watch, tree }) {\n    let req = await _buildRequest({ method: \"get\", url, path, headers });\n    // If a tree is supplied, recursively GET data according to the data tree\n    // The tree must be rooted at /bookmarks.\n\n    let watchResponse;\n    // TODO: shouldn't request twice for normal tree get...\n    var response = await _sendRequest(req);\n\n    let subTree;\n    // Use the tree to construct the subTree to be potentially used in both the\n    // watch as well as the recursiveGet\n    if (tree) {\n      let pieces = urlLib\n        .parse(req.url)\n        .path.replace(/^\\//, \"\")\n        .split(\"/\");\n      let treePath = _convertSetupTreePath(pieces, tree);\n      info(tree, treePath);\n      if (!pointer.has(tree, treePath)) {\n        throw new Error(\"The path does not exist on the given tree.\");\n      }\n      subTree = pointer.get(tree, treePath);\n    }\n\n    // Watch a resource; if a tree is also supplied, attach this to the payload\n    // so that change notifications can be filtered through the tree\n    if (watch) {\n      path = path || urlLib.parse(url).path;\n      req.headers[\"x-oada-rev\"] = response.data._rev;\n\n      info(\"Setting watch. Sending rev:\", response.data._rev);\n      if (tree) {\n        if (!watch.payload) watch.payload = {};\n        watch.payload.tree = subTree;\n      }\n\n      // Deprecation warnings\n      if (watch.function || watch.func) {\n        error(\"Deprecation warning: use callback to pass a watch handler.\");\n      }\n\n      let callback = watch.callback || watch.function || watch.func;\n      if (!callback) {\n        // Just a warning message. It doesn't throw but print an error message.\n        error(\"Warning: no watch handler was provided.\");\n      }\n\n      watchResponse = await _watch({\n        headers: req.headers,\n        path,\n        callback,\n        payload: watch.payload\n      });\n      info(\"WATCH RESPONSE\", watchResponse);\n    }\n\n    // Perform recursive GET in response to the tree\n    if (tree) {\n      try {\n        if (watch && watchResponse.resource) {\n          var dataOut = await _recursiveGet(req.url, subTree, watchResponse.resource, true);\n          error(\"tree getting\", watch, watchResponse.resource);\n          var dataOut = await _recursiveGet(\n            req.url,\n            subTree,\n            watchResponse.resource,\n            true,\n          );\n        } else {\n          var dataOut = await _recursiveGet(req.url, subTree, response.data, true);\n        }\n        response.data = dataOut.data;\n        response.cached = dataOut.cached;\n      } catch (err) { // catch 404s because ... ?\n        if (err.response && err.response.status === 404) {\n          error(\"Received 404\");\n        } else throw err;\n      }\n    }\n    return response;\n  } //get\n\n  async function _recursiveGet(url, tree, data, cached) {\n    // Perform a GET if we have reached the next resource break.\n    if (tree._type) {\n      // its a resource\n      let response = await get({\n        url,\n        headers: \"_rev\" in data ? { \"x-oada-rev\": data._rev } : {},\n      });\n      data = response.data;\n      cached = response.cached ? response.cached && cached : false;\n    }\n\n    return Promise.map(Object.keys(data || {}), async function(key) {\n      if (typeof data[key] === \"object\") {\n        if (tree[key]) {\n          let res = await _recursiveGet(\n            url + \"/\" + key,\n            tree[key],\n            data[key],\n            cached,\n          );\n          cached = cached && res.cached;\n          return (data[key] = res.data);\n        } else if (tree[\"*\"]) {\n          let res = await _recursiveGet(\n            url + \"/\" + key,\n            tree[\"*\"],\n            data[key],\n            cached,\n          );\n          cached = cached && res.cached;\n          return (data[key] = res.data);\n        } else {\n          return;\n        } //data[key] is already stored in the data object\n      } else {\n        return;\n      }\n    }).then(() => {\n      return { data, cached };\n    });\n  }\n\n  // Identify the stored resources vs those that need to be setup.\n  function _findDeepestResources(pieces, tree, storedTree) {\n    let stored = 0;\n    let setup;\n    var _rev;\n    // Walk down the url in reverse order\n    return Promise.mapSeries(pieces, (piece, i) => {\n      let z = pieces.length - 1 - i; //use z to create paths in reverse order\n      let urlPath = \"/\" + pieces.slice(0, z + 1).join(\"/\");\n      let treePath = _convertSetupTreePath(pieces.slice(0, z + 1), tree);\n      // Check that its in the stored tree then look for deepest _resource_.\n      // If successful, break from the loop by throwing\n      if (pointer.has(tree, treePath + \"/_type\")) {\n        setup = setup || z;\n        if (pointer.has(storedTree, urlPath)) {\n          stored = _.clone(z);\n          throw new Error(\"stored\");\n        }\n        return get({\n          path: urlPath,\n        })\n          .then(response => {\n            //TODO: Detect whether the returned data matches the given tree\n            pointer.set(storedTree, urlPath, {});\n            stored = _.clone(z);\n            _rev = response.headers[\"x-oada-rev\"];\n            throw new Error(\"stored\");\n          })\n          .catch(err => {\n            if (/^stored/.test(err.message)) {\n              throw err;\n            }\n            return;\n          });\n      } else {\n        return;\n      }\n    })\n      .catch(err => {\n        // Throwing with a number error only should occur on success.\n        if (/^stored/.test(err.message)) {\n          return { stored, setup };\n        }\n      })\n      .then(() => {\n        return {\n          stored: stored,\n          setup: setup || 0,\n          _rev,\n        };\n      });\n  }\n\n  // Loop over the keys of the path and determine whether the object at that level\n  // contains a * key. The path must be updated along the way, replacing *s as\n  // necessary.\n  function _convertSetupTreePath(pathPieces, tree) {\n    let newPieces = _.clone(pathPieces);\n    newPieces = pathPieces.map((piece, i) => {\n      if (pointer.has(tree, \"/\" + newPieces.slice(0, i).join(\"/\") + \"/*\")) {\n        newPieces[i] = \"*\";\n        return \"*\";\n      } else {\n        return piece;\n      }\n    });\n    return \"/\" + newPieces.join(\"/\");\n  }\n\n  // Walk down the given path using the tree as a guide to create the necessary\n  // resource breaks along the way.\n  async function _ensureTree({ url, tree, data }) {\n    let path = urlLib.parse(url).path.replace(/^\\//, \"\");\n    let pieces = path.replace(/\\/$/, \"\").split(\"/\"); // replace trailing slashes\n    if (data._id) {\n      let firstPath = _convertSetupTreePath(pieces, tree);\n      pointer.set(tree, firstPath + \"/_id\", data._id);\n    }\n    //    if (pointer.has(tree, treePath)) pointer.set(tree, treePath, _.merge(pointer.get(tree, treePath),data))\n    let storedTree = {};\n    var responses = [];\n    // Find the deepest part of the path that exists. Once found, work back down.\n    var ret = await _findDeepestResources(pieces, tree, storedTree);\n    // Create all the resources on the way down. ret.stored is an index. Slice\n    // takes the length to slice, so no need to subtract 1.\n    var parentRev = ret._rev;\n    await Promise.mapSeries(\n      pieces.slice(0, pieces.length - ret.stored),\n      async function(piece, j) {\n        let i = ret.stored + 1 + j;\n        let urlPath = \"/\" + pieces.slice(0, i + 1).join(\"/\");\n        let treePath = _convertSetupTreePath(pieces.slice(0, i + 1), tree);\n        if (pointer.has(tree, treePath + \"/_type\") && i <= ret.setup) {\n          // its a resource\n          var content = await _replaceLinks(pointer.get(tree, treePath));\n          var resp = await _makeResourceAndLink({\n            path: urlPath,\n            data: _.cloneDeep(content),\n            headers: { \"if-match\": parentRev },\n          });\n          parentRev = resp.resource.headers[\"x-oada-rev\"];\n          pointer.set(storedTree, urlPath, content);\n          resp.path = urlPath;\n          responses.push(resp);\n        }\n      },\n    );\n    return responses;\n  }\n\n  function _configureCache({ name, req, expires }) {\n    let res = setupCache({ name, req, expires, dbprefix });\n    REQUEST = res.api;\n    CACHE = res;\n    return;\n  }\n\n  function post({ url, path, data, type, headers, tree }) {\n    url = url || DOMAIN + path;\n    url = url[url.length - 1] === \"/\" ? url + uuid() : url + \"/\" + uuid();\n    return put({\n      url,\n      data,\n      type,\n      headers,\n      tree,\n    });\n  }\n\n  async function _recursiveDelete(url, tree, data) {\n    // Perform a GET if we have reached the next resource break.\n    if (tree._type) {\n      // its a resource\n      try {\n        var got = await get({\n          url,\n        });\n        data = got.data;\n      } catch (err) {\n        if (err.status === 404) {\n          data = {};\n        //  return;\n        }\n      }\n    }\n    return Promise.map(Object.keys(data || {}), async function(key) {\n      if (typeof data[key] === \"object\") {\n        if (tree[key]) {\n          var res = await _recursiveDelete(\n            url + \"/\" + key,\n            tree[key],\n            data[key],\n          );\n          return (data[key] = res.data);\n        } else if (tree[\"*\"]) {\n          var res = await _recursiveDelete(\n            url + \"/\" + key,\n            tree[\"*\"],\n            data[key],\n          );\n          info('url', url)\n          info('recursiveDelete. returning', res.data)\n          return (data[key] = res.data);\n        } else {\n          return;\n        } //data[key] is already stored in the data object\n      } else {\n        return;\n      }\n    }).then(async function() {\n      var link;\n      if (tree._type) {\n        try {\n          // Delete the resource\n          if (data._id) {\n            try {\n              await del({\n                path: \"/\" + data._id,\n                headers: { \"content-type\": tree._type },\n              });\n            } catch (erro) {\n              error(\"aaaaaaaa\", \"/\" + data._id, url, erro);\n              throw erro;\n            }\n          }\n\n          // Delete the link\n          link = await del({\n            url,\n            headers: {\n              \"content-type\": tree._type,\n            },\n          });\n        } catch (err) {\n          if (err.response && err.response.status === 404) {\n            data = {};\n            return {\n              link: link || {},\n              data: data || {},\n            };\n          }\n          throw err;\n        }\n      } else {\n        // Delete the lookup for non resources\n        if (CACHE) {\n          await CACHE.removeLookup({ url });\n        }\n      }\n      // link and data can be undefined if the current object is\n      // not a resource (deletes won't need to happen)\n      return {\n        link: link || {},\n        data: data || {},\n      };\n    })\n  }\n\n  async function del({ url, path, type, headers, tree, unwatch }) {\n    let req = await _buildRequest({\n      method: \"delete\",\n      url,\n      path,\n      type,\n      headers,\n    });\n    if (unwatch) {\n      path = path || urlLib.parse(url).path;\n      return SOCKET.unwatch({\n        path,\n        headers: req.headers,\n      });\n    }\n    if (tree) {\n      var pieces = urlLib\n        .parse(req.url)\n        .path.replace(/^\\//, \"\")\n        .split(\"/\");\n      let treePath = _convertSetupTreePath(pieces, tree);\n      if (!pointer.has(tree, treePath)) {\n        throw new Error(\"The path does not exist on the given tree.\");\n      }\n      //return get({url: req.url})\n      var subTree = pointer.get(tree, treePath);\n      var result = await _recursiveDelete(req.url, subTree, {}, true);\n      return result.link;\n\n      //var treePath = _convertSetupTreePath(pieces, tree) + \"/_type\";\n      //if (!req.headers[\"content-type\"] && pointer.has(tree, treePath))\n      //  req.headers[\"content-type\"] = _.clone(pointer.get(tree, treePath));\n    }\n    if (!req.headers[\"content-type\"]) {\n      throw new Error(`content-type header must be specified.`);\n    }\n\n    return _sendRequest(req);\n  }\n\n  // Ensure all resources down to the deepest resource are created before\n  // performing a PUT.\n  async function put({ url, path, data, type, headers, tree }) {\n    let req = await _buildRequest({\n      method: \"put\",\n      url,\n      path,\n      data,\n      type,\n      headers,\n    });\n\n    // Ensure parent resources are created\n    if (tree) {\n      var responses = await _ensureTree({\n        url: req.url,\n        tree: _.cloneDeep(tree),\n        data,\n      });\n      var pieces =\n        responses.length > 0\n          ? responses[responses.length - 1].path.replace(/^\\//, \"\").split(\"/\")\n          : urlLib\n              .parse(req.url)\n              .path.replace(/^\\//, \"\")\n              .split(\"/\");\n\n      var treePath = _convertSetupTreePath(pieces, tree) + \"/_type\";\n      if (!req.headers[\"content-type\"] && pointer.has(tree, treePath)) {\n        req.headers[\"content-type\"] = _.clone(pointer.get(tree, treePath));\n      }\n    }\n\n    if (!req.headers[\"content-type\"]) {\n      throw new Error(`content-type header must be specified.`);\n      info('PUT - tree ensured. Executing PUT', req);\n    }\n    return _sendRequest(req).then(result => {\n      return result;\n    });\n  }\n\n  async function resetCache(name, expires) {\n    if (!CACHE) {\n      return;\n    }\n    await CACHE.resetCache();\n  }\n\n  async function disconnect() {\n    if (CACHE) {\n      await CACHE.db.close();\n    }\n    //if (CACHE) await CACHE.db.destroy();\n    if (SOCKET) {\n      SOCKET.close();\n    }\n    //if (_token.isSet()) {\n    _token.cleanUp();\n    //}\n  }\n\n  async function reconnect() {\n    // get a new token\n    TOKEN = await _token.renew();\n  }\n\n  // get a token\n  TOKEN = await _token.get();\n  if (!TOKEN) {\n    throw new Error(\"Unable to get token\");\n  }\n\n  // Setup websockets\n  if (websocket !== false) {\n    var socketApi = await ws(domain);\n    NOCACHEREQUEST = socketApi.http;\n    REQUEST = socketApi.http;\n    SOCKET = await socketApi;\n  }\n\n  //Setup the cache\n  if (cache !== false) {\n    await _configureCache({\n      name: NAME || uuid(),\n      req: REQUEST,\n      expires: EXPIRES,\n    });\n  }\n\n  function _getMemoryCache() {\n    if (CACHE) {\n      return CACHE._getMemoryCache();\n    } else {\n      return {};\n    }\n  }\n\n  return {\n    token: TOKEN,\n    cache: CACHE ? CACHE : false,\n    websocket: SOCKET ? SOCKET : false,\n    get,\n    put,\n    post,\n    delete: del,\n    resetCache,\n    disconnect,\n    reconnect,\n    _getMemoryCache,\n  };\n};\n\nmodule.exports = {\n  connect,\n  setDbPrefix,\n};\n","\"use strict\";\nconst cq = require(\"concurrent-queue\");\nconst Promise = require(\"bluebird\");\nlet PouchDB = require(\"pouchdb\");\nif (PouchDB.default) PouchDB = PouchDB.default;\nconst url = require(\"url\");\nconst _ = require(\"lodash\");\nconst pointer = require(\"json-pointer\");\nconst OFFLINE = false;\nconst REVLIMIT = 10;\nvar memoryCache = {};\nconst timeThreshold = 30000;\nconst cleanMemoryTimer = 10000;\nconst dbPutDelay = 5000; // 5 sec\nPromise.config({ cancellation: true });\n//PouchDB.setMaxListeners(30);\n\n// debug\nconst error = require(\"debug\")(\"oada-cache:cache:error\");\nconst info = require(\"debug\")(\"oada-cache:cache:info\");\n\nmodule.exports = function setupCache({ name, req, expires, dbprefix }) {\n  dbprefix = dbprefix || \"\";\n  name = dbprefix + name;\n  // name should be made unique across domains and users\n  var db = db || new PouchDB(name);\n  // This fixes concurrent accesses\n  PouchDB.on(\"destroyed\", async function(dbName) {\n    if (dbName === name) {\n      db = new PouchDB(name);\n    }\n  });\n  var request = req;\n  var expiration = expires || 1000 * 60 * 60 * 24 * 2; //(ms/s)*(s/min)*(min/hr)*(hr/days)*days\n\n  // Clean in-memory cache periodically\n  setInterval(cleanMemoryCache, cleanMemoryTimer);\n\n  function cleanMemoryCache() {\n    const now = Date.now();\n    var oldest = { key: undefined, time: now };\n    var deleteCount = 0;\n    Object.keys(memoryCache).forEach(key => {\n      if (\n        !memoryCache[key].putPending &&\n        now - memoryCache[key].access < timeThreshold\n      ) {\n        if (memoryCache[key].access < oldest) {\n          oldest = { key, time: memoryCache[key].access };\n        }\n        delete memoryCache[key];\n        info(\"Deleted expired resource from the in-memory cache\", key);\n        deleteCount++;\n      }\n    });\n\n    if (deleteCount === 0 && oldest.key) {\n      delete memoryCache[oldest.key];\n    }\n  }\n\n  /** Save resource to in-memory cache and schedule PUT */\n  function handleMemoryCache(resourceId, data, waitTime, req) {\n    const now = Date.now();\n    if (resourceId in memoryCache) {\n      // resource exists in in-cache memory\n      // update data and access time\n      memoryCache[resourceId].data = data;\n      memoryCache[resourceId].access = now;\n      memoryCache[resourceId].valid = true;\n    } else {\n      // resource does not exist\n      // add new resource\n      memoryCache[resourceId] = {\n        data,\n        access: now,\n        promise: undefined,\n        putPending: false,\n        valid: true,\n      };\n    }\n\n    // Schedule db.put\n    if (!memoryCache[resourceId].putPending) {\n      // set flag\n      memoryCache[resourceId].putPending = true;\n      // Schedule put\n      memoryCache[resourceId].promise = Promise.delay(dbPutDelay)\n        .then(async function() {\n          if (!(resourceId in memoryCache)) {\n            throw new Error(\"Resource does not exist in the in-memory cache.\");\n          }\n          await doPut(resourceId, waitTime, req);\n          memoryCache[resourceId].putPending = false;\n        })\n        .catch(function(err) {\n          error(\"handleMemoryCacheError\", err);\n          memoryCache[resourceId].putPending = false;\n          throw err;\n        });\n    }\n    return Promise.resolve();\n  }\n\n  /**  Get resource from in-memory cache and do put to Pouch DB */\n  function doPut(resourceId, waitTime, req) {\n    if (!memoryCache[resourceId].data.doc) return\n    return db\n      .put(memoryCache[resourceId].data)\n      .then(response => {\n        memoryCache[resourceId].data._rev = response.rev;\n        delete memoryCache[resourceId].promise;\n      })\n      .catch(err => {\n        error(\"Error doPut\", memoryCache[resourceId].data._rev, err);\n        // TODO: Handle this error\n        // retry 409s\n        // if (err.status === 409) {\n        //   waitTime = waitTime || 1000;\n        //   return Promise.delay(waitTime).then(() => {\n        //     if (waitTime > 16000) throw err;\n        //     return dbUpsert(req, waitTime * 2);\n        //   });\n        // }\n        //throw err;\n      });\n  }\n\n  /** Get the resource and merge data if its already in the db. */\n\n  /**\n   * Store (upsert) resource to local DB\n   * @param req request\n   * @param waitTime wait time\n   */\n  async function dbUpsert(req, waitTime) {\n    var urlObj = url.parse(req.url);\n    var pieces = urlObj.path.split(\"/\");\n    var resourceId = pieces.slice(1, 3).join(\"/\"); //returns resources/abc\n    var pathLeftover =\n      pieces.length > 3 ? \"/\" + pieces.slice(3, pieces.length).join(\"/\") : \"\";\n\n    // Create the content to put in the cache\n    var dbPut = {\n      _id: resourceId,\n      valid: req.valid === undefined ? true : req.valid,\n      // TODO: This current resets this access date for e.g., every put\n      // while offline. This doesn't seem right. I think this should only\n      // get updated when we know we're upserting a new value from the server\n      accessed: Date.now(),\n      doc: {},\n    };\n\n    // ALL updates to existing docs (upserts) need to supply the current _rev.\n    let memoryResult = memoryCache[resourceId]; // Try to get resource from in-memory cache\n    let result = { doc: {} };\n\n    if (!memoryResult || !memoryResult.valid) {\n      // resource does not exist in memory; get from DB\n      try {\n        result = await db.get(resourceId);\n      } catch (e) {\n        // Else, the resource was not in the cache. This was the first put.\n        if (req.method && req.method.toLowerCase() === \"delete\") {\n          // Deleting a resource that doesn't exist: do nothing.\n          return;\n        } else if (pathLeftover) {\n          dbPut.INCOMPLETE_RESOURCE = true;\n        }\n      }\n    } else {\n      result = memoryResult.data;\n      // If in memory, result._rev might be undefined (409 errors)\n      if (result._rev !== undefined) {\n        dbPut._rev = result._rev;\n      }\n    }\n\n    // Now handle the upsert\n    if (req.method && req.method.toLowerCase() === \"delete\") {\n      if (!pathLeftover) {\n        if (memoryCache[resourceId] && memoryCache[resourceId].promise) {\n          memoryCache[resourceId].promise.cancel();\n        }\n        delete memoryCache[resourceId];\n        return db\n          .remove(result)\n          .then(response => {\n            return { response };\n          })\n          .catch(err => {\n            //its okay if it already doesn't exist\n            if (err.status === 404) {\n              return;\n            }\n            throw err;\n          });\n      } else {\n        if (pointer.has(result.doc, pathLeftover)) {\n          dbPut.doc = result.doc;\n          pointer.remove(dbPut.doc, pathLeftover);\n        }\n      }\n    } else {\n      //handle \"merge\" type operations\n      if (pathLeftover) {\n        var curData = pointer.has(result.doc, pathLeftover)\n          ? pointer.get(result.doc, pathLeftover)\n          : {};\n        var newData = _.merge(curData, req.data || {});\n        pointer.set(result.doc, pathLeftover, newData);\n        dbPut.doc = result.doc;\n      } else {\n        dbPut.doc = _.merge(result.doc, req.data);\n      }\n    }\n\n    if (req._rev != undefined) {\n      dbPut.doc._rev = req._rev;\n    }\n    return handleMemoryCache(resourceId, dbPut, waitTime, req);\n  }\n\n  /**\n   * Get resource from the server\n   * @param req request\n   */\n  async function getResFromServer(req) {\n    var res = await request({\n      method: \"GET\",\n      url: req.url,\n      headers: req.headers,\n    });\n    res.cached = false;\n    req.data = res.data;\n    await dbUpsert(req);\n    return res;\n  }\n\n  function _getMemoryCache() {\n    return memoryCache;\n  }\n\n  // Perform lookup from bookmarks to resource id (and path leftover) mapping.\n  // If the lookup fails, use a HEAD request to get it from the server and put\n  // it in the cache. An optional _id can be passed into req to force creation\n  // of a particular lookup in the event that the resource doesn't yet exist but will.\n  // This is primarily for when links are created before the resource itself has been.\n  function getLookup(req) {\n    var urlObj = url.parse(req.url);\n    var res_inmemory = memoryCache[urlObj.path];\n    if (res_inmemory) {\n      return res_inmemory.data;\n    } else {\n      // not in memory\n      return db.get(urlObj.path).catch(async function() {\n        //Not found. Go to the oada server, get the associated resource and path\n        //leftover, and save the lookup.\n        var resourceId;\n        var pathLeftover;\n        // _id passed in with request object; special case of recursiveUpsert\n        if (req.resourceId) {\n          resourceId = req.resourceId;\n          pathLeftover = \"\";\n        } else { // normal case, not recursiveUpsert\n          //info('getLookup - HEAD request:', req.url, req)\n          var headReq = _.cloneDeep(req)\n          headReq.method = \"HEAD\";\n          var response = await request(headReq);\n          //info('getLookup - HEAD response:', response)\n          //Save the url lookup for future use\n          var pieces = response.headers[\"content-location\"].split(\"/\");\n          resourceId = pieces.slice(1, 3).join(\"/\"); //returns resources/abc\n          pathLeftover =\n            pieces.length > 3\n              ? \"/\" + pieces.slice(3, pieces.length).join(\"/\")\n              : \"\";\n        }\n        // Put the new lookup\n        var data = {\n          _id: urlObj.path,\n          resourceId,\n          pathLeftover,\n        };\n        return handleMemoryCache(urlObj.path, data, undefined, req).then(() => {\n          return getLookup(req);\n        });\n      });\n    }\n  }\n\n  // Create a queue of actual PUTs to make when online.\n  // Resource breaks are known via setupTree.\n  // Do the puts, save out the resource IDs, and return to client\n  // Create an index on the data to find those that need synced\n\n  // Create a service that other apps can run which starts up and periodically\n  // checks if a connections has yet been made. A periodic service may also\n  // concievably check for updates to cached things.\n  //\n  // The cache should go \"stale\" after some period of time; However, if it cannot\n  // establish a connection, it should remain valid, usable data.\n\n  /**\n   * Get resource from local DB. If the specified resource does not exist, try to get it from the server.\n   * @param {any} req request\n   * @param {any} offline default is false (online)\n   */\n  async function getResFromDb(req, offline = false, revLimit) {\n    var urlObj = url.parse(req.url);\n    var pieces = urlObj.path.split(\"/\");\n    var resourceId = pieces.slice(1, 3).join(\"/\"); //returns resources/abc\n    var pathLeftover =\n      pieces.length > 3 ? \"/\" + pieces.slice(3, pieces.length).join(\"/\") : \"\";\n    var resource = undefined;\n    var rev = undefined;\n    // 1) Get resource from in-memory cache\n    var res_inmemory = memoryCache[resourceId];\n    if (res_inmemory && res_inmemory.valid) {\n      resource = res_inmemory.data;\n      info(`Returning the resource [${resourceId}] from in-memory cache.`);\n    }\n\n    // 2) Get resource from local DB\n    if (!resource) {\n      try {\n        let res_localdb = await db.get(resourceId);\n        /*\n        if (!res_localdb.valid) {\n          throw new Error(\"Invalid\");\n        }\n        */\n        resource = res_localdb;\n        info(`Returning the resource [${resourceId}] from PouchDB.`);\n        // Save the data to in-memory cache\n        const now = Date.now();\n        memoryCache[resourceId] = {\n          data: resource,\n          access: now,\n          promise: undefined,\n          putPending: false,\n          valid: resource.valid,\n        };\n      } catch (err) {\n        if (err.status === 404) {\n          error(\"Failed to get resource from PouchDB\", err);\n        } else throw err;\n      }\n    }\n\n    // 3) get resource from the server\n    if (!resource && !offline) {\n      info(`Returning the resource [${resourceId}] from the remote server.`);\n      return getResFromServer(req);\n    } else if (!resource && offline) {\n      throw `Offline and resource [${resourceId}] not found in local db.`;\n    }\n\n    // Check if the resource is still valid\n    if (\n      resource.accessed + expiration <= Date.now() ||\n      resource.valid === false\n    ) {\n      if (offline) {\n        // offline. skip for now. TODO: add code later\n        throw new Error(\n          \"Cached resource is expired or invalid and unable to fetch from the remote server.\",\n        );\n      } else {\n        info(\n          `Resource is expired or invalid. Returning the resource [${resourceId}] from the remote server.`,\n        );\n        return getResFromServer(req);\n      }\n    }\n\n    //Handle _rev passed in. If current object is too far out of date, get from server\n    if (\n      req.headers &&\n      req.headers[\"x-oada-rev\"] &&\n      parseInt(req.headers[\"x-oada-rev\"]) - parseInt(resource.doc._rev) >=\n        revLimit\n    ) {\n      return getResFromServer(req);\n    }\n\n    //If no pathLeftover, it'll just return resource!\n    if (pointer.has(resource.doc, pathLeftover)) {\n      var data = pointer.get(resource.doc, pathLeftover);\n      return {\n        data,\n        headers: {\n          \"x-oada-rev\": resource.doc._rev,\n          \"content-location\": resourceId + pathLeftover,\n        },\n        status: 200,\n        cached: true,\n      };\n    } else {\n      return getResFromServer(req);\n    }\n  }\n\n  // Accepts an axios-style request. Returns:\n  // {\n  //\n  //   data: the data requested,\n  //\n  //   _rev: the rev of the parent resource requested\n  //\n  //   location: e.g.: /resources/abc123/some/path/leftover\n  //\n  // }\n  async function get(req, revLimit) {\n    var urlObj = url.parse(req.url);\n    var newReq = _.cloneDeep(req);\n    if (!/^\\/resources/.test(urlObj.path) || !/^\\/users/.test(urlObj.path)) {\n      // First lookup the resourceId in the cache\n      var lookup = await getLookup(req);\n      newReq.url =\n        urlObj.protocol +\n        \"//\" +\n        urlObj.host +\n        \"/\" +\n        lookup.resourceId +\n        lookup.pathLeftover;\n    }\n    return getResFromDb(newReq, OFFLINE, revLimit || REVLIMIT).then(\n      response => {\n        return response;\n      },\n    );\n  }\n\n  // TODO: Need to update the cache for both the parent resource and child new\n  // resource if one is created\n  async function put(req, offline = false) {\n    let urlObj = url.parse(req.url);\n    if (offline) {\n      //TODO:\n      // 1) get the lookup\n      // 2) store the last known online record\n      // 3) store the change request into an array of offlineChanges\n      // 4) update the cache (but dirty it)\n      var lookup = await getLookup({\n        url:\n          urlObj.protocol +\n          \"//\" +\n          urlObj.host +\n          reqPieces.slice(0, reqPieces.length - 1).join(\"/\"),\n        headers: req.headers,\n      });\n    } else {\n      var response = await request(req);\n\n      // Invalidate the resource in the cache (if it is cached)\n      await dbUpsert({\n        url: response.headers[\"content-location\"],\n        data: req.data,\n        _rev: parseInt(response.headers[\"x-oada-rev\"]),\n        // TODO: should it be invalidated until pulled from server?\n        valid: false,\n      });\n      // Invalidate in-memory cache\n      if (req.data && req.data._id && memoryCache[req.data._id]) {\n        memoryCache[req.data._id].valid = false;\n      }\n\n      return response;\n    }\n  }\n\n  // Remove the deleted key from the parent resource optimistically using\n  // put(). Also mark the parent invalid as the _rev update will affect it\n  async function updateParent(req) {\n    var urlObj = url.parse(req.url);\n    // Try to get the parent document\n    var reqPieces = urlObj.path.split(\"/\");\n    var lookup = await getLookup({\n      url:\n        urlObj.protocol +\n        \"//\" +\n        urlObj.host +\n        reqPieces.slice(0, reqPieces.length - 1).join(\"/\"),\n      headers: req.headers,\n    });\n    try {\n    await dbUpsert({\n      url:\n        \"/\" +\n        lookup.resourceId +\n        lookup.pathLeftover +\n        \"/\" +\n        reqPieces[reqPieces.length - 1],\n      method: \"delete\",\n      valid: false,\n    });\n    } catch (err) {\n      throw err;\n    }\n    return;\n  }\n\n  async function removeLookup(lookup) {\n    // Clear the in-memory cache\n    if (memoryCache[lookup._id]) {\n      if (memoryCache[lookup._id].promise) {\n        memoryCache[lookup._id].promise.cancel();\n      }\n      delete memoryCache[lookup._id];\n    }\n\n    try {\n      await db.remove(lookup);\n    } catch (err) {\n      if (err.status === 404) {\n        return; // Delete something thats already gone; no problem\n      } else throw err;\n    }\n  }\n\n  // Issue DELETE to server then update the db\n  async function del(req, offline) {\n    var urlObj = url.parse(req.url);\n    // Handle resource deletion\n    if (/^\\/resources/.test(urlObj.path) || /^\\/users/.test(urlObj.path)) {\n      // Submit a dbUpsert to either remove the whole cache document or else\n      // a key within a document\n      await dbUpsert({\n        url: req.url,\n        method: req.method,\n        valid: false,\n      });\n    } else {\n      var lookup;\n      try {\n        lookup = await getLookup(req);\n\n        if (lookup.pathLeftover) { // delete inside of a resource: update the document\n          await dbUpsert({\n            url: \"/\" + lookup.resourceId + lookup.pathLeftover,\n            method: req.method,\n            valid: false,\n          });\n        } else await updateParent(req); // Deleting a link: update the parent\n        await removeLookup(lookup);\n      } catch (err) {\n        if (err.response.status !== 404) throw err;\n      }\n    }\n\n    // Execute the request if we're online, else queue it up\n    var response;\n    if (!offline) {\n      response = await request(req);\n    }\n    return response;\n  }\n\n  function replaceLinks(obj, req) {\n    let ret = Array.isArray(obj) ? [] : {};\n    if (!obj) {\n      return obj;\n    }\n    Object.keys(obj || {}).forEach(async function(key, i) {\n      let val = obj[key];\n      if (typeof val !== \"object\" || !val) {\n        ret[key] = val; // keep it asntType: 'application/vnd.oada.harvest.1+json'\n        return;\n      }\n      if (val._meta) {\n        // If has a '_rev' (i.e, resource), make it a link\n        let lookup = await getLookup({\n          url: req.url + \"/\" + key,\n          headers: req.headers,\n        });\n        ret[key] = { _id: lookup.resourceId };\n        if (obj[key]._rev !== undefined) {\n          ret[key]._rev = obj[key]._rev;\n        }\n        return;\n      }\n      ret[key] = replaceLinks(obj[key], {\n        url: req.url + \"/\" + key,\n        headers: req.headers,\n      }); // otherwise, recurse into the object\n    });\n    return ret;\n  }\n\n  async function _recursiveUpsert(req, body) {\n    if (body._rev !== undefined) {\n      let lookup = await getLookup({\n        url: req.url,\n        headers: req.headers,\n        resourceId: body._id,\n      });\n      let newBody = replaceLinks(body, {\n        url: req.url,\n        headers: req.headers,\n      });\n\n      await dbUpsert({\n        url: \"/\" + (body._id || lookup.resourceId),\n        data: newBody,\n      });\n    }\n\n    if (typeof body === \"object\") {\n      return Promise.map(Object.keys(body || {}), async function(key) {\n        if (key.charAt(0) === \"_\") {\n          return;\n        }\n        if (!body[key]) {\n          return;\n        }\n        await _recursiveUpsert(\n          {\n            url: req.url + \"/\" + key,\n            headers: req.headers,\n          },\n          body[key],\n        );\n      });\n    } else {\n      return;\n    }\n  }\n\n  function findNullValue(obj, path, nullPath) {\n    if (typeof obj === \"object\") {\n      return Promise.map(\n        Object.keys(obj || {}),\n        key => {\n          if (obj[key] === null) {\n            nullPath = path + \"/\" + key;\n            return nullPath;\n          }\n          return findNullValue(obj[key], path + \"/\" + key, nullPath).then(\n            res => {\n              nullPath = res || nullPath;\n              return res || nullPath;\n            },\n          );\n        },\n        { concurrency: 1 },\n      ).then(() => {\n        return nullPath;\n      })\n    } else {\n      return Promise.resolve();\n    }\n  }\n\n  /*\n  async function _upsertChangeArray(payload) {\n    let urlObj = url.parse(payload.request.url);\n    return Promise.map(payload.response.changes || [], async (change) => {\n      if (change.type === 'merge') {\n        return dbUpsert({\n          url: urlObj.protocol+'//'+urlObj.host+'/'+change._id,\n          data: change.body,\n        })\n      } else if (change.type === 'delete') {\n        var nullPath = await findNullValue(change.body, '', '')\n        return dbUpsert({\n          url: urlObj.protocol+'//'+urlObj.host+'/'+change._id+nullPath,\n          data: change.body,\n        })\n      }\n    })\n  }\n\t*/\n\n  // Will this handle watches put on keys of a resource? i.e., no _id to be found\n  function findDeepestResource(obj, path, deepestResource) {\n    if (typeof obj === \"object\") {\n      return Promise.map(Object.keys(obj || {}), key => {\n        // _rev updates guaranteed to be present in change docs for affected resources\n        if (key === \"_rev\") {\n          deepestResource.path = path;\n          deepestResource.data = obj;\n        } else if (key.charAt(0) === \"_\") {\n          return deepestResource;\n        }\n        return findDeepestResource(\n          obj[key],\n          path + \"/\" + key,\n          deepestResource,\n        ).then(() => {\n          return deepestResource;\n        });\n      }).then(() => {\n        return deepestResource;\n      });\n    }\n    return Promise.resolve(deepestResource);\n  }\n\n  var queue = cq()\n    .limit({ concurrency: 1 })\n    .process(async function(payload) {\n      let urlObj = url.parse(payload.request.url);\n      // Give the change body an _id so the deepest resource can be found\n      payload.response.change.body = payload.response.change.body || {};\n      payload.response.change.body._id = payload.response.resourceId;\n      //TODO: This should be unnecessary. The payload ought to specify the root\n      //of the watch as a resource.\n      return findDeepestResource(payload.response.change.body, \"\", {\n        path: \"\",\n        data: payload.response.change.body,\n      })\n        .then(async deepestResource => {\n          if (payload.response.change.wasDelete) {\n            // DELETE: remove the deepest resource from the change body, execute\n            // the delete, and recursively update all other revs in the cache\n            let nullPath = await findNullValue(deepestResource.data, \"\", \"\");\n            let deletedPath = deepestResource.path + nullPath;\n            payload.nullPath = deletedPath;\n            return dbUpsert({\n              url: payload.request.url + deletedPath,\n              headers: payload.request.headers,\n              method: \"delete\",\n              valid: true,\n            }).then(async function() {\n              // Update revs on all parents all the way down to (BUT OMITTING) the\n              // resource on which the delete was called.\n              //pointer.remove(payload.response.change.body, deepestResource.path || '/')\n              //            await _recursiveUpsert(payload.request, payload.response.change.body)\n              return payload;\n            });\n          } else {\n            // Recursively update all of the resources down the returned change body\n            /*\n            var oldBody = await _recursiveUpsert(payload.request, payload.response.change.body, {})\n            payload.oldBody = oldBody;\n            return payload;\n            */\n            await _recursiveUpsert(\n              payload.request,\n              payload.response.change.body.data,\n            );\n            return payload;\n          }\n        })\n        .catch(err => {\n          return payload;\n        });\n    });\n\n  function handleWatchChange(payload) {\n    return queue(payload);\n  }\n\n  async function resetCache(name) {\n    if (db) {\n      Object.keys(memoryCache).forEach(async function(key) {\n        if (memoryCache[key].promise) {\n          await memoryCache[key].promise.cancel();\n        }\n      });\n      memoryCache = {};\n      await db.destroy();\n\n    }\n  }\n\n  let api = function handleRequest(req) {\n    switch (req.method) {\n      case \"get\":\n        return get(req);\n      case \"delete\":\n        return del(req);\n      case \"put\":\n        return put(req);\n      default:\n        throw new Error(\"Unknown request method.\");\n    }\n  };\n\n  return {\n    api,\n    db,\n    resetCache,\n    handleWatchChange,\n    removeLookup,\n    findDeepestResource,\n    findNullValue,\n    getLookup,\n    dbUpsert,\n    handleMemoryCache,\n    doPut,\n    _recursiveUpsert,\n    findNullValue,\n    replaceLinks,\n    updateParent,\n    getResFromDb,\n    getResFromServer,\n    _getMemoryCache,\n  };\n}\n","const Promise = require(\"bluebird\");\nconst urlLib = require(\"url\");\nconst uuid = require(\"uuid/v4\");\nconst WebSocket = require(\"isomorphic-ws\");\nPromise.config({ warnings: false });\n\nfunction websocket(url) {\n  //Create the message queue\n  var messages = [];\n  //Create the socket\n  url = url.replace(\"https://\", \"wss://\").replace(\"http://\", \"ws://\");\n  var socket = new WebSocket(url);\n  var connected = false;\n  var httpCallbacks = {};\n  var watchCallbacks = {};\n\n  function sendMessages() {\n    if (!connected) {\n      return;\n    }\n    messages.forEach(message => {\n      socket.send(JSON.stringify(message));\n    });\n    messages = [];\n  }\n\n  return new Promise((resolve, reject) => {\n    socket.onopen = function(event) {\n      connected = true;\n      sendMessages();\n      resolve(socket);\n    };\n\n    socket.oncloconsose = function(event) {};\n    socket.onmessage = function(event) {\n      var response = JSON.parse(event.data);\n      //Look for id in httpCallbacks\n      if (response.requestId) {\n        if (httpCallbacks[response.requestId]) {\n          //Resolve Promise\n          if (response.status >= 200 && response.status < 300) {\n            httpCallbacks[response.requestId].resolve(response);\n          } else {\n            //Create error like axios\n            let err = new Error(\n              \"Request failed with status code \" + response.status\n            );\n            err.request = httpCallbacks[response.requestId].request;\n            err.response = {\n              status: response.status,\n              statusText: response.statusText,\n              headers: response.headers,\n              data: response.data,\n            };\n            err.originalStack = httpCallbacks[response.requestId].request.requestStack;\n\n\t\t\t\t\t\thttpCallbacks[response.requestId].reject(err);\n\t\t\t\t\t}\n\t\t\t\t\tdelete httpCallbacks[response.requestId];\n        } else if (watchCallbacks[response.requestId]) {\n          if (watchCallbacks[response.requestId].resolve) {\n            if (response.status === \"success\") {\n              //Successfully setup websocket, resolve promise\n              watchCallbacks[response.requestId].resolve(response);\n            } else {\n              //error(watchCallbacks[response.requestId].request, response);\n              let err = new Error(\n                \"Request failed with status code \" + response.status\n              );\n              err.response = response;\n              err.request = watchCallbacks[response.requestId].request;\n              watchCallbacks[response.requestId].reject(err);\n            }\n            //Remove resolve and reject so we process change as a signal next time\n            delete watchCallbacks[response.requestId][\"resolve\"];\n            delete watchCallbacks[response.requestId][\"reject\"];\n          } else {\n            if (watchCallbacks[response.requestId].callback == null) {\n              throw new Error(\n                \"The given watch function has an undefined callback:\",\n                watchCallbacks[response.requestId]\n              );\n            }\n            watchCallbacks[response.requestId].callback(response);\n          }\n        }\n      }\n    };\n  }).then(() => {\n    function _http(request) {\n      //Do a HTTP request\n      return new Promise((resolve, reject) => {\n        let urlObj = urlLib.parse(request.url);\n        let message = {\n          requestId: uuid(),\n          method: request.method.toLowerCase(),\n          path: urlObj.path,\n          data: request.data,\n          headers: Object.entries(request.headers)\n            .map(([key, value]) => {\n              return { [key.toLowerCase()]: value };\n            })\n            .reduce((a, b) => {\n              return { ...a, ...b };\n            }),\n        };\n        messages.push(message);\n        httpCallbacks[message.requestId] = {\n          request: request,\n          resolve: resolve,\n          reject: reject,\n        };\n        sendMessages();\n      });\n    }\n\n    function _unwatch(request, callback) {\n      //Watch for changes on requested resource and trigger provided signal\n      return new Promise((resolve, reject) => {\n        let message = {\n          requestId: uuid(),\n          method: \"unwatch\",\n          path: request.path,\n          headers: Object.entries(request.headers)\n            .map(([key, value]) => {\n              return { [key.toLowerCase()]: value };\n            })\n            .reduce((a, b) => {\n              return { ...a, ...b };\n            }),\n        };\n        messages.push(message);\n        watchCallbacks[message.requestId] = {\n          request,\n          resolve,\n          reject,\n          callback,\n        };\n        sendMessages();\n      });\n    }\n\n    function _watch(request, callback) {\n      //Watch for changes on requested resource and trigger provided signal\n      return new Promise((resolve, reject) => {\n        let message = {\n          requestId: uuid(),\n          method: \"watch\",\n          path: request.path,\n          headers: Object.entries(request.headers)\n            .map(([key, value]) => {\n              return { [key.toLowerCase()]: value };\n            })\n            .reduce((a, b) => {\n              return { ...a, ...b };\n            }),\n        };\n        messages.push(message);\n        watchCallbacks[message.requestId] = {\n          request,\n          resolve,\n          reject,\n          callback,\n        };\n        sendMessages();\n      });\n    }\n\n    function _close() {\n      //TODO reject all callbacks that have not resolved\n      //Clear everything\n      messages = [];\n      httpCallbacks = {};\n      watchCallbacks = {};\n      //Close socket\n      socket.close();\n    }\n\n    return {\n      url,\n      http: _http,\n      close: _close,\n      watch: _watch,\n      unwatch: _unwatch,\n    };\n  });\n}\n\nmodule.exports = websocket;\n","\"use strict\";\n\n/* Copyright 2018 Open Ag Data Alliance\n *\n * Licensed under the Apache License, Version 2.0 (the 'License');\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an 'AS IS' BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\n/**\n * @author Servio Palacios, Samuel Noel\n * Token API for Handling Tokens in the Cache Library - Super Class.\n * @module src/token\n */\n\nvar Promise = require(\"bluebird\");\nlet PouchDB = require(\"pouchdb\");\nif (PouchDB.default) PouchDB = PouchDB.default;\nconst { STATUS_CODE } = require(\"http\");\nconst urlLib = require(\"url\");\nconst _ = require(\"lodash\");\n//const debug = require(\"debug\")(\"oada-cache:token\");\nconst crypto = require(\"crypto\");\nconst oadaIdClient = require(\"@oada/oada-id-client\");\n//const error = require('debug')('oada-cache:index:error');\n//const info = require('debug')('oada-cache:index:info');\n\nclass Token {\n  constructor(param = {}) {\n    let self = this;\n    self._token = param.token || null;\n    self._domain = param.domain || \"localhost\";\n    self._options = param.options;\n    self._dbprefix = param.dbprefix || \"\";\n\n    // creating database nae based on the domain\n    // ensured one to one correspondence with the domain\n    // i.e., token belongs to that domain\n    const hash = crypto.createHash(\"sha256\");\n    hash.update(self._domain);\n    self._name = self._dbprefix + hash.digest(\"hex\");\n\n    self._isSet = self._token ? true : false;\n    self._tokenDB = new PouchDB(self._name);\n    self._id = \"OadaTokenID\";\n    self._rev = null;\n    self.token = self._token ? self._token : \"\";\n  } //constructor\n\n  /**\n   * searches for a local db and a doc\n   */\n  async checkTokenDB() {\n    let result = null;\n    try {\n      //getting the doc from the server if exists\n      let doc = await this._tokenDB.get(this._id);\n      //      debug(\"received document ->\", doc);\n      result = doc.token;\n      this._rev = doc._rev;\n    } catch (err) {\n      return result;\n    }\n    return result;\n  } //checkTokenDB\n\n  /**\n   * if token was provided then it sets the .token in the constructor -> returns that value\n   * sets the pouch db if it does not exist\n   */\n  async setup(_expired) {\n    // Get a token\n    let TOKEN = null; //returned to the chache library\n    if (this.isSet()) {\n      TOKEN = this.token;\n    } else {\n      // get token from local cache\n      TOKEN = await this.checkTokenDB();\n\n      if (!TOKEN || _expired) {\n        //local cache does not have a token\n        let urlObj = urlLib.parse(this._domain);\n        let result;\n        // Open the browser and the login popup\n        if (typeof window === \"undefined\") {\n          result = await oadaIdClient.node(urlObj.host, this._options);\n        } else {\n          // the library itself detects a browser environment and delivers .browser\n          var gat = Promise.promisify(oadaIdClient.getAccessToken);\n          result = await gat(urlObj.host, this._options);\n        }\n        TOKEN = result.access_token;\n        //        debug(\"setup token -> access token:\", result.access_token);\n        this.put(TOKEN);\n      } //if !TOKEN\n    } //else\n    return TOKEN;\n  } //setup\n\n  /**\n   * fetches the token from the this._tokenDB or\n   * setups the new database and retrieves the new token to be used\n   */\n  async get() {\n    return this.setup();\n  }\n\n  /**\n   * searches for the token in the this._tokenDB\n   * if present, the it sends the current _rev\n   * if not present (404), it creates a new document in the created this._tokenDB\n   * @param {string} _token\n   */\n  async put(_token) {\n    // get token from local cache\n    let TOKEN = this.checkTokenDB();\n    try {\n      if (TOKEN) {\n        //local cache has that token, use the _rev\n        let response = await this._tokenDB.put({\n          _id: this._id,\n          _rev: this._rev,\n          token: _token,\n        });\n        this.token = _token;\n      } else {\n        //not found\n        //        debug(\"not found -> creating one\");\n        let response = await this._tokenDB.put({\n          _id: this._id,\n          token: _token,\n        });\n        this.token = _token;\n      } //else\n    } catch (err) {\n      //error(\"Error: not found -> put\", err);\n    }\n  } //put\n\n  async renew() {\n    this._isSet = false;\n    return this.setup(true); //expired = true\n  }\n\n  async cleanUp() {\n    try {\n      await this._tokenDB.destroy();\n      //await this._tokenDB.close();\n      this._isSet = false;\n    } catch (err) {\n      //error(\"deleting token from cache\", err);\n    }\n  } //cleanUp\n\n  isSet() {\n    return this._isSet;\n  }\n} //class\n\n/* exporting the module */\nmodule.exports = Token;\n"],"sourceRoot":""}