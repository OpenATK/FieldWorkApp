(this["webpackJsonpfield-work"]=this["webpackJsonpfield-work"]||[]).push([[0],{1020:function(e,a,n){"use strict";n.r(a);var t={};n.r(t),n.d(t,"state",(function(){return Ae})),n.d(t,"actions",(function(){return Fe})),n.d(t,"onInitialize",(function(){return Ee}));var o={};n.r(o),n.d(o,"state",(function(){return Ze})),n.d(o,"actions",(function(){return We})),n.d(o,"effects",(function(){return Le}));var r=n(0),i=n.n(r),c=n(28),s=n.n(c);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(597),n(598),n(599);var l,d,u=n(192),p=n(69),f=n(1),m=n.n(f),g=n(235),v=n(573),w=n(9),h=n.n(w),b=n(25),k=n(36),y={OPTIONS:{redirect:d="http://openatk.com/FieldWorkApp/oauth2/redirect/",metadata:l="eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCIsImtpZCI6ImRldjEiLCJqd2siOnsia3R5IjoiUlNBIiwibiI6InJyMzhpSzhGaTBfLUNSTFR2Vks0SUlDbGFyaWk2d1ZIcEU3elpQWG9FUmxfT29oNjRZbWJRY1JhNWVGdzBVUWhVdkVDaEt1OU5vM2ptN0xXOVpjTDFIS3Joa1VXLU9Rb2JPWFVuckNnb0NwYThWWWhfd1JJZFFZYnN2UFFWajVOR3V1TlhhWkJfX3B4Rnktbl9PMklNUzhPR3Jlem0zYlFIREFmLWpuZ0loWkdaZ0xhdkxKeVNIVXlEUUw0RmJRNkQzUXozQU1PcnhGdmE0S0JJUENRS0ZPbVlYVm40enRnVDY4aGd5TW9jMUt5dHhvUmd6VkhuQ2RUcFBXV1Zybk1GY0plZFlELUxtazBYbzVyallPeG1xOEExZWpmeFBNZVJfM1Y3OEFKazJMREk0dkdhSjNmbmFQWlM3Q3ZXOEYzcFdXaWpfQnlWR0NJLTVCcmtxSF9uUSIsImUiOiJBUUFCIn19.eyJyZWRpcmVjdF91cmlzIjpbImh0dHA6Ly9vcGVuYXRrLmNvbS9GaWVsZFdvcmtBcHAvb2F1dGgyL3JlZGlyZWN0Lmh0bWwiLCJodHRwOi8vdmlwMy5lY24ucHVyZHVlLmVkdTo4MDAwL29hdXRoMi9yZWRpcmVjdC8iLCJodHRwOi8vbG9jYWxob3N0L29hdXRoMi9yZWRpcmVjdC5odG1sIiwiaHR0cDovL2xvY2FsaG9zdDo4MDAwL29hdXRoMi9yZWRpcmVjdC8iXSwidG9rZW5fZW5kcG9pbnRfYXV0aF9tZXRob2QiOiJ1cm46aWV0ZjpwYXJhbXM6b2F1dGg6Y2xpZW50LWFzc2VydGlvbi10eXBlOmp3dC1iZWFyZXIiLCJncmFudF90eXBlcyI6WyJhdXRob3JpemF0aW9uX2NvZGUiXSwicmVzcG9uc2VfdHlwZXMiOlsidG9rZW4iLCJjb2RlIiwiaWRfdG9rZW4iLCJpZF90b2tlbiB0b2tlbiIsImNvZGUgaWRfdG9rZW4iLCJjb2RlIHRva2VuIiwiY29kZSBpZF90b2tlbiB0b2tlbiJdLCJjbGllbnRfbmFtZSI6Ik9wZW5BVEsiLCJjbGllbnRfdXJpIjoiaHR0cDovL29wZW5hdGsuY29tIiwiY29udGFjdHMiOlsiU2FtIE5vZWwgPHNhbm9lbEBwdXJkdWUuZWR1PiJdLCJqd2tzIjp7ImtleXMiOlt7Imt0eSI6IlJTQSIsIm4iOiItWUhaWnFkNUxYa1hSN2tlSkpoSFhtR3F6VlVGZFVlRktDQjJoTDFTUGdTdVlXVUdqZWhXUHZQR3R5MEs0Z05ka3Jma1JOQ3FqNTQtenZoMXF6RF9DV1NBNXktdktwM1Nlc0FBcXlFVlozY1hGWHBUZHNlbFRibUJKMHR0cnctbmgtdGVlVUFuZEpjRTl1ZDhoRFhabURoYnNCamFVeEdsNlV1NTBZcTRwNVlJY2FHeEVtMksyMXB6Rnd1dDIyYVJJM2xreUl6RlZKOWoyMW1iR3ZZd3p1QjJQaDNOZl9od1k3ZkwxTU12elhjVDZHSzNpMmd5MjJMa0F3SFNSZFI5emxfb2dXOEtlOEtuWm1weUt6UmZoTTg1WDlNX2hnQkxKSzVRWU03VW9YOGRmcTM2Ylg3NHRsd0NlajVDUFZHYUNxdDJmN2h4ZERKNjFKd3I1TlI5UFEiLCJlIjoiQVFBQiIsImtpZCI6IjAyODNmNTFkNzgyNzQ0YmNhMTExNjgzNGQwZjIyOWMyIn1dfSwic29mdHdhcmVfaWQiOiJhNzAzYmZkYy0zZmExLTQ5OWYtYjkwNS0xMWYwYjU0ZjM4MDciLCJyZWdpc3RyYXRpb25fcHJvdmlkZXIiOiJodHRwczovL2lkZW50aXR5Lm9hZGEtZGV2LmNvbSIsImlhdCI6MTUzMzg0NjExMn0.diiBQ5uy_zBMPHpgAYR9ckPc6N5QkOtSiS_YERJq5wxEycASV8_bKPeDw7IHZNRMZa_K4OlUydRz2PQ_Ch_bHc4-AbrIQADchVCCOzgqVs88DqhhYjUV7T40L1to5xreZ4xQZvgWZtKzIqbOurOZjXMLoYNY-2KNUxbvvTfsy0M17TlT4T_lNIZcls766HxEmlZfrvRnns-Z8riDSHb2TlfIrKzW9d7Ax7Atybu9T8aWJZTxoQWgRBsNuUSAj5tfiVS_3yKTyP46DFq-Aflo6_1FpDgquGHO2CUkP5tQqq4sy_FHLsmf6J0l7Cl69Oa857h6eYlcLgfbbLy-oseYwQ",scope:"oada.yield:all"},REDIRECT:d,METADATA:l,SCOPE:"oada.yield:all",oadaDomain:""},O={domain:y.oadaDomain},D={onInitialize:function(e){var a=e.state,n=e.actions,t=window.localStorage["oada:domain"],o=window.localStorage["oada:token"];t&&(a.view.Login.domain=t),t&&o&&n.view.Login.login({token:o})},login:function(e,a){return Object(b.a)(h.a.mark((function n(){var t,o,r,i,c;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.state,o=e.actions,r=a.token,i=t.view.Login,c=i.domain,i.loading=!0,c=c.match(/^http/)?c:"https://"+i.domain,n.next=8,o.app.OADAManager.login({domain:c,token:r});case 8:i.loading=!1,t.app.OADAManager.connected&&(i.loggedIn=!0,window.localStorage["oada:domain"]=i.domain,window.localStorage["oada:token"]=t.app.OADAManager.token);case 10:case"end":return n.stop()}}),n)})))()},logout:function(e){return Object(b.a)(h.a.mark((function a(){var n,t,o;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,t=e.actions,o=n.view.Login,!n.app.OADAManager.connected){a.next=7;break}return a.next=5,t.app.OADAManager.logout();case 5:delete window.localStorage["oada:domain"],delete window.localStorage["oada:token"];case 7:o.loggedIn=!1;case 8:case"end":return a.stop()}}),a)})))()},domainChange:function(e,a){e.state.view.Login.domain=a.value},viewDemo:function(e,a){e.state.view.Login.loggedIn=!0}},A=n(68),F=n(238),E=n.n(F),M={open:!1,fieldId:function(e,a){return Object(A.a)(e),m.a.get(a,"view.Map.selectedField")},field:function(e,a){var n=e.fieldId,t=m.a.get(a,"view.TopBar.OperationDropdown.selectedOperation");if(null==n)return null;var o=m.a.get(t,"fields.".concat(n,".status"),null),r=null;if(1==m.a.get(a,"app.OADAManager.connected")){var i=m.a.get(a,"app.OADAManager.currentConnection");r=m.a.get(a,"app.oada.".concat(i,".bookmarks.seasons.2020.fields.").concat(n))}else r=m.a.get(a,"app.localData.abc123.seasons.2020.fields.".concat(n));if(null==r)return null;var c=247105e-9*E.a.geometry(r.boundary);return m.a.merge({},r,{status:o,acres:c})},farm:function(e,a){var n=e.field,t=null;if(1==m.a.get(a,"app.OADAManager.connected")){var o=m.a.get(a,"app.OADAManager.currentConnection");if(m.a.get(n,"farm._id")){var r=m.a.get(a,"app.oadaSeasonFarmsIdBy_id.".concat(m.a.get(n,"farm._id"),".id"));t=m.a.get(a,"app.oada.".concat(o,".bookmarks.seasons.2020.farms.").concat(r))}}else m.a.get(n,"farm.id")&&(t=m.a.get(a,"app.localData.abc123.seasons.2020.farms.".concat(n.farm.id)));return t},showAddOperationButton:function(e,a){if(Object(A.a)(e),1==m.a.get(a,"app.OADAManager.connected")){var n=m.a.get(a,"app.OADAManager.currentConnection");return m.a.isEmpty(m.a.get(a,"app.oada.".concat(n,".bookmarks.seasons.2020.operations")))}return m.a.isEmpty(m.a.get(a,"app.localData.abc123.seasons.2020.operations"))}},x=n(49),C=n.n(x),S={bookmarks:{_type:"application/vnd.oada.bookmarks.1+json",_rev:0,fields:{_type:"application/vnd.oada.fields.1+json",_rev:0,fields:{"*":{_type:"application/vnd.oada.field.1+json",_rev:0,farm:{_type:"application/vnd.oada.farm.1+json"}}},farms:{"*":{_type:"application/vnd.oada.farm.1+json",_rev:0}}},seasons:{_type:"application/vnd.oada.seasons.1+json",_rev:0,"*":{_type:"application/vnd.oada.season.1+json",_rev:0,fields:{"*":{_type:"application/vnd.oada.field.1+json",_rev:0,operations:{"*":{_type:"application/vnd.oada.operation.1+json"}}}},farms:{"*":{_type:"application/vnd.oada.farm.1+json",_rev:0}},operations:{"*":{_type:"application/vnd.oada.operation.1+json",_rev:0}}}}}},j=M,I={open:function(e){e.state.view.FieldDetails.open=!0},close:function(e){e.state.view.FieldDetails.open=!1},changeOADAFieldStatus:function(e,a){var n=e.state,t=e.actions,o=m.a.get(n,"view.Map.selectedField"),r=m.a.get(n,"view.TopBar.OperationDropdown.selectedOperationId"),i=m.a.get(n,"app.OADAManager.currentConnection"),c=m.a.clone(m.a.get(n,"app.oada.".concat(i,".bookmarks.seasons.2020.operations.").concat(r,".fields.").concat(o)))||{},s=a;if(c.status==a&&(s=null),c.status=s,null==c.status){m.a.unset(n,"app.oada.".concat(i,".bookmarks.seasons.2020.operations.").concat(r,".fields.").concat(o)),m.a.unset(n,"app.oada.".concat(i,".bookmarks.seasons.2020.fields.").concat(o,".operations.").concat(r));var l=[{type:"application/vnd.oada.operation.1+json",path:"/bookmarks/seasons/2020/operations/".concat(r,"/fields/").concat(o)},{type:"application/vnd.oada.field.1+json",path:"/bookmarks/seasons/2020/fields/".concat(o,"/operations/").concat(r)}];t.app.oada.delete({requests:l,connection_id:i})}else{m.a.set(n,"app.oada.".concat(i,".bookmarks.seasons.2020.operations.").concat(r,".fields.").concat(o),c),null==m.a.get(n,"app.oada.".concat(i,".bookmarks.seasons.2020.fields.").concat(o,".operations"))&&m.a.set(n,"app.localData.abc123.seasons.2020.fields.".concat(o,".operations"),{}),m.a.set(n,"app.oada.".concat(i,".bookmarks.seasons.2020.fields.").concat(o,".operations.").concat(r),{});var d=m.a.get(n,"view.TopBar.OperationDropdown.selectedOperation"),u=[{tree:S,data:c,type:"application/vnd.oada.operation.1+json",path:"/bookmarks/seasons/2020/operations/".concat(r,"/fields/").concat(o)},{tree:S,data:{_id:d._id},type:"application/vnd.oada.field.1+json",path:"/bookmarks/seasons/2020/fields/".concat(o,"/operations/").concat(r)}];t.app.oada.put({requests:u,connection_id:i})}},changeLocalFieldStatus:function(e,a){var n=e.state,t=(n.view.FieldDetails,m.a.get(n,"view.Map.selectedField")),o=m.a.get(n,"view.TopBar.OperationDropdown.selectedOperationId"),r=m.a.clone(m.a.get(n,"app.localData.abc123.seasons.2020.operations.".concat(o,".fields.").concat(t)))||{},i=a;r.status==a&&(i=null),r.status=i,null==r.status?(m.a.unset(n,"app.localData.abc123.seasons.2020.operations.".concat(o,".fields.").concat(t)),m.a.unset(n,"app.localData.abc123.seasons.2020.fields.".concat(t,".operations.").concat(o))):(m.a.set(n,"app.localData.abc123.seasons.2020.operations.".concat(o,".fields.").concat(t),r),null==m.a.get(n,"app.localData.abc123.seasons.2020.fields.".concat(t,".operations"))&&m.a.set(n,"app.localData.abc123.seasons.2020.fields.".concat(t,".operations"),{}),m.a.set(n,"app.localData.abc123.seasons.2020.fields.".concat(t,".operations.").concat(o),{}))},onStatusChange:function(e,a){var n=e.state,t=e.actions,o=a.status,r=t.view.FieldDetails;n.app.OADAManager.connected?r.changeOADAFieldStatus(o):r.changeLocalFieldStatus(o)},onAddNewOperationClick:function(e){e.actions.view.TopBar.OperationDropdown.onAdd()}},_={open:!1,selectedField:null},N={},T={fieldStyles:{},selectedField:null,editingField:null,center:[41.448068,-84.972648],zoom:13,bounds:[[41.44053877385792,-84.97886180877687],[41.46330393671208,-84.96770381927492]],fields:function(e,a){Object(A.a)(e);var n=m.a.get(a,"view.Map.fieldStyles"),t=m.a.get(a,"view.Map.editingField"),o=(m.a.get(a,"view.Map.BoundaryDrawing.drawing"),m.a.get(a,"view.TopBar.OperationDropdown.selectedOperation")),r=m.a.get(a,"app.seasonFields");return m.a.chain(r).mapValues((function(e,a){if(null==e)return null;if(null==e.boundary)return null;if(t==a)return null;var r=m.a.clone(e);if(null!=n[a]&&(r.style=n[a]),o){var i="white";o.fields&&o.fields[a]&&("planned"==o.fields[a].status&&(i="red"),"started"==o.fields[a].status&&(i="orange"),"done"==o.fields[a].status&&(i="#0acd00")),r.style=m.a.merge({},r.style,{fillColor:i,color:i})}return r})).omitBy((function(e,a){if(null==e)return!0})).value()}},R=n(55),B=n.n(R),Z=n(529),W=n.n(Z),L=n(530),z=n.n(L),V={zoomTo:function(e,a){return Object(b.a)(h.a.mark((function n(){var t,o,r,i,c;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.state,o=a.latitude,r=a.longitude,i=a.zoom,(c=m.a.get(t,"view.Map")).center=[o,r],c.zoom=i,n.next=7,B.a.delay(500);case 7:c.center=null,c.zoom=null;case 9:case"end":return n.stop()}}),n)})))()},styleField:{highlight:function(e,a){var n=e.state;if(a){var t=m.a.get(n,"view.Map");m.a.set(t,"fieldStyles.".concat(a),{weight:5})}},unhighlight:function(e,a){var n=e.state;if(a){var t=m.a.get(n,"view.Map");m.a.set(t,"fieldStyles.".concat(a),{weight:3})}}},unselectField:function(e){return Object(b.a)(h.a.mark((function a(){var n,t,o,r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,t=e.actions,o=m.a.get(t,"view.Map"),!(r=m.a.get(n,"view.Map")).selectedField){a.next=9;break}return t.view.FieldDetails.close(),o.styleField.unhighlight(r.selectedField),a.next=8,B.a.delay(200);case 8:r.selectedField=null;case 9:case"end":return a.stop()}}),a)})))()},onFieldClick:function(e,a){var n=e.state,t=e.actions,o=a.id,r=m.a.get(t,"view.Map"),i=m.a.get(n,"view.Map");m.a.get(i,"BoundaryDrawing.drawing")||(r.styleField.unhighlight(i.selectedField),i.selectedField=o,r.styleField.highlight(o),t.view.FieldDetails.open())},onMapClick:function(e,a){var n=e.actions,t=m.a.get(n,"view.Map");t.unselectField(),t.BoundaryDrawing.onMapClick(a)},zoomBounds:function(e,a){return Object(b.a)(h.a.mark((function a(){var n,t,o,r,i;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=e.state,t=m.a.get(n,"view.Map"),o=m.a.compact(m.a.map(t.fields,(function(e){return e.boundary?{geo:e.boundary}:null}))),r=z.a.parse(o,{GeoJSON:"geo"}),i=W()(r),isFinite(i[0])&&isFinite(i[1])&&isFinite(i[2])&&isFinite(i[3])&&(t.bounds=[[i[1],i[0]],[i[3],i[2]]]);case 6:case"end":return a.stop()}}),a)})))()}},J=n(47),U={boundary:{},drawing:!1},G={addPointToBoundary:function(e,a){var n=e.state.view.Map.BoundaryDrawing;m.a.set(n,"boundary.".concat(C()()),[a.lat,a.lng])},updateBoundaryPoint:Object(J.h)(Object(J.d)(10),Object(J.g)((function(e,a){var n=e.state.view.Map.BoundaryDrawing;m.a.set(n,"boundary.".concat(a.id),[a.latlng.lat,a.latlng.lng])}))),onMapClick:function(e,a){var n=e.state,t=e.actions,o=a.lat,r=a.lng,i=n.view.Map.BoundaryDrawing,c=t.view.Map.BoundaryDrawing;i.drawing&&c.addPointToBoundary({lat:o,lng:r})},onMarkerMove:function(e,a){e.actions.view.Map.BoundaryDrawing.updateBoundaryPoint(a)},onStartDrawing:function(e,a){var n=e.state.view.Map.BoundaryDrawing;n.boundary=(a||{}).boundary||{},n.drawing=!0},onStopDrawing:function(e,a){var n=e.state.view.Map.BoundaryDrawing;n.drawing=!1,n.boundary={}}},P=Object(k.a)({BoundaryDrawing:U},T),Y=Object(k.a)({BoundaryDrawing:G},V),X={OADADomain:{open:!1,domain:y.oadaDomain}},H={OADADomain:{open:function(e){e.state.view.Modals.OADADomain.open=!0},close:function(e){e.state.view.Modals.OADADomain.open=!1},onConnectClick:function(e){e.actions.view.Modals.OADADomain.open()},onDomainChange:function(e,a){var n=e.state,t=a.domain;n.view.Modals.OADADomain.domain=t},onConnect:function(e){return Object(b.a)(h.a.mark((function a(){var n,t,o,r,i;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=e.state,o=t.view.Modals.OADADomain,r=n.view.Modals.OADADomain,i=o.domain,o.loading=!0,a.next=7,n.app.OADAManager.onDomainChanged({domain:i});case 7:o.loading=!1,r.close();case 9:case"end":return a.stop()}}),a)})))()},onCancel:function(e){e.actions.view.Modals.OADADomain.close()}}};function q(e){var a={type:"Polygon",coordinates:[m.a.map(e,(function(e){return[e[1],e[0]]}))]};return a.coordinates&&a.coordinates[0]&&a.coordinates[0].length>0&&a.coordinates[0].push(a.coordinates[0][0]),a}function Q(e,a){var n=e.state,t=e.actions,o=a.fieldId,r=a.newBoundary,i=a.farmId,c=a.farm_id,s=a.seasonFarm_id,l=n.view.Modals.SaveField,d=t.app.getSeasonField(o),u=l.name,p={},f={};return u!=d.name&&(p.name=u),0==m.a.isEqual(r,d.boundary)&&(p.boundary=r),f=m.a.cloneDeep(p),s?d.farm&&d.farm._id==s||(p.farm={_id:s},f.farm={_id:c}):d.farm&&d.farm.id==i||(p.farm={id:i},f.farm={id:i}),{fieldChanges:f,seasonFieldChanges:p}}function K(e,a,n,t){var o=e.state;if(!m.a.isEmpty(n)||!m.a.isEmpty(t)){var r="app.localData.abc123.fields.fields.".concat(a);m.a.set(o,r,m.a.merge({},m.a.get(o,r),n));var i="app.localData.abc123.seasons.2020.fields.".concat(a);m.a.set(o,i,m.a.merge({},m.a.get(o,i),t))}}function $(e,a,n,t){return ee.apply(this,arguments)}function ee(){return(ee=Object(b.a)(h.a.mark((function e(a,n,t,o){var r,i,c,s;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=a.state,i=a.actions,!m.a.isEmpty(t)||!m.a.isEmpty(o)){e.next=3;break}return e.abrupt("return");case 3:return c=[],0==m.a.isEmpty(t)&&c.push({tree:S,data:t,path:"/bookmarks/fields/fields/".concat(n)}),0==m.a.isEmpty(o)&&c.push({tree:S,data:o,path:"/bookmarks/seasons/2020/fields/".concat(n)}),console.log("fieldChanges",t),console.log("seasonFieldChanges",o),s=m.a.get(r,"app.OADAManager.currentConnection"),e.next=11,i.app.oada.put({requests:c,connection_id:s});case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e,a){var n=a.boundary,t=a.farmId,o=a.farm_id;return{name:e.state.view.Modals.SaveField.name,boundary:n,farm:o?{_id:o}:{id:t}}}function ne(e,a){var n=a.field,t=e.state,o=C()();return m.a.set(t,"app.localData.abc123.fields.fields.".concat(o),n),m.a.set(t,"app.localData.abc123.seasons.2020.fields.".concat(o),Object(k.a)({},n,{operations:{},year:"2020"})),o}function te(e,a){return oe.apply(this,arguments)}function oe(){return(oe=Object(b.a)(h.a.mark((function e(a,n){var t,o,r,i,c,s,l;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.field,o=n.seasonField,r=a.state,i=a.actions,c=C()(),s=[],t&&s.push({tree:S,data:t,path:"/bookmarks/fields/fields/".concat(c)}),o&&s.push({tree:S,data:Object(k.a)({},o,{operations:{},year:"2020"}),path:"/bookmarks/seasons/2020/fields/".concat(c)}),l=m.a.get(r,"app.OADAManager.currentConnection"),e.next=9,i.app.oada.put({requests:s,connection_id:l});case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var re={open:!1,name:"",farmSearch:"",farms:function(e,a){var n=e.farmSearch;return m.a.compact(m.a.map(a.app.seasonFarms,(function(e,a){return!e||""!=n&&e.name&&-1==e.name.toLowerCase().search(n.toLowerCase())?null:{key:a,text:e.name,value:a}})))},farmId:null,farm:function(e,a){var n=e.farmId;e.farms;if(n)return m.a.get(a,"app.seasonFarms.".concat(n))}},ie={open:function(e){var a=e.state,n=e.actions,t=a.view.Modals.SaveField,o=m.a.get(a,"view.Map.editingField");if(null==o)t.name="";else{var r=n.app.getSeasonField(o);if(t.name=r.name,a.app.OADAManager.connected){var i=m.a.get(a,"app.oadaSeasonFarmsIdBy_id.".concat(m.a.get(r,"farm._id"),".id"));t.farmId=i}else t.farmId=m.a.get(r,"farm.id")}t.open=!0},close:function(e){e.state.view.Modals.SaveField.open=!1},saveField:function(e){return Object(b.a)(h.a.mark((function a(){var n,t,o,r,i,c,s,l,d,u,p,f,g,v,w;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,t=n.view.Modals.SaveField,o=m.a.get(n,"view.Map.BoundaryDrawing.boundary"),r=q(o),i=t.farmId,c=null,s=null,(l=t.farm)&&n.app.OADAManager.connected&&(c=m.a.get(n,"app.oadaOrgData.fields.farms.".concat(i,"._id")),s=m.a.get(n,"app.seasonFarms.".concat(i,"._id"))),!(d=m.a.get(n,"view.Map.editingField"))){a.next=15;break}u=Q(e,{fieldId:d,newBoundary:r,farmId:i,farm_id:c,seasonFarm_id:s}),p=u.fieldChanges,f=u.seasonFieldChanges,n.app.OADAManager.connected?$(e,d,p,f):K(e,d,p,f),a.next=31;break;case 15:if(!n.app.OADAManager.connected){a.next=26;break}return a.next=18,ae(e,{boundary:r,farm_id:c});case 18:return g=a.sent,a.next=21,ae(e,{boundary:r,farm_id:s});case 21:return v=a.sent,a.next=24,te(e,{field:g,seasonField:v});case 24:a.next=31;break;case 26:return a.next=28,ae(e,{boundary:r,farm:l,farmId:i});case 28:return w=a.sent,a.next=31,ne(e,{field:w});case 31:case"end":return a.stop()}}),a)})))()},onSave:function(e){var a=e.actions,n=e.state,t=a.view.Modals.SaveField;t.saveField(),a.view.Map.BoundaryDrawing.onStopDrawing(),n.view.Map.editingField=null,t.close()},onCancel:function(e){var a=e.actions,n=e.state,t=a.view.Modals.SaveField;a.view.Map.BoundaryDrawing.onStopDrawing(),n.view.Map.editingField=null,t.close()},onNameChange:function(e,a){var n=e.state,t=a.name;n.view.Modals.SaveField.name=t},onFarmSearchChange:function(e,a){e.state.view.Modals.SaveField.farmSearch=a},onFarmChange:function(e,a){var n=e.state,t=a.id;n.view.Modals.SaveField.farmId=t},onFarmAdd:function(e){e.actions.view.Modals.NewFarm.open({callbackAction:"view.Modals.SaveField.onFarmAddComplete"})},onFarmAddComplete:function(e,a){var n=e.state,t=a.id;n.view.Modals.SaveField.farmId=t}};function ce(e,a){var n=e.state,t=a.operation,o=C()();return m.a.set(n,"app.localData.abc123.seasons.2020.operations.".concat(o),t),o}function se(e,a){return le.apply(this,arguments)}function le(){return(le=Object(b.a)(h.a.mark((function e(a,n){var t,o,r,i,c,s,l,d;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=a.state,o=a.actions,r=n.operation,i=C()(),c=[{tree:S,data:r,path:"/bookmarks/seasons/2020/operations/".concat(i)}],s=m.a.get(t,"app.OADAManager.currentConnection"),e.next=7,o.app.oada.put({requests:c,connection_id:s});case 7:return l=e.sent,d=m.a.get(l,"responses.0.headers.content-location").substr(1),e.abrupt("return",{id:i,_id:d});case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var de={open:!1,name:""},ue={open:function(e){var a=e.state.view.Modals.NewOperation;a.name="",a.open=!0},close:function(e){e.state.view.Modals.NewOperation.open=!1},saveOperation:function(e){return Object(b.a)(h.a.mark((function a(){var n,t,o,r,i,c;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,t=n.view.Modals.NewOperation,s={name:t.name},o={name:s.name,fields:{}},!n.app.OADAManager.connected){a.next=12;break}return a.next=6,se(e,{operation:o});case 6:r=a.sent,i=r.id,r._id,m.a.set(n,"view.TopBar.OperationDropdown.selected",i),a.next=16;break;case 12:return a.next=14,ce(e,{operation:o});case 14:c=a.sent,m.a.set(n,"view.TopBar.OperationDropdown.selected",c);case 16:case"end":return a.stop()}var s}),a)})))()},onNameChange:function(e,a){var n=e.state,t=a.name;n.view.Modals.NewOperation.name=t},onCancel:function(e){e.actions.view.Modals.NewOperation.close()},onSave:function(e){return Object(b.a)(h.a.mark((function a(){var n,t;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=n.view.Modals.NewOperation,a.next=4,t.saveOperation();case 4:t.close();case 5:case"end":return a.stop()}}),a)})))()}};function pe(e,a){var n=a.farm,t=e.state,o=C()();return m.a.set(t,"app.localData.abc123.farms.".concat(o),n),m.a.set(t,"app.localData.abc123.seasons.2020.farms.".concat(o),n),o}function fe(e,a){return me.apply(this,arguments)}function me(){return(me=Object(b.a)(h.a.mark((function e(a,n){var t,o,r,i,c,s,l,d,u;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.farm,o=a.state,r=a.actions,i=C()(),c=[{tree:S,data:t,path:"/bookmarks/fields/farms/".concat(i)},{tree:S,data:t,path:"/bookmarks/seasons/2020/farms/".concat(i)}],s=m.a.get(o,"app.OADAManager.currentConnection"),e.next=7,r.app.oada.put({requests:c,connection_id:s});case 7:if(l=e.sent,null!=(d=m.a.get(l,"responses.0.headers.content-location").substr(1))){e.next=11;break}throw"OADA did not return an _id when creating a farm.";case 11:if(null!=(u=m.a.get(l,"responses.1.headers.content-location").substr(1))){e.next=14;break}throw"OADA did not return an _id when creating a season farm.";case 14:return e.abrupt("return",{farm_id:d,seasonFarm_id:u,id:i});case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var ge={open:!1,name:""},ve={open:function(e,a){var n=e.state,t=a.callbackAction,o=n.view.Modals.NewFarm;o.name="",o.open=!0,o.callbackAction=t||null},close:function(e){e.state.view.Modals.NewFarm.open=!1},saveFarm:function(e){return Object(b.a)(h.a.mark((function a(){var n,t,o,r,i,c,s,l,d,u,p;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n=e.state,t=e.actions,o=n.view.Modals.NewFarm,f={name:o.name},r={name:f.name},!n.app.OADAManager.connected){a.next=17;break}return a.next=6,fe(e,{farm:r});case 6:if(i=a.sent,c=i.farm_id,s=i.seasonFarm_id,l=i.id,!o.callbackAction){a.next=15;break}if(d=m.a.get(t,o.callbackAction)){a.next=14;break}throw"callbackAction: ".concat(o.callbackAction," does not exist.");case 14:d({farm_id:c,seasonFarm_id:s,id:l});case 15:a.next=25;break;case 17:return a.next=19,pe(e,{farm:r});case 19:if(u=a.sent,!o.callbackAction){a.next=25;break}if(p=m.a.get(t,o.callbackAction)){a.next=24;break}throw"callbackAction: ".concat(o.callbackAction," does not exist.");case 24:p({id:u});case 25:case"end":return a.stop()}var f}),a)})))()},onNameChange:function(e,a){var n=e.state,t=a.name;n.view.Modals.NewFarm.name=t},onCancel:function(e){e.actions.view.Modals.NewFarm.close()},onSave:function(e){return Object(b.a)(h.a.mark((function a(){var n,t;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=n.view.Modals.NewFarm,a.next=4,t.saveFarm();case 4:t.close();case 5:case"end":return a.stop()}}),a)})))()}},we=Object(k.a)({SaveField:re,NewOperation:de,NewFarm:ge},X),he=Object(k.a)({SaveField:ie,NewOperation:ue,NewFarm:ve},H),be={onMyLocationClick:function(e,a){var n=e.actions;if(a){var t=a.latitude,o=a.longitude;n.view.Map.zoomTo({latitude:t,longitude:o,zoom:15})}},onLocationChange:function(e,a){var n=e.state;if(a){var t=a.latitude,o=a.longitude;console.log("onLocationChange",a),null!=t&&null!=o&&(n.view.Map.location={latitude:t,longitude:o})}},onAddField:function(e){e.actions.view.Map.BoundaryDrawing.onStartDrawing()},onSaveField:function(e){e.actions.view.Modals.SaveField.open()},onCancelField:function(e){var a=e.state,n=e.actions;a.view.Map.editingField=null,n.view.Map.BoundaryDrawing.onStopDrawing()},onEditField:function(e){var a=e.actions,n=e.state,t=n.view.FieldDetails.field;n.view.Map.editingField=n.view.FieldDetails.fieldId;var o={},r=m.a.get(t,"boundary.coordinates.0");r.length>0&&r.pop(),m.a.forEach(r||[],(function(e){o[C()()]=[e[1],e[0]]})),a.view.Map.BoundaryDrawing.onStartDrawing({boundary:o}),a.view.Map.unselectField()},onResetCache:function(e){return Object(b.a)(h.a.mark((function a(){var n;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,a.next=3,n.app.oada.resetCache();case 3:case"end":return a.stop()}}),a)})))()},onLogout:function(e){return Object(b.a)(h.a.mark((function a(){var n;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,a.next=3,n.view.Login.logout();case 3:case"end":return a.stop()}}),a)})))()}},ke={open:!1,selected:null,search:"",list:function(e,a){var n=e.selected,t=e.operations,o=m.a.get(a,"view.TopBar.OperationDropdown.search");return m.a.omitBy(m.a.mapValues(t,(function(e,a){var t=e.name;return null==a||null==t||""!=o&&-1==t.search(o)?null:{text:t,value:a,selected:n==a,label:{color:"green",empty:!0,circular:!0}}})),m.a.isEmpty)},operations:function(e,a){Object(A.a)(e);var n=null;if(1==m.a.get(a,"app.OADAManager.connected")){var t=m.a.get(a,"app.OADAManager.currentConnection");n=m.a.omitBy(m.a.get(a,"app.oada.".concat(t,".bookmarks.seasons.2020.operations"))||{},(function(e,a){return m.a.startsWith(a,"_")}))}else n=m.a.get(a,"app.localData.abc123.seasons.2020.operations");return n},selectedOperationId:function(e,a){var n=e.selected,t=e.operations,o=n;return null==o&&m.a.keys(t).length>0&&(o=m.a.keys(t)[0]),o},selectedOperation:function(e,a){var n=e.selectedOperationId;return e.operations[n]}},ye={onAdd:function(e){var a=e.state,n=e.actions;return a.view.TopBar.OperationDropdown.open=!1,n.view.Modals.NewOperation.open()},onChange:function(e,a){var n=e.state,t=a.id,o=n.view.TopBar.OperationDropdown;o.selected=t,o.open=!1},onOpenChange:function(e,a){var n=e.state,t=a.open;n.view.TopBar.OperationDropdown.open=t},onSearch:function(e,a){var n=e.state,t=a.search;n.view.TopBar.OperationDropdown.search=t}},Oe=Object(k.a)({OperationDropdown:ke},{}),De=Object(k.a)({OperationDropdown:ye},be),Ae=Object(k.a)({Login:O,FieldDetails:j,FieldList:_,Map:P,Modals:we,TopBar:Oe},{}),Fe=Object(k.a)({Login:D,FieldDetails:I,FieldList:N,Map:Y,Modals:he,TopBar:De},{}),Ee=function(){var e=Object(b.a)(h.a.mark((function e(a){var n;return h.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=a.actions,e.next=3,n.app.onInitialize();case 3:return e.next=5,n.view.Login.onInitialize();case 5:case"end":return e.stop()}}),e)})));return function(a){return e.apply(this,arguments)}}(),Me={"42f60b10-784c-11ea-8dfd-a3e960f56105":{name:"1004 G-N",boundary:{type:"Polygon",coordinates:[[[-84.97584700584412,41.4628134964027],[-84.97539639472963,41.462765256171906],[-84.97495651245119,41.46275721612994],[-84.97424840927125,41.46250797433487],[-84.97405529022217,41.46203360827181],[-84.97410893440247,41.46044164256161],[-84.97139453887941,41.46130195211675],[-84.96770381927492,41.46327177680542],[-84.97010707855226,41.46330393671208],[-84.9764907360077,41.46306273702346],[-84.97634053230287,41.45965368547904],[-84.97462391853334,41.46024867436535],[-84.9746346473694,41.461004463187685],[-84.97491359710695,41.46126175098986],[-84.97492432594301,41.46172004235903],[-84.97529983520509,41.46208988917259],[-84.97581481933594,41.46234717266838],[-84.9761688709259,41.46278133625282]]]},farm:{id:"42f08cd0-784c-11ea-8dfd-a3e960f56105"}},"7c0ce950-784c-11ea-bfa5-97fea4f9bfd9":{name:"1001 HO-N",boundary:{type:"Polygon",coordinates:[[[-84.97347593307495,41.44864540647965],[-84.97626543045044,41.44856498851091],[-84.97617959976196,41.44784122230691],[-84.977445602417,41.44782513852177],[-84.97759580612183,41.44862932289387],[-84.97886180877687,41.448532821295515],[-84.97866868972778,41.44205080201176],[-84.97654438018799,41.442887227983185],[-84.97549295425415,41.44425443952937],[-84.97323989868165,41.44608806625952],[-84.97272491455078,41.44689227216232],[-84.97330427169801,41.44726220353039]]]},farm:{id:"42f08cd0-784c-11ea-8dfd-a3e960f56105"}},"8ab27420-784c-11ea-bfa5-97fea4f9bfd9":{name:"1002 HO-S",boundary:{type:"Polygon",coordinates:[[[-84.97152328491212,41.44697269220437],[-84.97148036956789,41.44166475561947],[-84.97152328491212,41.44111785263252],[-84.97347593307495,41.441085681725035],[-84.97373342514038,41.44073180069027],[-84.97635126113893,41.44053877385792],[-84.97645854949953,41.44134304853828],[-84.97607231140138,41.44161649965898],[-84.97611522674562,41.44240467585386],[-84.97540712356569,41.44398099952468]]]},farm:{id:"42f08cd0-784c-11ea-8dfd-a3e960f56105"}}},xe={"42f08cd0-784c-11ea-8dfd-a3e960f56105":{name:"Bowman and Bowman"},"52f08cd0-784c-11ea-8dfd-a3e960f56105":{name:"Martz Farms"}},Ce={acresStatus:function(e,a){Object(A.a)(e);var n=a.app.operationFields,t=a.app.seasonFields,o=0,r=0,i=0;m.a.forEach(n,(function(e,a){if(null!=e){var n=t[a];if(null!=n){var c=247105e-9*E.a.geometry(n.boundary);"planned"==e.status?o+=c:"started"==e.status?r+=c:"done"==e.status&&(i+=c)}}}));var c=o+r+i;return{planned:Math.round(o),plannedPercentage:Math.round(o/(c||1)*100),started:Math.round(r),startedPercentage:Math.round(r/(c||1)*100),done:Math.round(i),donePercentage:Math.round(i/(c||1)*100)}},seasonFarms:function(e,a){var n;if(Object(A.a)(e),1==m.a.get(a,"app.OADAManager.connected")){var t=m.a.get(a,"app.OADAManager.currentConnection");n=m.a.chain(a).get("app.oada.".concat(t,".bookmarks.seasons.2020.farms")).omitBy((function(e,a){return!!m.a.startsWith(a,"_")||(null==e||void 0)})).value()}else n=m.a.get(a,"app.localData.abc123.seasons.2020.farms");return n||{}},seasonFields:function(e,a){var n;if(Object(A.a)(e),1==m.a.get(a,"app.OADAManager.connected")){var t=m.a.get(a,"app.OADAManager.currentConnection");n=m.a.chain(a).get("app.oada.".concat(t,".bookmarks.seasons.2020.fields")).omitBy((function(e,a){return!!m.a.startsWith(a,"_")||(null==e||void 0)})).value()}else n=m.a.get(a,"app.localData.abc123.seasons.2020.fields");return n||{}},operationFields:function(e,a){Object(A.a)(e);var n=m.a.get(a,"view.TopBar.OperationDropdown.selectedOperationId"),t=[];if(null!=n)if(1==m.a.get(a,"app.OADAManager.connected")){var o=m.a.get(a,"app.OADAManager.currentConnection");t=m.a.get(a,"app.oada.".concat(o,".bookmarks.seasons.2020.operations.").concat(n,".fields"))||[]}else t=m.a.get(a,"app.localData.abc123.seasons.2020.operations.".concat(n,".fields"))||[];return t},currentOADA:function(e,a){if(Object(A.a)(e),a.app.OADAManager.connected){var n=a.app.OADAManager.currentConnection;if(!n)return;return a.app.oada[n]}},oadaOrgData:function(e){var a=e.currentOADA;if(a)return a.bookmarks},oadaSeasonFarmsIdBy_id:function(e,a){var n=e.oadaOrgData;return m.a.chain(n).get("seasons.2020.farms").mapValues((function(e,a){return e?{_id:e._id,id:a}:null})).omitBy(m.a.isNull).mapKeys((function(e,a){return e._id})).value()},oadaSeasonFarms_idByFarm_id:function(e,a){var n=e.oadaOrgData;return m.a.chain(n).get("fields.farms").mapValues((function(e,a){return e?{seasonFarm_id:m.a.get(n,"seasons.2020.farms.".concat(a,"._id")),farm_id:e._id}:null})).omitBy(m.a.isNull).mapKeys((function(e,a){return e.farm_id})).value()},localOrgData:function(e){return e.localData.abc123},localData:{organizations:{abc123:{name:"Default"}},abc123:{fields:{fields:Object(k.a)({},Me),farms:Object(k.a)({},xe)},seasons:{2020:{fields:Object(k.a)({},Me),farms:Object(k.a)({},xe),operations:{}}}}}},Se={getSeasonField:function(e,a){var n=e.state,t=[];if(1==m.a.get(n,"app.OADAManager.connected")){var o=m.a.get(n,"app.OADAManager.currentConnection");t=m.a.get(n,"app.oada.".concat(o,".bookmarks.seasons.2020.fields"))}else t=m.a.get(n,"app.localData.abc123.seasons.2020.fields");return t[a]},getSeasonFarm:function(e,a){var n=e.state,t=[];if(1==m.a.get(n,"app.OADAManager.connected")){var o=m.a.get(n,"app.OADAManager.currentConnection");t=m.a.get(n,"app.oada.".concat(o,".bookmarks.seasons.2020.farms"))}else t=m.a.get(n,"app.localData.abc123.seasons.2020.farms");return t[a]},onInitialize:function(e){e.state;e.actions.view.Map.zoomBounds()}},je={connected:!1,currentConnection:null,domain:null,token:null,user:function(e,a){return e.currentConnection?m.a.get(a,"app.oada.localhost.users.me"):null}},Ie=n(531),_e=B.a.promisify(Ie.browser.getAccessToken),Ne=je,Te={getToken:function(e,a){return Object(b.a)(h.a.mark((function n(){var t,o,r;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,!(o=t.app.OADAManager).token){n.next=4;break}return n.abrupt("return",o.token);case 4:return n.next=6,_e(a.replace(/^https?:\/\//,""),{metadata:y.METADATA,scope:y.SCOPE,redirect:y.REDIRECT});case 6:return r=n.sent,n.abrupt("return",r.access_token);case 8:case"end":return n.stop()}}),n)})))()},connect:function(e,a){return Object(b.a)(h.a.mark((function n(){var t,o,r,i,c,s;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.actions,o=e.state,e.effects,r=a.domain,i=a.token,c=o.app.OADAManager,s=t.app.OADAManager,i&&(c.token=i),n.next=7,s.getToken(r);case 7:return i=n.sent,n.abrupt("return",t.app.oada.connect({token:i,domain:r,options:y.OPTIONS,cache:!1}).then((function(e){return e.error||(c.currentConnection=e.connectionId,c.token=e.token,c.connected=!0,o.view.TopBar.OperationDropdown.selected=null),e})));case 9:case"end":return n.stop()}}),n)})))()},logout:function(e){return Object(b.a)(h.a.mark((function a(){var n,t,o,r;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=e.state,o=t.app.OADAManager,r=o.currentConnection,o.token=null,a.next=6,n.app.oada.disconnect({connection_id:r});case 6:case"end":return a.stop()}}),a)})))()},getUserInfo:function(e){return Object(b.a)(h.a.mark((function a(){var n,t,o,r,i;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=e.state,o=t.app.OADAManager,r=o.currentConnection,i=[{path:"/users/me"}],a.next=6,n.app.oada.get({requests:i,connection_id:r});case 6:case"end":return a.stop()}}),a)})))()},fetchAndWatch:function(e){return Object(b.a)(h.a.mark((function a(){var n,t,o,r,i,c,s,l,d;return h.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return n=e.actions,t=e.state,o=t.app.OADAManager,r=o.currentConnection,i=[{path:"/bookmarks/fields",tree:S,watch:{actions:[n.app.OADAManager.onFieldChanged]}},{path:"/bookmarks/seasons",tree:S,watch:{actions:[]}}],a.next=6,n.app.oada.get({requests:i,connection_id:r});case 6:if(c=a.sent,s=[],console.log("SOMETIMES ERRORS:",c),!c.responses[0].error){a.next=16;break}if(404==c.responses[0].status){a.next=12;break}throw c.responses[0].error;case 12:return l=[{tree:S,data:{fields:{},farms:{}},path:"/bookmarks/fields"}],a.next=15,n.app.oada.put({requests:l,connection_id:r});case 15:s.push(i[0]);case 16:if(!c.responses[1].error){a.next=23;break}if(404==c.responses[1].status){a.next=19;break}throw c.responses[0].error;case 19:return d=[{tree:S,data:{},path:"/bookmarks/seasons"}],a.next=22,n.app.oada.put({requests:d,connection_id:r});case 22:s.push(i[1]);case 23:if(!(s.length>0)){a.next=26;break}return a.next=26,n.app.oada.get({requests:s,connection_id:r});case 26:case"end":return a.stop()}}),a)})))()},initSeasonFields:function(e){var a=e.state,n=e.actions.app.OADAManager,t=[];return m.a.forEach(m.a.get(a,"app.oadaOrgData.fields.fields"),(function(e,a){m.a.startsWith(a,"_")||t.push({fieldId:a,name:e.name,boundary:e.boundary,farm:e.farm})})),n.changeSeasonFields(t)},initSeasonFarms:function(e){var a=e.state,n=e.actions.app.OADAManager,t=[];return m.a.forEach(m.a.get(a,"app.oadaOrgData.fields.farms"),(function(e,a){m.a.startsWith(a,"_")||t.push({farmId:a,name:e.name})})),n.changeSeasonFarms(t)},changeSeasonFields:function(e,a){return Object(b.a)(h.a.mark((function n(){var t,o,r,i,c,s;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,o=e.actions,r=t.app.OADAManager,i=r.currentConnection,c=[],s=t.app.seasonFields,m.a.forEach(a,(function(e){if(null!=e.fieldId){var a={},n=s[e.fieldId];if(e.name&&(null!=n&&n.name==e.name||(a.name=e.name)),e.boundary&&(null!=n&&0!=m.a.isEqual(n.boundary,e.boundary)||(a.boundary=e.boundary)),e.farm){var o=m.a.get(e,"farm._id");if(o){var r=m.a.get(t,"app.oadaSeasonFarms_idByFarm_id.".concat(o,".seasonFarm_id"));r?(null==n||null==n.farm||null==n.farm._id||null!=r&&n.farm._id!=r)&&(a.farm=m.a.merge({},a.farm,{_id:r})):console.log("No matching season farm found for farmId:",o,"Cannot check if season fields farm has changed. Data:",e)}}m.a.isEmpty(a)||c.push({tree:S,data:a,type:"application/vnd.oada.field.1+json",path:"/bookmarks/seasons/2020/fields/".concat(e.fieldId)})}})),0!=c.length){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,o.app.oada.put({requests:c,connection_id:i});case 10:case"end":return n.stop()}}),n)})))()},changeSeasonFarms:function(e,a){return Object(b.a)(h.a.mark((function n(){var t,o,r,i,c,s;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,o=e.actions,r=t.app.OADAManager,i=r.currentConnection,c=[],s=t.app.seasonFarms,m.a.forEach(a,(function(e){if(null!=e.farmId){var a={},n=s[e.farmId];e.name&&(null!=n&&n.name==e.name||(a.name=e.name)),m.a.isEmpty(a)||c.push({tree:S,data:a,type:"application/vnd.oada.farm.1+json",path:"/bookmarks/seasons/2020/farms/".concat(e.farmId)})}})),0!=c.length){n.next=8;break}return n.abrupt("return");case 8:return n.next=10,o.app.oada.put({requests:c,connection_id:i});case 10:case"end":return n.stop()}}),n)})))()},deleteSeasonFields:function(e,a){return Object(b.a)(h.a.mark((function n(){var t,o,r,i,c,s;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,o=e.actions,console.log("delete season fields",a),r=t.app.OADAManager,i=r.currentConnection,c=[],s=t.app.seasonFields,m.a.forEach(a,(function(e){s[e]&&c.push({tree:S,type:"application/vnd.oada.field.1+json",path:"/bookmarks/seasons/2020/fields/".concat(e)})})),0!=c.length){n.next=9;break}return n.abrupt("return");case 9:return n.next=11,o.app.oada.delete({requests:c,connection_id:i});case 11:case"end":return n.stop()}}),n)})))()},deleteSeasonFarms:function(e,a){return Object(b.a)(h.a.mark((function n(){var t,o,r,i,c,s;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,o=e.actions,console.log("delete season farms",a),r=t.app.OADAManager,i=r.currentConnection,c=[],s=t.app.seasonFarms,m.a.forEach(a,(function(e){s[e]&&c.push({tree:S,type:"application/vnd.oada.farm.1+json",path:"/bookmarks/seasons/2020/farms/".concat(e)})})),0!=c.length){n.next=9;break}return n.abrupt("return");case 9:return n.next=11,o.app.oada.delete({requests:c,connection_id:i});case 11:case"end":return n.stop()}}),n)})))()},login:function(e,a){return Object(b.a)(h.a.mark((function n(){var t,o,r,i,c,s,l;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return t=e.actions,o=e.state,r=a.domain,i=a.token,c=o.app.OADAManager,s=t.app.OADAManager,c.domain=r,n.next=7,s.connect({domain:r,token:i});case 7:if(l=n.sent,l.error){n.next=20;break}return n.next=12,s.getUserInfo();case 12:return n.next=14,s.fetchAndWatch();case 14:return n.next=16,s.initSeasonFarms();case 16:return n.next=18,s.initSeasonFields();case 18:return n.next=20,t.view.Map.zoomBounds();case 20:case"end":return n.stop()}}),n)})))()},onFieldChanged:function(e,a){return Object(b.a)(h.a.mark((function n(){var t,o,r,i,c,s,l,d,u;return h.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(t=e.state,o=e.actions,console.log("onFieldChanged",a),r=o.app.OADAManager,i=m.a.get(a,"response.change")||[],m.a.isArray(i)){n.next=7;break}return console.warn("WARNING: response.change not an array"),n.abrupt("return");case 7:c=a.path&&a.path.length>0?"".concat(a.connection_id,".").concat(a.path):a.connection_id,s=[],l=[],d=[],u=[],m.a.forEach(i,(function(e){if("merge"==e.type){var n=e.path.split("/"),o=n.join(".");m.a.get(t,"".concat(c).concat(o));if("fields"==m.a.get(n,1)){var r=m.a.get(n,2);if(null==r&&null!=m.a.get(e,"body"))return void console.log("WARNING: Received a bad field change from OADA",a);var i=m.a.get(e,"body"),p=i.name,f=i.boundary;s.push(m.a.pickBy({fieldId:r,name:p,boundary:f},(function(e){return!m.a.isUndefined(e)})))}else if("farms"==m.a.get(n,1)){var g=m.a.get(n,2);if(null==g&&null!=m.a.get(e,"body"))return void console.log("WARNING: Received a bad farm change from OADA",a);var v=m.a.get(e,"body").name;d.push(m.a.pickBy({farmId:g,name:v},(function(e){return!m.a.isUndefined(e)})))}}else if("delete"==e.type){var w=e.path.split("/").join(".");m.a.get(t,"".concat(c).concat(w));m.a.forEach(m.a.get(e,"body.fields"),(function(e,a){null==e&&l.push(a)})),m.a.forEach(m.a.get(e,"body.farms"),(function(e,a){null==e&&u.push(a)}))}else console.warn("Unrecognized change type",e.type)})),l.length>0&&r.deleteSeasonFields(l),s.length>0&&r.changeSeasonFields(s),u.length>0&&r.deleteSeasonFarms(u),d.length>0&&r.changeSeasonFarms(d);case 17:case"end":return n.stop()}}),n)})))()},onSeasonsChanged:function(e,a){e.state,e.actions}},Re=n(532),Be=n.n(Re)()("app.oada"),Ze=Object(k.a)({oada:Be.state,OADAManager:Ne},Ce),We=Object(k.a)({oada:Be.actions,OADAManager:Te},Se),Le={oada:Be.effects},ze=Object(v.a)({view:t,app:o}),Ve=Object(g.b)(),Je=n(1086),Ue=n(1066),Ge=n(1024);function Pe(){var e=Object(u.a)(["\n        position: absolute;\n        top: 10px;\n        right: 10px;\n        font-size: 1.2em;\n        color: #FFFFFF;\n        cursor: pointer;\n      "]);return Pe=function(){return e},e}function Ye(){var e=Object(u.a)(["\n          display: flex;\n          flex-direction: column;\n        "]);return Ye=function(){return e},e}function Xe(){var e=Object(u.a)(["\n        width: 400px;\n        display: flex;\n        flex-direction: column;\n        background: #fff;\n        padding: 15px;\n        padding-top: 7px;\n        border-radius: 5px;\n      "]);return Xe=function(){return e},e}function He(){var e=Object(u.a)(["\n      height: 100vh;\n      width: 100vw;\n      display: flex;\n      flex-direction: column;\n      justify-content: center;\n      align-items: center;\n      background: url(imgs/login-background.jpg) no-repeat center center fixed;\n      background-size: cover;\n    "]);return He=function(){return e},e}var qe=function(){var e=Ve(),a=e.state,n=e.actions,t=a.view.Login,o=n.view.Login;return Object(p.b)("div",{css:Object(p.a)(He())},Object(p.b)("div",{css:Object(p.a)(Xe())},Object(p.b)("img",{css:{height:300},src:"imgs/logo2.svg",alt:"logo"}),Object(p.b)(Je.a,{css:Object(p.a)(Ye()),onSubmit:o.login},Object(p.b)(Ue.a,{placeholder:"OADA Domain...",value:t.domain,onChange:function(e,a){return o.domainChange(a)}}),Object(p.b)(Ge.a,{style:{marginTop:7},primary:!0,loading:t.loading,disabled:t.loading},"Connect to Your OADA Cloud"),Object(p.b)(Ge.a,{style:{marginTop:7},onClick:o.viewDemo,disabled:t.loading},"View Demo"))),Object(p.b)("a",{css:Object(p.a)(Pe()),onClick:o.logout},"Logout"))},Qe=n(1094),Ke=n(1095),$e=(n(960),n(1067)),ea=n(1068),aa=n(1069);function na(){var e=Ve(),a=e.state,n=e.actions,t=a.view.Map.BoundaryDrawing,o=n.view.Map.BoundaryDrawing,r=t.boundary,c=t.drawing,s=o.onMarkerMove;return c?i.a.createElement($e.a,null,i.a.createElement(ea.a,{positions:m.a.map(r)}),m.a.map(r,(function(e,a){return i.a.createElement(aa.a,{position:e,key:a,draggable:!0,onMove:function(e){var n=e.latlng,t=e.oldLatLng;return s({latlng:n,oldLatLng:t,id:a})}})}))):null}var ta=n(1070);function oa(){var e=Ve(),a=e.state,n=e.actions,t=a.view.Map,o=n.view.Map,r=t.fields,c=o.onFieldClick;return 0==m.a.keys(r).length?null:i.a.createElement($e.a,null,m.a.map(r,(function(e,a){return i.a.createElement(ta.a,{bubblingMouseEvents:!1,style:e.style,data:e.boundary,key:C()(),onClick:function(e){c({id:a})}})})))}function ra(){var e=Ve(),a=e.actions,n=e.state,t=a.view.Map,o=n.view.Map;return i.a.createElement(Qe.a,{bounds:o.bounds,center:o.center,zoom:o.zoom,onClick:function(e){return t.onMapClick(Object(k.a)({},e.latlng))},zoomControl:!1},i.a.createElement(Ke.a,{url:"https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",attribution:"Tiles \xa9 Esri \u2014 Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"}),i.a.createElement(Ke.a,{url:"https://stamen-tiles-{s}.a.ssl.fastly.net/toner-labels/{z}/{x}/{y}{r}.png",minZoom:0,maxZoom:20,attribution:""}),i.a.createElement(na,null),i.a.createElement(oa,null))}var ia=n(1079),ca=n(1074),sa=n(1071),la=n(1075);function da(){var e=Ve().actions.view.TopBar;return i.a.createElement(sa.a,null,i.a.createElement(ca.a,{style:{flex:1}}),i.a.createElement(la.a,{color:"inherit",onClick:function(){return e.onCancelField()}},"Cancel"),i.a.createElement(la.a,{color:"inherit",onClick:function(){return e.onSaveField()}},"Save"))}var ua=n(1090);function pa(e){var a=e.style,n=Ve(),t=n.actions,o=n.state,r=t.view.TopBar.OperationDropdown,c=o.view.TopBar.OperationDropdown,s=c.selectedOperation,l=c.list,d=c.open,u=c.search,p=r.onAdd,f=r.onChange,g=r.onOpenChange,v=r.onSearch;return i.a.createElement(ca.a,{style:a},i.a.createElement(ca.a,{style:{flexDirection:"row"}},s?i.a.createElement(ua.a,{open:d,onOpen:function(){g({open:!0})},onBlur:function(){g({open:!1})},text:s.name,icon:"cog",floating:!0,labeled:!0,button:!0,className:"icon"},i.a.createElement(ua.a.Menu,{style:{top:42}},i.a.createElement(ua.a.Item,{style:{textAlign:"center"},text:"Add New Operation",value:"Add New Operation",onClick:function(e,a){p()}}),i.a.createElement(Ue.a,{icon:"search",iconPosition:"left",className:"search",style:{marginTop:3},value:u,onChange:function(e){v({search:e.target.value})}}),i.a.createElement(ua.a.Menu,{scrolling:!0},m.a.map(l,(function(e){return i.a.createElement(ua.a.Item,Object.assign({key:e.value},e,{onClick:function(e,a){f({id:a.value})}}))}))))):i.a.createElement(ua.a,{onClick:function(){p()},open:!1,text:"Add New Operation",icon:"cog",floating:!0,labeled:!0,button:!0,className:"icon"}),i.a.createElement(ca.a,{style:{flex:1}})))}var fa=n(149),ma=n(1076),ga=n(562),va=n.n(ga),wa=n(1093),ha=n(1078);function ba(e){var a=e.style,n=Ve(),t=n.actions,o=n.state,r=t.view.TopBar,c=i.a.useState(null),s=Object(fa.a)(c,2),l=s[0],d=s[1];function u(){d(null)}return i.a.createElement(ca.a,{style:a},i.a.createElement(ma.a,{edge:"end",color:"inherit","aria-label":"Menu",onClick:function(e){d(e.currentTarget)}},i.a.createElement(va.a,null)),i.a.createElement(wa.a,{style:{top:50,right:5},open:Boolean(l),keepMounted:!0,anchorEl:l,onClose:u},i.a.createElement(ha.a,{onClick:function(){u(),r.onAddField()}},"Add Field"),o.view.FieldDetails.open?i.a.createElement(ha.a,{onClick:function(){u(),r.onEditField()}},"Edit Field"):null,i.a.createElement(ha.a,{onClick:function(){u(),r.onLogout()}},"Logout")))}var ka=n(563),ya=n(564),Oa=n.n(ya);var Da=Object(ka.geolocated)({positionOptions:{enableHighAccuracy:!0},userDecisionTimeout:5e3})((function(e){var a=e.coords,n=(e.isGeolocationAvailable,e.isGeolocationEnabled,Ve().actions.view.TopBar);return Object(r.useEffect)((function(){n.onLocationChange(a)})),i.a.createElement(ca.a,null,i.a.createElement(ma.a,{edge:"end",color:"inherit","aria-label":"Menu",onClick:function(){n.onMyLocationClick(a)}},i.a.createElement(Oa.a,null)))}));function Aa(e){e.toggleTitle;return i.a.createElement(sa.a,null,i.a.createElement(pa,{style:{flex:1}}),i.a.createElement(Da,null),i.a.createElement(ba,null))}function Fa(){var e=Ve().state.view.Map.BoundaryDrawing.drawing;return i.a.createElement(ca.a,{style:{zIndex:1201}},i.a.createElement(ia.a,{position:"static"},e?i.a.createElement(da,null):i.a.createElement(Aa,null)))}var Ea=n(1092),Ma=n(1077),xa=n(1082),Ca=n(1023),Sa=n(1080),ja=n(1081),Ia=n(339),_a=n.n(Ia),Na=n(340),Ta=n.n(Na);function Ra(){return i.a.createElement(Ea.a,{open:!1,variant:"persistent"},i.a.createElement(ca.a,{style:{height:64}}),i.a.createElement("div",{style:{width:250},role:"presentation"},i.a.createElement(Ma.a,null,["Inbox","Starred","Send email"].map((function(e,a){return i.a.createElement(Ca.a,{button:!0,key:e},i.a.createElement(Sa.a,null,a%2===0?i.a.createElement(_a.a,null):i.a.createElement(Ta.a,null)),i.a.createElement(ja.a,{primary:e}))}))),i.a.createElement(xa.a,null),i.a.createElement(Ma.a,null,["All mail","Trash","Spam"].map((function(e,a){return i.a.createElement(Ca.a,{button:!0,key:e},i.a.createElement(Sa.a,null,a%2===0?i.a.createElement(_a.a,null):i.a.createElement(Ta.a,null)),i.a.createElement(ja.a,{primary:e}))})))))}var Ba=n(1088),Za=n(1084),Wa=n(1085),La=n(1096),za=n(1083);function Va(){var e=Ve(),a=e.state,n=e.actions,t=a.view.FieldDetails,o=n.view.FieldDetails,r=t.open,c=t.field,s=t.farm,l=t.showAddOperationButton,d=o.onStatusChange;o.onEditFieldClick,o.onAddNewOperationClick;return Boolean(c)||(r=!1,c={}),i.a.createElement(Ea.a,{anchor:"bottom",open:r,variant:"persistent"},i.a.createElement(ca.a,{style:{paddingBottom:20}},i.a.createElement(ca.a,{style:{flexDirection:"column",alignItems:"center"}},i.a.createElement(ca.a,{style:{justifyContent:"left",flexDirection:"row",alignItems:"center",marginTop:10}},i.a.createElement(za.a,{style:{fontWeight:"bold",fontSize:20}},c.name),i.a.createElement(za.a,{style:{marginLeft:7,fontSize:18}},"- ".concat(Math.round(c.acres)," ac"))),null==s?null:i.a.createElement(za.a,{style:{fontSize:15,color:"#999",marginTop:2,marginBottom:7}},s.name)),i.a.createElement(ca.a,{style:{justifyContent:"center",flexDirection:"row"}},l?i.a.createElement(Ge.a,{style:{marginTop:15},onClick:function(){return o.onAddNewOperationClick()}},"Add New Operation"):i.a.createElement(La.a,{component:"fieldset"},i.a.createElement(Za.a,{"aria-label":"position",name:"position",row:!0},i.a.createElement(Wa.a,{value:"bottom",control:i.a.createElement(Ba.a,{color:"primary",checked:"planned"==c.status||!1,onChange:function(){d({status:"planned"})}}),label:"Planned",labelPlacement:"bottom"}),i.a.createElement(Wa.a,{value:"bottom",control:i.a.createElement(Ba.a,{color:"primary",checked:"started"==c.status||!1,onChange:function(){d({status:"started"})}}),label:"Started",labelPlacement:"bottom"}),i.a.createElement(Wa.a,{value:"bottom",control:i.a.createElement(Ba.a,{color:"primary",checked:"done"==c.status||!1,onChange:function(){d({status:"done"})}}),label:"Done",labelPlacement:"bottom"}))))))}function Ja(e){var a=e.acresStatus;return i.a.createElement(ca.a,{style:{backgroundColor:"#c50003",paddingLeft:7,paddingRight:7,paddingTop:5,paddingBottom:5,borderRadius:5}},i.a.createElement(za.a,{style:{color:"white",textShadowColor:"#000",textShadowOffset:{width:1,height:1},textShadowRadius:2}},"".concat(a.planned," ac (").concat(a.plannedPercentage,"%)")))}function Ua(e){var a=e.acresStatus;return i.a.createElement(ca.a,{style:{backgroundColor:"#eeb705",paddingLeft:7,paddingRight:7,paddingTop:5,paddingBottom:5,borderRadius:5,marginRight:7,marginLeft:7}},i.a.createElement(za.a,{style:{color:"white",textShadowColor:"#000",textShadowOffset:{width:1,height:1},textShadowRadius:2}},"".concat(a.started," ac (").concat(a.startedPercentage,"%)")))}function Ga(e){var a=e.acresStatus;return i.a.createElement(ca.a,{style:{backgroundColor:"#5bb25f",paddingLeft:7,paddingRight:7,paddingTop:5,paddingBottom:5,borderRadius:5}},i.a.createElement(za.a,{style:{color:"white",textShadowColor:"#000",textShadowOffset:{width:1,height:1},textShadowRadius:2}},"".concat(a.done," ac (").concat(a.donePercentage,"%)")))}function Pa(){var e=Ve().state,a=e.app.acresStatus;return e.view.TopBar.OperationDropdown.selectedOperationId?i.a.createElement(ca.a,{style:{position:"absolute",display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",top:68,zIndex:401,width:"100vw"}},i.a.createElement(Ja,{acresStatus:a}),i.a.createElement(Ua,{acresStatus:a}),i.a.createElement(Ga,{acresStatus:a})):null}var Ya=n(1087),Xa=n(129);function Ha(){var e=Ve(),a=e.state,n=e.actions,t=a.view.Modals.SaveField,o=n.view.Modals.SaveField,r=(t.open,t.name),c=o.onNameChange,s=o.onCancel,l=o.onSave,d=i.a.useState(!1),u=Object(fa.a)(d,2),p=u[0],f=u[1],m=t.farm||{},g=t.farms;return i.a.createElement(Ya.a,{open:t.open,size:"tiny"},i.a.createElement(Ya.a.Header,null,a.view.Map.editingField?"Edit Field":"New Field"),i.a.createElement(Ya.a.Content,null,i.a.createElement(ca.a,{style:{flexDirection:"column",zIndex:1}},i.a.createElement(za.a,{style:{marginBottom:7}},"Field Name:"),i.a.createElement(Je.a,{onSubmit:function(){return l()}},i.a.createElement(Ue.a,{autoFocus:!0,placeholder:"Back 40",value:r,onChange:function(e){c({name:e.target.value})}})),i.a.createElement(za.a,{style:{marginBottom:7,marginTop:15}},"Farm:"),i.a.createElement(ua.a,{trigger:i.a.createElement(ca.a,{style:{paddingLeft:13,paddingRight:7,border:"1px solid rgba(34,36,38,.15)",borderRadius:".28571429rem",height:38,flexDirection:"row",alignItems:"center",justifyContent:"space-between"}},i.a.createElement(za.a,{style:{color:m.name?"rgba(0,0,0,.87)":"rgba(0,0,0,.25)"}},m.name||"Select a farm"),i.a.createElement(Xa.a,{name:"caret down",style:{paddingBottom:17}})),icon:null,onOpen:function(){f(!0)},onBlur:function(){f(!1)},open:p},i.a.createElement(ua.a.Menu,{style:{overflow:"hidden",maxHeight:"50vh"}},i.a.createElement(ua.a.Item,{style:{textAlign:"center"},text:"Add New Farm",value:"Add New Farm",onClick:function(e,a){o.onFarmAdd(),f(!1)}}),i.a.createElement(Ue.a,{icon:"search",iconPosition:"left",className:"search",value:t.farmSearch,onChange:function(e){o.onFarmSearchChange(e.target.value)}}),i.a.createElement(ua.a.Menu,{scrolling:!0},g.map((function(e){return i.a.createElement(ua.a.Item,Object.assign({key:e.value},e,{onClick:function(){o.onFarmChange({id:e.value}),f(!1)}}))}))))))),i.a.createElement(Ya.a.Actions,null,i.a.createElement(Ge.a,{negative:!0,onClick:function(){return s()}},"Cancel"),i.a.createElement(Ge.a,{positive:!0,icon:"checkmark",labelPosition:"right",content:"Save",onClick:function(){return l()}})))}function qa(){var e=Ve(),a=e.state,n=e.actions,t=a.view.Modals.OADADomain,o=n.view.Modals.OADADomain,r=t.open,c=t.domain,s=o.onDomainChange,l=o.onCancel,d=o.onConnect;return i.a.createElement(Ya.a,{open:r,size:"tiny"},i.a.createElement(Ya.a.Header,null,"Connect to OADA Server"),i.a.createElement(Ya.a.Content,null,i.a.createElement(za.a,null,"Domain:"),i.a.createElement(ca.a,{style:{flexDirection:"row"}},i.a.createElement(Ue.a,{style:{flex:1,marginTop:7},placeholder:"https://oada.openatk.com",value:c,onChange:function(e){s({domain:e.target.value})}}))),i.a.createElement(Ya.a.Actions,null,i.a.createElement(Ge.a,{negative:!0,onClick:function(){return l()}},"Cancel"),i.a.createElement(Ge.a,{positive:!0,icon:"checkmark",labelPosition:"right",content:"Connect",onClick:function(){return d({})}})))}function Qa(){var e=Ve(),a=e.state,n=e.actions,t=a.view.Modals.NewOperation,o=n.view.Modals.NewOperation,r=t.open,c=t.name,s=o.onNameChange,l=o.onCancel,d=o.onSave;return i.a.createElement(Ya.a,{open:r,size:"tiny"},i.a.createElement(Ya.a.Header,null,"New Operation"),i.a.createElement(Ya.a.Content,null,i.a.createElement(za.a,null,"Name:"),i.a.createElement(ca.a,{style:{flexDirection:"row"}},i.a.createElement(Je.a,{style:{flex:1},onSubmit:d},i.a.createElement(Ue.a,{autoFocus:!0,style:{width:"100%",marginTop:7},placeholder:"Corn Planting",value:c,onChange:function(e){s({name:e.target.value})}})))),i.a.createElement(Ya.a.Actions,null,i.a.createElement(Ge.a,{negative:!0,onClick:function(){return l()}},"Cancel"),i.a.createElement(Ge.a,{positive:!0,icon:"checkmark",labelPosition:"right",content:"Save",onClick:function(){return d()}})))}function Ka(){var e=Ve(),a=e.state,n=e.actions,t=a.view.Modals.NewFarm,o=n.view.Modals.NewFarm,r=t.open,c=t.name,s=o.onNameChange,l=o.onCancel,d=o.onSave;return i.a.createElement(Ya.a,{open:r,size:"tiny"},i.a.createElement(Ya.a.Header,null,"New Farm"),i.a.createElement(Ya.a.Content,null,i.a.createElement(za.a,null,"Name:"),i.a.createElement(ca.a,{style:{flexDirection:"row"}},i.a.createElement(Ue.a,{style:{flex:1,marginTop:7},placeholder:"Bowman Farms",value:c,onChange:function(e){s({name:e.target.value})}}))),i.a.createElement(Ya.a.Actions,null,i.a.createElement(Ge.a,{negative:!0,onClick:function(){return l()}},"Cancel"),i.a.createElement(Ge.a,{positive:!0,icon:"checkmark",labelPosition:"right",content:"Save",onClick:function(){return d()}})))}var $a=function(){return Ve().state.view.Login.loggedIn?i.a.createElement("div",{className:"App"},i.a.createElement(Fa,null),i.a.createElement(Pa,null),i.a.createElement(ra,null),i.a.createElement(Ra,null),i.a.createElement(Va,null),i.a.createElement(Ha,null),i.a.createElement(qa,null),i.a.createElement(Qa,null),i.a.createElement(Ka,null)):i.a.createElement(qe,null)},en=Object(J.c)(ze,{devtools:!0});s.a.render(i.a.createElement(g.a,{value:en},i.a.createElement($a,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},260:function(e,a,n){"use strict";(function(a){console.log("using linked oada-id-client 1");var t=n(116),o=n(196),r=n(83),i=n(153),c=n(406).jwksutils,s=n(168).jwk2pem,l=n(157),d=n(443),u=n(449),p={},f={},m={};function g(){var e,a=Array.prototype.concat.apply([{}],arguments);e=r.apply(null,a);var n=a.filter((function(e){return e&&e.hasOwnProperty("params")})).map((function(e){return e.params}));return n.length&&(e.params=r.apply(null,n)),e.scope=a.map((function(e){return e&&e.scope&&e.scope.split(" ")||[]})).reduce((function(e,a){return e.concat(a)})).filter((function(e,a,n){return n.indexOf(e)===a})).join(" "),e}function v(e,a){if(p.retrieveState!==w)return a(new Error("Overrode retrieveState but not storeState!"));var n=l.randomBytes(16);return n=n.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),m[n]=e,a(null,n)}function w(e,a){if(console.log("retrieveState 1"),p.storeState!==v)return console.log("retrieveState error"),a(new Error("Overrode storeState but not retrieveState!"));console.log("retrieveState stuff",m);var n=m[e];return console.log("retrieveState stateObj",n),delete m[e],a(null,n)}function h(e,a,n,i,c){var s,l,d,f=g({},f,n);s=f.privateKey,l=r(f.params,{scope:f.scope}),d=f.metadata,s&&(s.kty=s.kty||"PEM");var m=b(i,c);console.log("before get");var v=t.get("https://"+e+"/.well-known/"+a);console.log("after get 1"),v.buffer&&(console.log("after get 2"),v.buffer()),console.log("after get 3"),v.end((function(a,n){console.log("after get 4");var t=a||n.error;if(t)return console.log("error",t),m(t);console.log("after get 5");try{console.log("before parse");var r=JSON.parse(n.text);console.log("before register"),u(d,r.registration_endpoint,(function(a,n){if(console.log("registrationCallback"),a)return console.log("registrationCallback error",a),m(a);l.redirect_uri=f.redirect||n.redirect_uris[0];var t={key:s,domain:e,conf:r,callback:c,options:n,query:l};console.log("before storeState"),p.storeState(t,(function(e,a){console.log("storeState callback");var t=new o(r.authorization_endpoint);return t.addQuery({state:a}).addQuery(l).addQuery({client_id:n.client_id}),t.removeQuery("client_secret"),console.log("before redirect"),console.log("redirect",i),i(e,t&&t.toString())}))}))}catch(a){return console.log("here here"),console.log("err2",a),m(a)}}))}function b(){var e=arguments;return function(a,n){for(var t=0;t<e.length;t++)"function"===typeof e[t]&&e[t](a,n)}}function k(e,a,n){if(console.log("verifyIDToken 1"),!a||!a.id_token)return console.log("verifyIDToken 2"),n(null,a);var t=r({},a);return console.log("verifyIDToken 3"),c.jwkForSignature(t.id_token,e.conf.jwks_uri,(function(a,o){if(console.log("verifyIDToken 4"),a)return console.log("verifyIDToken 5"),console.log("verifyIDToken 5",a),n(a);console.log("verifyIDToken 6");var r=s(o);console.log("verifyIDToken 7");var c={audience:e.options.client_id,issuer:e.conf.issuer};console.log("verifyIDToken 8"),i.verify(t.id_token,r,c,(function(a,o){return console.log("verifyIDToken 9"),a||(console.log("verifyIDToken 10"),e.query.nonce===o.nonce?t.id_token=o:a=new Error("Nonces did not match")),console.log("verifyIDToken 10"),n(a,t)}))}))}p.init=function(e){f=g(f,e)},p.storeState=v,p.retrieveState=w,p.getIDToken=function(e,n,t,o){var r=g({scope:"openid",params:{response_type:a.browser?"id_token":"code"}},n);r.params.nonce=l.randomBytes(12).toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,""),h(e,"openid-configuration",r,t,(function(e,a){return o&&o(e,a&&a.id_token)}))},p.getAccessToken=function(e,n,t,o){console.log("getAccessToken 1");var r=a.browser?"token":"code";console.log("getAccessToken 2"),h(e,"oada-configuration",g({scope:"",params:{response_type:r}},n),t,o),console.log("getAccessToken 3")},p.handleRedirect=function(e,a){console.log("core handleRedirect");var n=e.state,o=r({},e);delete o.state,console.log("core handleRedirect 1"),console.log("core handleRedirect stateTok",n),p.retrieveState(n,(function(e,n){console.log("err",e),console.log("stateObj",n),console.log("core handleRedirect 2");var r=b(n&&n.callback,a);console.log("core handleRedirect 3"),n?(console.log("core handleRedirect exchangeCode"),function(e,a,n){if(console.log("exchangeCode 1"),!a.code)return console.log("exchangeCode 1a"),k(e,a,n);console.log("exchangeCode 1b");var o=d.generate(e.key,e.options.client_id,e.options.client_id,e.conf.token_endpoint,60,{payload:{jti:a.code}});console.log("exchangeCode 2");var r={grant_type:"authorization_code",redirect_uri:e.query.redirect_uri,client_assertion:o,client_assertion_type:"urn:ietf:params:oauth:client-assertion-type:jwt-bearer",client_id:e.options.client_id,code:a.code};console.log("before post"),t.post(e.conf.token_endpoint).type("form").send(r).end((function(a,t){console.log("after post");var o,r=a||t.error;if(r)return n(r);try{o=JSON.parse(t.text)}catch(a){return n(a)}console.log("after post before verifyIDToken"),k(e,o,n)}))}(n,o,r)):(console.log("core handleRedirect cb"),console.log("core handleRedirect cb2",a),console.log("core handleRedirect cb3",o),n&&console.log("core handleRedirect cb4",n.callback),r("Spurrious redirect received",o))}))},e.exports=p}).call(this,n(27))},279:function(e,a){},531:function(e,a,n){(function(a){e.exports=n(260),e.exports.browser=n(796),"undefined"!==typeof a&&"undefined"===typeof window&&(e.exports.node=n(797)),e.exports.middleware=n(806)}).call(this,n(27))},592:function(e,a,n){e.exports=n(1020)},597:function(e,a,n){},598:function(e,a,n){e.exports=n.p+"static/media/logo.5d5d9eef.svg"},599:function(e,a,n){},614:function(e,a){},616:function(e,a){},649:function(e,a){},650:function(e,a){},719:function(e,a){},796:function(e,a,n){"use strict";var t=n(196),o=n(83),r=n(260),i={};function c(e,a){return function(n,t,i){var c=o({display:"popup"},a,t);window._oadaIdClientPopUpFunction=r.handleRedirect,console.log("before authFun"),e(n,c,(function(e,a){if(console.log("redirect 1"),e)return console.log("redirect err",e),console.log("Failed to do learn auth endpoint for domain ",n),r.handleRedirect({error:"Failed to learn auth endpoint"}),null;window.open(a,"_blank","width=500,height=400,status,resizable,scrollbars=yes");console.log("redirect 2")}),i)}}i.init=r.init,i.getIDToken=c(r.getIDToken,{}),i.getAccessToken=c(r.getAccessToken,{}),i.handleRedirect=function(){console.log("handleRedirect");var e=new t(window.location);console.log("window.location",window.location),console.log("uri.fragment()",e.fragment());var a=e.query(e.fragment()).query(!0);console.log("params",a),window.opener._oadaIdClientPopUpFunction(a)},e.exports=i},797:function(e,a,n){"use strict";(function(a){var t=n(798),o=n(801),r=n(453),i=n(136),c=n(92),s=n(451),l=n(55);e.exports=function(e,n){return new l((function(l){var d=r.createServer((function(e,n){if(/favicon/.test(e.url))return n.statusCode=404,n.statusMessage="Not found",void n.end();if(/^\/somefile/.test(e.url)){var t=c.parse(e.url,!0);return d.close(),l({access_token:t.query.access_token})}var o=e.url.split("?")[0],r=s.join(a,"/public/"+o);n.writeHead(200,{"Content-Length":i.statSync(r).size}),i.createReadStream(r).pipe(n)})).listen(8e3,(function(){t("http://localhost:8000/index.html?domain="+JSON.stringify(e)+"&options="+JSON.stringify(n),{url:!0,app:o&&"wslview"})}))}))}}).call(this,"/")},806:function(e,a,n){"use strict";var t=n(83),o=n(260),r={getIDToken:function(e,a){var n=t({},a);return function(a,t,r){var i=a.param("domain")||e;n.scope=a.param("scope")||n.scope,o.getIDToken(i,n,(function(e,a){return e?r(e):t.redirect(302,a)}))}},getAccessToken:function(e,a){var n=t({},a);return console.log("middleware getAccessToken"),function(a,t,r){var i=a.param("domain")||e;n.scope=a.param("scope")||n.scope,console.log("middleware getAccessToken dom",i),console.log("middleware getAccessToken params",n),o.getAccessToken(i,n,(function(e,a){return e?r(e):t.redirect(302,a)}))}},handleRedirect:function(){return console.log("middleware handleRedirect"),function(e,a,n){console.log("middleware handleRedirect req.query",e.query),o.handleRedirect(e.query,(function(a,t){if(a)return n(a);e.token=t,n()}))}}};e.exports=r},960:function(e,a,n){}},[[592,1,2]]]);
//# sourceMappingURL=main.6750dd9e.chunk.js.map